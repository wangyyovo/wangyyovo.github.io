<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>细数TS中那些奇怪的符号 | Blank</title><meta name="author" content="Blank"><meta name="copyright" content="Blank"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="细数 TS 中那些奇怪的符号 https:&#x2F;&#x2F;segmentfault.com&#x2F;a&#x2F;1190000023943952  TypeScript 是一种由微软开发的自由和开源的编程语言。它是 JavaScript 的一个超集，而且本质上向这个语言添加了可选的静态类型和基于类的面向对象编程。 本文阿宝哥将分享这些年在学习 TypeScript 过程中，遇到的 10 大 “奇怪” 的符号。其中有一些符号">
<meta property="og:type" content="article">
<meta property="og:title" content="细数TS中那些奇怪的符号">
<meta property="og:url" content="https://wangyyovo.github.io/posts/168b0f7a/">
<meta property="og:site_name" content="Blank">
<meta property="og:description" content="细数 TS 中那些奇怪的符号 https:&#x2F;&#x2F;segmentfault.com&#x2F;a&#x2F;1190000023943952  TypeScript 是一种由微软开发的自由和开源的编程语言。它是 JavaScript 的一个超集，而且本质上向这个语言添加了可选的静态类型和基于类的面向对象编程。 本文阿宝哥将分享这些年在学习 TypeScript 过程中，遇到的 10 大 “奇怪” 的符号。其中有一些符号">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7.jpg">
<meta property="article:published_time" content="2021-07-03T04:26:48.000Z">
<meta property="article:modified_time" content="2021-07-03T04:26:48.000Z">
<meta property="article:author" content="Blank">
<meta property="article:tag" content="typescript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "细数TS中那些奇怪的符号",
  "url": "https://wangyyovo.github.io/posts/168b0f7a/",
  "image": "https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7.jpg",
  "datePublished": "2021-07-03T04:26:48.000Z",
  "dateModified": "2021-07-03T04:26:48.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Blank",
      "url": "https://wangyyovo.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/favicon.ico"><link rel="canonical" href="https://wangyyovo.github.io/posts/168b0f7a/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '细数TS中那些奇怪的符号',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="alternate" href="/atom.xml" title="Blank" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">356</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">54</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 教程</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> 🚀 快速開始</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> 📑 主題頁面</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> 🛠 主題配置-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> ⚔️ 主題配置-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> ❓ 主題問答</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> ⚡️ 進階教程</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> ✨ 更新日誌</span></a></li><li><a class="site-page child" href="/posts/507c070f/"><span> 📑 Aplayer教程</span></a></li><li><a class="site-page child" href="/posts/2df239ce/"><span> 📑 標籤外掛</span></a></li><li><a class="site-page child" href="/posts/b37b5fe3/"><span> 📑 自定義代碼配色</span></a></li><li><a class="site-page child" href="/posts/ea33ab97/"><span> 📑 自定義側邊欄</span></a></li><li><a class="site-page child" href="/posts/89757140/"><span> 📑 Markdown</span></a></li><li><a class="site-page child" href="/posts/9db656e5/"><span> 📑 代码高亮测试</span></a></li><li><a class="site-page child" href="/posts/c9711c19/"><span> 📑 當設置top_img為false時</span></a></li><li><a class="site-page child" href="/posts/39b121ef/"><span> 📑 Hexo內置標籤外掛</span></a></li><li><a class="site-page child" href="/posts/7670b080/"><span> 📑 Butterfly 美化/優化/魔改 教程合集</span></a></li><li><a class="site-page child" href="/posts/913b2502/"><span> 📑 没有封面</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Blank</span></a><a class="nav-page-title" href="/"><span class="site-name">细数TS中那些奇怪的符号</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 教程</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> 🚀 快速開始</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> 📑 主題頁面</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> 🛠 主題配置-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> ⚔️ 主題配置-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> ❓ 主題問答</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> ⚡️ 進階教程</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> ✨ 更新日誌</span></a></li><li><a class="site-page child" href="/posts/507c070f/"><span> 📑 Aplayer教程</span></a></li><li><a class="site-page child" href="/posts/2df239ce/"><span> 📑 標籤外掛</span></a></li><li><a class="site-page child" href="/posts/b37b5fe3/"><span> 📑 自定義代碼配色</span></a></li><li><a class="site-page child" href="/posts/ea33ab97/"><span> 📑 自定義側邊欄</span></a></li><li><a class="site-page child" href="/posts/89757140/"><span> 📑 Markdown</span></a></li><li><a class="site-page child" href="/posts/9db656e5/"><span> 📑 代码高亮测试</span></a></li><li><a class="site-page child" href="/posts/c9711c19/"><span> 📑 當設置top_img為false時</span></a></li><li><a class="site-page child" href="/posts/39b121ef/"><span> 📑 Hexo內置標籤外掛</span></a></li><li><a class="site-page child" href="/posts/7670b080/"><span> 📑 Butterfly 美化/優化/魔改 教程合集</span></a></li><li><a class="site-page child" href="/posts/913b2502/"><span> 📑 没有封面</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">细数TS中那些奇怪的符号</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-03T04:26:48.000Z" title="发表于 2021-07-03 12:26:48">2021-07-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-03T04:26:48.000Z" title="更新于 2021-07-03 12:26:48">2021-07-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/typescript/">typescript</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><script src="\assets\js\APlayer.min.js"> </script><h1 id="细数-TS-中那些奇怪的符号"><a href="#细数-TS-中那些奇怪的符号" class="headerlink" title="细数 TS 中那些奇怪的符号"></a>细数 TS 中那些奇怪的符号</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000023943952">https://segmentfault.com/a/1190000023943952</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/">TypeScript</a> 是一种由微软开发的自由和开源的编程语言。它是 JavaScript 的一个超集，而且本质上向这个语言添加了可选的静态类型和基于类的面向对象编程。</p>
<p>本文阿宝哥将分享这些年在学习 TypeScript 过程中，遇到的 10 大 “奇怪” 的符号。其中有一些符号，阿宝哥第一次见的时候也觉得 “一脸懵逼”，希望本文对学习 TypeScript 的小伙伴能有一些帮助。</p>
<p>好的，下面我们来开始介绍第一个符号 —— <strong>! 非空断言操作符</strong>。</p>
<h3 id="一、-非空断言操作符"><a href="#一、-非空断言操作符" class="headerlink" title="一、! 非空断言操作符"></a>一、! 非空断言操作符</h3><p>在上下文中当类型检查器无法断定类型时，一个新的后缀表达式操作符 <code>!</code> 可以用于断言操作对象是非 null 和非 undefined 类型。<strong>具体而言，x! 将从 x 值域中排除 null 和 undefined 。</strong></p>
<p>那么非空断言操作符到底有什么用呢？下面我们先来看一下非空断言操作符的一些使用场景。</p>
<h4 id="1-1-忽略-undefined-和-null-类型"><a href="#1-1-忽略-undefined-和-null-类型" class="headerlink" title="1.1 忽略 undefined 和 null 类型"></a>1.1 忽略 undefined 和 null 类型</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myFunc</span>(<span class="params">maybeString: <span class="built_in">string</span> | <span class="literal">undefined</span> | <span class="literal">null</span></span>) &#123;</span><br><span class="line">  <span class="comment">// Type &#x27;string | null | undefined&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br><span class="line">  <span class="comment">// Type &#x27;undefined&#x27; is not assignable to type &#x27;string&#x27;. </span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onlyString</span>: <span class="built_in">string</span> = maybeString; <span class="comment">// Error</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">ignoreUndefinedAndNull</span>: <span class="built_in">string</span> = maybeString!; <span class="comment">// Ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-调用函数时忽略-undefined-类型"><a href="#1-2-调用函数时忽略-undefined-类型" class="headerlink" title="1.2 调用函数时忽略 undefined 类型"></a>1.2 调用函数时忽略 undefined 类型</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">NumGenerator</span> = <span class="function">() =&gt;</span> <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myFunc</span>(<span class="params">numGenerator: NumGenerator | <span class="literal">undefined</span></span>) &#123;</span><br><span class="line">  <span class="comment">// Object is possibly &#x27;undefined&#x27;.(2532)</span></span><br><span class="line">  <span class="comment">// Cannot invoke an object which is possibly &#x27;undefined&#x27;.(2722)</span></span><br><span class="line">  <span class="keyword">const</span> num1 = <span class="title function_">numGenerator</span>(); <span class="comment">// Error</span></span><br><span class="line">  <span class="keyword">const</span> num2 = numGenerator!(); <span class="comment">//OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为 <code>!</code> 非空断言操作符会从编译生成的 JavaScript 代码中移除，所以在实际使用的过程中，要特别注意。比如下面这个例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">a</span>: <span class="built_in">number</span> | <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">b</span>: <span class="built_in">number</span> = a!;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b); </span><br></pre></td></tr></table></figure>

<p>以上 TS 代码会编译生成以下 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> a = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">const</span> b = a;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br></pre></td></tr></table></figure>

<p>虽然在 TS 代码中，我们使用了非空断言，使得 <code>const b: number = a!;</code> 语句可以通过 TypeScript 类型检查器的检查。但在生成的 ES5 代码中，<code>!</code> 非空断言操作符被移除了，所以在浏览器中执行以上代码，在控制台会输出 <code>undefined</code>。</p>
<h3 id="二、-运算符"><a href="#二、-运算符" class="headerlink" title="二、?. 运算符"></a>二、?. 运算符</h3><p>TypeScript 3.7 实现了呼声最高的 ECMAScript 功能之一：可选链（Optional Chaining）。有了可选链后，我们编写代码时如果遇到 <code>null</code> 或 <code>undefined</code> 就可以立即停止某些表达式的运行。可选链的核心是新的 <code>?.</code> 运算符，它支持以下语法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">obj?.<span class="property">prop</span></span><br><span class="line">obj?.[expr]</span><br><span class="line">arr?.[index]</span><br><span class="line">func?.(args)</span><br></pre></td></tr></table></figure>

<p>这里我们来举一个可选的属性访问的例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> val = a?.<span class="property">b</span>;</span><br></pre></td></tr></table></figure>

<p>为了更好的理解可选链，我们来看一下该 <code>const val = a?.b</code> 语句编译生成的 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> val = a === <span class="literal">null</span> || a === <span class="built_in">void</span> <span class="number">0</span> ? <span class="built_in">void</span> <span class="number">0</span> : a.<span class="property">b</span>;</span><br></pre></td></tr></table></figure>

<p>上述的代码会自动检查对象 a 是否为 <code>null</code> 或 <code>undefined</code>，如果是的话就立即返回 <code>undefined</code>，这样就可以立即停止某些表达式的运行。你可能已经想到可以使用 <code>?.</code> 来替代很多使用 <code>&amp;&amp;</code> 执行空检查的代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(a &amp;&amp; a.<span class="property">b</span>) &#123; &#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a?.<span class="property">b</span>)&#123; &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* if(a?.b)&#123; &#125; 编译后的ES5代码</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* if(</span></span><br><span class="line"><span class="comment">*  a === null || a === void 0 </span></span><br><span class="line"><span class="comment">*  ? void 0 : a.b) &#123;</span></span><br><span class="line"><span class="comment">* &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>但需要注意的是，<code>?.</code> 与 <code>&amp;&amp;</code> 运算符行为略有不同，<code>&amp;&amp;</code> 专门用于检测 <code>falsy</code> 值，比如空字符串、0、NaN、null 和 false 等。而 <code>?.</code> 只会验证对象是否为 <code>null</code> 或 <code>undefined</code>，对于 0 或空字符串来说，并不会出现 “短路”。</p>
<h4 id="2-1-可选元素访问"><a href="#2-1-可选元素访问" class="headerlink" title="2.1 可选元素访问"></a>2.1 可选元素访问</h4><p>可选链除了支持可选属性的访问之外，它还支持可选元素的访问，它的行为类似于可选属性的访问，只是可选元素的访问允许我们访问非标识符的属性，比如任意字符串、数字索引和 Symbol：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> tryGetArrayElement&lt;T&gt;(arr?: T[], <span class="attr">index</span>: <span class="built_in">number</span> = <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> arr?.[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码经过编译后会生成以下 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tryGetArrayElement</span>(<span class="params">arr, index</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (index === <span class="built_in">void</span> <span class="number">0</span>) &#123; index = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">return</span> arr === <span class="literal">null</span> || arr === <span class="built_in">void</span> <span class="number">0</span> ? <span class="built_in">void</span> <span class="number">0</span> : arr[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过观察生成的 ES5 代码，很明显在 <code>tryGetArrayElement</code> 方法中会自动检测输入参数 arr 的值是否为 <code>null</code> 或 <code>undefined</code>，从而保证了我们代码的健壮性。</p>
<h4 id="2-2-可选链与函数调用"><a href="#2-2-可选链与函数调用" class="headerlink" title="2.2 可选链与函数调用"></a>2.2 可选链与函数调用</h4><p>当尝试调用一个可能不存在的方法时也可以使用可选链。在实际开发过程中，这是很有用的。系统中某个方法不可用，有可能是由于版本不一致或者用户设备兼容性问题导致的。函数调用时如果被调用的方法不存在，使用可选链可以使表达式自动返回 <code>undefined</code> 而不是抛出一个异常。</p>
<p>可选调用使用起来也很简单，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = obj.<span class="property">customMethod</span>?.();</span><br></pre></td></tr></table></figure>

<p>该 TypeScript 代码编译生成的 ES5 代码如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result = (_a = obj.<span class="property">customMethod</span>) === <span class="literal">null</span></span><br><span class="line">  || _a === <span class="built_in">void</span> <span class="number">0</span> ? <span class="built_in">void</span> <span class="number">0</span> : _a.<span class="title function_">call</span>(obj);</span><br></pre></td></tr></table></figure>

<p>另外在使用可选调用的时候，我们要注意以下两个注意事项：</p>
<ul>
<li>如果存在一个属性名且该属性名对应的值不是函数类型，使用 <code>?.</code> 仍然会产生一个 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a> 异常。</li>
<li>可选链的运算行为被局限在属性的访问、调用以及元素的访问 —— 它不会沿伸到后续的表达式中，也就是说可选调用不会阻止 <code>a?.b / someMethod()</code> 表达式中的除法运算或 <code>someMethod</code> 的方法调用。</li>
</ul>
<h3 id="三、-空值合并运算符"><a href="#三、-空值合并运算符" class="headerlink" title="三、?? 空值合并运算符"></a>三、?? 空值合并运算符</h3><p>在 TypeScript 3.7 版本中除了引入了前面介绍的可选链 <code>?.</code> 之外，也引入了一个新的逻辑运算符 —— 空值合并运算符 <code>??</code>。<strong>当左侧操作数为 null 或 undefined 时，其返回右侧的操作数，否则返回左侧的操作数</strong>。</p>
<p>与逻辑或 <code>||</code> 运算符不同，逻辑或会在左操作数为 falsy 值时返回右侧操作数。也就是说，如果你使用 || 来为某些变量设置默认的值时，你可能会遇到意料之外的行为。比如为 falsy 值（&#39;&#39;、NaN 或 0）时。</p>
<p>这里来看一个具体的例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="literal">null</span> ?? <span class="string">&#x27;default string&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出：&quot;default string&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baz = <span class="number">0</span> ?? <span class="number">42</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(baz); <span class="comment">// 输出：0</span></span><br></pre></td></tr></table></figure>

<p>以上 TS 代码经过编译后，会生成以下 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> _a, _b;</span><br><span class="line"><span class="keyword">var</span> foo = (_a = <span class="literal">null</span>) !== <span class="literal">null</span> &amp;&amp; _a !== <span class="built_in">void</span> <span class="number">0</span> ? _a : <span class="string">&#x27;default string&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出：&quot;default string&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> baz = (_b = <span class="number">0</span>) !== <span class="literal">null</span> &amp;&amp; _b !== <span class="built_in">void</span> <span class="number">0</span> ? _b : <span class="number">42</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(baz); <span class="comment">// 输出：0</span></span><br></pre></td></tr></table></figure>

<p>通过观察以上代码，我们更加直观的了解到，空值合并运算符是如何解决前面 <code>||</code> 运算符存在的潜在问题。下面我们来介绍空值合并运算符的特性和使用时的一些注意事项。</p>
<h4 id="3-1-短路"><a href="#3-1-短路" class="headerlink" title="3.1 短路"></a>3.1 短路</h4><p>当空值合并运算符的左表达式不为 <code>null</code> 或 <code>undefined</code> 时，不会对右表达式进行求值。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A was called&#x27;</span>); <span class="keyword">return</span> <span class="literal">undefined</span>;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B was called&#x27;</span>); <span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">C</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;C was called&#x27;</span>); <span class="keyword">return</span> <span class="string">&quot;foo&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">A</span>() ?? <span class="title function_">C</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">B</span>() ?? <span class="title function_">C</span>());</span><br></pre></td></tr></table></figure>

<p>上述代码运行后，控制台会输出以下结果：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A was called </span><br><span class="line">C was called </span><br><span class="line">foo </span><br><span class="line">B was called </span><br><span class="line"><span class="literal">false</span> </span><br></pre></td></tr></table></figure>

<h4 id="3-2-不能与-或-操作符共用"><a href="#3-2-不能与-或-操作符共用" class="headerlink" title="3.2 不能与 &amp;&amp; 或 || 操作符共用"></a>3.2 不能与 &amp;&amp; 或 || 操作符共用</h4><p>若空值合并运算符 <code>??</code> 直接与 AND（&amp;&amp;）和 OR（||）操作符组合使用 ?? 是不行的。这种情况下会抛出 SyntaxError。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x27;||&#x27; and &#x27;??&#x27; operations cannot be mixed without parentheses.(5076)</span></span><br><span class="line"><span class="literal">null</span> || <span class="literal">undefined</span> ?? <span class="string">&quot;foo&quot;</span>; <span class="comment">// raises a SyntaxError</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x27;&amp;&amp;&#x27; and &#x27;??&#x27; operations cannot be mixed without parentheses.(5076)</span></span><br><span class="line"><span class="literal">true</span> &amp;&amp; <span class="literal">undefined</span> ?? <span class="string">&quot;foo&quot;</span>; <span class="comment">// raises a SyntaxError</span></span><br></pre></td></tr></table></figure>

<p>但当使用括号来显式表明优先级时是可行的，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="literal">null</span> || <span class="literal">undefined</span> ) ?? <span class="string">&quot;foo&quot;</span>; <span class="comment">// 返回 &quot;foo&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-与可选链操作符-的关系"><a href="#3-3-与可选链操作符-的关系" class="headerlink" title="3.3 与可选链操作符 ?. 的关系"></a>3.3 与可选链操作符 ?. 的关系</h4><p>空值合并运算符针对 undefined 与 null 这两个值，可选链式操作符 <code>?.</code> 也是如此。可选链式操作符，对于访问属性可能为 undefined 与 null 的对象时非常有用。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  city?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">customer</span>: <span class="title class_">Customer</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Semlinker&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> customerCity = customer?.<span class="property">city</span> ?? <span class="string">&quot;Unknown city&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(customerCity); <span class="comment">// 输出：Unknown city</span></span><br></pre></td></tr></table></figure>

<p>前面我们已经介绍了空值合并运算符的应用场景和使用时的一些注意事项，该运算符不仅可以在 TypeScript 3.7 以上版本中使用。当然你也可以在 JavaScript 的环境中使用它，但你需要借助 Babel，在 Babel 7.8.0 版本也开始支持空值合并运算符。</p>
<h3 id="四、-可选属性"><a href="#四、-可选属性" class="headerlink" title="四、?: 可选属性"></a>四、?: 可选属性</h3><p>在面向对象语言中，接口是一个很重要的概念，它是对行为的抽象，而具体如何行动需要由类去实现。 <strong>TypeScript 中的接口是一个非常灵活的概念，除了可用于对类的一部分行为进行抽象以外，也常用于对「对象的形状（Shape）」进行描述</strong>。</p>
<p>在 TypeScript 中使用 <code>interface</code> 关键字就可以声明一个接口：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">semlinker</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;semlinker&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">33</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在以上代码中，我们声明了 <code>Person</code> 接口，它包含了两个必填的属性 <code>name</code> 和 <code>age</code>。在初始化 Person 类型变量时，如果缺少某个属性，TypeScript 编译器就会提示相应的错误信息，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Property &#x27;age&#x27; is missing in type &#x27;&#123; name: string; &#125;&#x27; but required in type &#x27;Person&#x27;.(2741)</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">lolo</span>: <span class="title class_">Person</span>  = &#123; <span class="comment">// Error</span></span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;lolo&quot;</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了解决上述的问题，我们可以把某个属性声明为可选的：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">lolo</span>: <span class="title class_">Person</span>  = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;lolo&quot;</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-1-工具类型"><a href="#4-1-工具类型" class="headerlink" title="4.1 工具类型"></a>4.1 工具类型</h4><h5 id="4-1-1-Partial"><a href="#4-1-1-Partial" class="headerlink" title="4.1.1 Partial&lt;T&gt;"></a>4.1.1 <code>Partial&lt;T&gt;</code></h5><p>在实际项目开发过程中，为了提高代码复用率，我们可以利用 TypeScript 内置的工具类型 <code>Partial&lt;T&gt;</code> 来快速把某个接口类型中定义的属性变成可选的：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PullDownRefreshConfig</span> &#123;</span><br><span class="line">  <span class="attr">threshold</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">stop</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * type PullDownRefreshOptions = &#123;</span></span><br><span class="line"><span class="comment"> *   threshold?: number | undefined;</span></span><br><span class="line"><span class="comment"> *   stop?: number | undefined;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PullDownRefreshOptions</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">PullDownRefreshConfig</span>&gt;</span><br></pre></td></tr></table></figure>

<p>是不是觉得 <code>Partial&lt;T&gt;</code> 很方便，下面让我们来看一下它是如何实现的：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Make all properties in T optional</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]?: T[P];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="4-1-2-Required"><a href="#4-1-2-Required" class="headerlink" title="4.1.2 Required&lt;T&gt;"></a>4.1.2 <code>Required&lt;T&gt;</code></h5><p>既然可以快速地把某个接口中定义的属性全部声明为可选，那能不能把所有的可选的属性变成必选的呢？答案是可以的，针对这个需求，我们可以使用 <code>Required&lt;T&gt;</code> 工具类型，具体的使用方式如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PullDownRefreshConfig</span> &#123;</span><br><span class="line">  <span class="attr">threshold</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">stop</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PullDownRefreshOptions</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">PullDownRefreshConfig</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * type PullDownRefresh = &#123;</span></span><br><span class="line"><span class="comment"> *   threshold: number;</span></span><br><span class="line"><span class="comment"> *   stop: number;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PullDownRefresh</span> = <span class="title class_">Required</span>&lt;<span class="title class_">Partial</span>&lt;<span class="title class_">PullDownRefreshConfig</span>&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>同样，我们来看一下 <code>Required&lt;T&gt;</code> 工具类型是如何实现的：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Make all properties in T required</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]-?: T[P];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>原来在 <code>Required&lt;T&gt;</code> 工具类型内部，通过 <code>-?</code> 移除了可选属性中的 <code>?</code>，使得属性从可选变为必选的。</p>
<h3 id="五、-运算符"><a href="#五、-运算符" class="headerlink" title="五、&amp; 运算符"></a>五、&amp; 运算符</h3><p>在 TypeScript 中交叉类型是将多个类型合并为一个类型。通过 <code>&amp;</code> 运算符可以将现有的多种类型叠加到一起成为一种类型，它包含了所需的所有类型的特性。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">PartialPointX</span> = &#123; <span class="attr">x</span>: <span class="built_in">number</span>; &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Point</span> = <span class="title class_">PartialPointX</span> &amp; &#123; <span class="attr">y</span>: <span class="built_in">number</span>; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">point</span>: <span class="title class_">Point</span> = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">y</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面代码中我们先定义了 <code>PartialPointX</code> 类型，接着使用 <code>&amp;</code> 运算符创建一个新的 <code>Point</code> 类型，表示一个含有 x 和 y 坐标的点，然后定义了一个 <code>Point</code> 类型的变量并初始化。</p>
<h4 id="5-1-同名基础类型属性的合并"><a href="#5-1-同名基础类型属性的合并" class="headerlink" title="5.1 同名基础类型属性的合并"></a>5.1 同名基础类型属性的合并</h4><p>那么现在问题来了，假设在合并多个类型的过程中，刚好出现某些类型存在相同的成员，但对应的类型又不一致，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> X &#123;</span><br><span class="line">  <span class="attr">c</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">d</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Y &#123;</span><br><span class="line">  <span class="attr">c</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">e</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">XY</span> = X &amp; Y;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">YX</span> = Y &amp; X;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">p</span>: <span class="variable constant_">XY</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">q</span>: <span class="variable constant_">YX</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，接口 X 和接口 Y 都含有一个相同的成员 c，但它们的类型不一致。对于这种情况，此时 XY 类型或 YX 类型中成员 c 的类型是不是可以是 <code>string</code> 或 <code>number</code> 类型呢？比如下面的例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = &#123; <span class="attr">c</span>: <span class="number">6</span>, <span class="attr">d</span>: <span class="string">&quot;d&quot;</span>, <span class="attr">e</span>: <span class="string">&quot;e&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/blog/typescript/3634501929-7ca85c9dd69b3bbe_1.jpg" alt="img"></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q = &#123; <span class="attr">c</span>: <span class="string">&quot;c&quot;</span>, <span class="attr">d</span>: <span class="string">&quot;d&quot;</span>, <span class="attr">e</span>: <span class="string">&quot;e&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/blog/typescript/3723575275-80bc4b63646fa9a3_2.jpg" alt="img"></p>
<p>为什么接口 X 和接口 Y 混入后，成员 c 的类型会变成 <code>never</code> 呢？这是因为混入后成员 c 的类型为 <code>string &amp; number</code>，即成员 c 的类型既可以是 <code>string</code> 类型又可以是 <code>number</code> 类型。很明显这种类型是不存在的，所以混入后成员 c 的类型为 <code>never</code>。</p>
<h4 id="5-2-同名非基础类型属性的合并"><a href="#5-2-同名非基础类型属性的合并" class="headerlink" title="5.2 同名非基础类型属性的合并"></a>5.2 同名非基础类型属性的合并</h4><p>在上面示例中，刚好接口 X 和接口 Y 中内部成员 c 的类型都是基本数据类型，那么如果是非基本数据类型的话，又会是什么情形。我们来看个具体的例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> D &#123; <span class="attr">d</span>: <span class="built_in">boolean</span>; &#125;</span><br><span class="line"><span class="keyword">interface</span> E &#123; <span class="attr">e</span>: <span class="built_in">string</span>; &#125;</span><br><span class="line"><span class="keyword">interface</span> F &#123; <span class="attr">f</span>: <span class="built_in">number</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> A &#123; <span class="attr">x</span>: D; &#125;</span><br><span class="line"><span class="keyword">interface</span> B &#123; <span class="attr">x</span>: E; &#125;</span><br><span class="line"><span class="keyword">interface</span> C &#123; <span class="attr">x</span>: F; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">ABC</span> = A &amp; B &amp; C;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">abc</span>: <span class="variable constant_">ABC</span> = &#123;</span><br><span class="line">  <span class="attr">x</span>: &#123;</span><br><span class="line">    <span class="attr">d</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">e</span>: <span class="string">&#x27;semlinker&#x27;</span>,</span><br><span class="line">    <span class="attr">f</span>: <span class="number">666</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;abc:&#x27;</span>, abc);</span><br></pre></td></tr></table></figure>

<p>以上代码成功运行后，控制台会输出以下结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/blog/typescript/689788014-e36b25954dd197d9_3.jpg" alt="img"></p>
<p>由上图可知，在混入多个类型时，若存在相同的成员，且成员类型为非基本数据类型，那么是可以成功合并。</p>
<h3 id="六、-分隔符"><a href="#六、-分隔符" class="headerlink" title="六、| 分隔符"></a>六、| 分隔符</h3><p>在 TypeScript 中联合类型（Union Types）表示取值可以为多种类型中的一种，联合类型使用 <code>|</code> 分隔每个类型。联合类型通常与 <code>null</code> 或 <code>undefined</code> 一起使用：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">sayHello</span> = (<span class="params">name: <span class="built_in">string</span> | <span class="literal">undefined</span></span>) =&gt; &#123; <span class="comment">/* ... */</span> &#125;;</span><br></pre></td></tr></table></figure>

<p>以上示例中 <code>name</code> 的类型是 <code>string | undefined</code> 意味着可以将 <code>string</code> 或 <code>undefined</code> 的值传递给 <code>sayHello</code> 函数。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">sayHello</span>(<span class="string">&quot;semlinker&quot;</span>);</span><br><span class="line"><span class="title function_">sayHello</span>(<span class="literal">undefined</span>);</span><br></pre></td></tr></table></figure>

<p>此外，对于联合类型来说，你可能会遇到以下的用法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">num</span>: <span class="number">1</span> | <span class="number">2</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">EventNames</span> = <span class="string">&#x27;click&#x27;</span> | <span class="string">&#x27;scroll&#x27;</span> | <span class="string">&#x27;mousemove&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>示例中的 <code>1</code>、<code>2</code> 或 <code>&#39;click&#39;</code> 被称为字面量类型，用来约束取值只能是某几个值中的一个。</p>
<h4 id="6-1-类型保护"><a href="#6-1-类型保护" class="headerlink" title="6.1 类型保护"></a>6.1 类型保护</h4><p>当使用联合类型时，我们必须尽量把当前值的类型收窄为当前值的实际类型，而类型保护就是实现类型收窄的一种手段。</p>
<p>类型保护是可执行运行时检查的一种表达式，用于确保该类型在一定的范围内。换句话说，类型保护可以保证一个字符串是一个字符串，尽管它的值也可以是一个数字。类型保护与特性检测并不是完全不同，其主要思想是尝试检测属性、方法或原型，以确定如何处理值。</p>
<p>目前主要有四种的方式来实现类型保护：</p>
<h5 id="6-1-1-in-关键字"><a href="#6-1-1-in-关键字" class="headerlink" title="6.1.1 in 关键字"></a>6.1.1 in 关键字</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Admin</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">privileges</span>: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">startDate</span>: <span class="title class_">Date</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UnknownEmployee</span> = <span class="title class_">Employee</span> | <span class="title class_">Admin</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printEmployeeInformation</span>(<span class="params">emp: UnknownEmployee</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Name: &quot;</span> + emp.<span class="property">name</span>);</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;privileges&quot;</span> <span class="keyword">in</span> emp) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Privileges: &quot;</span> + emp.<span class="property">privileges</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;startDate&quot;</span> <span class="keyword">in</span> emp) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start Date: &quot;</span> + emp.<span class="property">startDate</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-1-2-typeof-关键字"><a href="#6-1-2-typeof-关键字" class="headerlink" title="6.1.2 typeof 关键字"></a>6.1.2 typeof 关键字</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">padLeft</span>(<span class="params">value: <span class="built_in">string</span>, padding: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Array</span>(padding + <span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&quot; &quot;</span>) + value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> padding + value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Expected string or number, got &#x27;<span class="subst">$&#123;padding&#125;</span>&#x27;.`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>typeof</code> 类型保护只支持两种形式：<code>typeof v === &quot;typename&quot;</code> 和 <code>typeof v !== typename</code>，<code>&quot;typename&quot;</code> 必须是 <code>&quot;number&quot;</code>， <code>&quot;string&quot;</code>， <code>&quot;boolean&quot;</code> 或 <code>&quot;symbol&quot;</code>。 但是 TypeScript 并不会阻止你与其它字符串比较，语言不会把那些表达式识别为类型保护。</p>
<h5 id="6-1-3-instanceof-关键字"><a href="#6-1-3-instanceof-关键字" class="headerlink" title="6.1.3 instanceof 关键字"></a>6.1.3 instanceof 关键字</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Padder</span> &#123;</span><br><span class="line">  <span class="title function_">getPaddingString</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpaceRepeatingPadder</span> <span class="keyword">implements</span> <span class="title class_">Padder</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> numSpaces: <span class="built_in">number</span></span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">getPaddingString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>(<span class="variable language_">this</span>.<span class="property">numSpaces</span> + <span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StringPadder</span> <span class="keyword">implements</span> <span class="title class_">Padder</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> value: <span class="built_in">string</span></span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">getPaddingString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">value</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">padder</span>: <span class="title class_">Padder</span> = <span class="keyword">new</span> <span class="title class_">SpaceRepeatingPadder</span>(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (padder <span class="keyword">instanceof</span> <span class="title class_">SpaceRepeatingPadder</span>) &#123;</span><br><span class="line">  <span class="comment">// padder的类型收窄为 &#x27;SpaceRepeatingPadder&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-1-4-自定义类型保护的类型谓词（type-predicate）"><a href="#6-1-4-自定义类型保护的类型谓词（type-predicate）" class="headerlink" title="6.1.4 自定义类型保护的类型谓词（type predicate）"></a>6.1.4 自定义类型保护的类型谓词（type predicate）</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isNumber</span>(<span class="params">x: <span class="built_in">any</span></span>): x is <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> x === <span class="string">&quot;number&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isString</span>(<span class="params">x: <span class="built_in">any</span></span>): x is <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> x === <span class="string">&quot;string&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="七、-数字分隔符"><a href="#七、-数字分隔符" class="headerlink" title="七、_ 数字分隔符"></a>七、_ 数字分隔符</h3><p>TypeScript 2.7 带来了对数字分隔符的支持，正如数值分隔符 ECMAScript 提案中所概述的那样。对于一个数字字面量，你现在可以通过把一个下划线作为它们之间的分隔符来分组数字：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inhabitantsOfMunich = <span class="number">1_464_301</span>;</span><br><span class="line"><span class="keyword">const</span> distanceEarthSunInKm = <span class="number">149_600_000</span>;</span><br><span class="line"><span class="keyword">const</span> fileSystemPermission = <span class="number">0b111_111_000</span>;</span><br><span class="line"><span class="keyword">const</span> bytes = <span class="number">0b1111_10101011_11110000_00001101</span>;</span><br></pre></td></tr></table></figure>

<p>分隔符不会改变数值字面量的值，但逻辑分组使人们更容易一眼就能读懂数字。以上 TS 代码经过编译后，会生成以下 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> inhabitantsOfMunich = <span class="number">1464301</span>;</span><br><span class="line"><span class="keyword">var</span> distanceEarthSunInKm = <span class="number">149600000</span>;</span><br><span class="line"><span class="keyword">var</span> fileSystemPermission = <span class="number">504</span>;</span><br><span class="line"><span class="keyword">var</span> bytes = <span class="number">262926349</span>;</span><br></pre></td></tr></table></figure>

<h4 id="7-1-使用限制"><a href="#7-1-使用限制" class="headerlink" title="7.1 使用限制"></a>7.1 使用限制</h4><p>虽然数字分隔符看起来很简单，但在使用时还是有一些限制。比如你只能在两个数字之间添加 <code>_</code> 分隔符。以下的使用方式是非法的：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Numeric separators are not allowed here.(6188)</span></span><br><span class="line">3_<span class="number">.141592</span> <span class="comment">// Error</span></span><br><span class="line"><span class="number">3.</span>_141592 <span class="comment">// Error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Numeric separators are not allowed here.(6188)</span></span><br><span class="line">1_e10 <span class="comment">// Error</span></span><br><span class="line">1e_10 <span class="comment">// Error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Cannot find name &#x27;_126301&#x27;.(2304)</span></span><br><span class="line">_126301  <span class="comment">// Error</span></span><br><span class="line"><span class="comment">// Numeric separators are not allowed here.(6188)</span></span><br><span class="line">126301_ <span class="comment">// Error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Cannot find name &#x27;b111111000&#x27;.(2304)</span></span><br><span class="line"><span class="comment">// An identifier or keyword cannot immediately follow a numeric literal.(1351)</span></span><br><span class="line">0_b111111000 <span class="comment">// Error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Numeric separators are not allowed here.(6188)</span></span><br><span class="line">0b_111111000 <span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<p>当然你也不能连续使用多个 <code>_</code> 分隔符，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Multiple consecutive numeric separators are not permitted.(6189)</span></span><br><span class="line">123__456 <span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-解析分隔符"><a href="#7-2-解析分隔符" class="headerlink" title="7.2 解析分隔符"></a>7.2 解析分隔符</h4><p>此外，需要注意的是以下用于解析数字的函数是不支持分隔符：</p>
<ul>
<li><code>Number()</code></li>
<li><code>parseInt()</code></li>
<li><code>parseFloat()</code></li>
</ul>
<p>这里我们来看一下实际的例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Number</span>(<span class="string">&#x27;123_456&#x27;</span>)</span><br><span class="line"><span class="title class_">NaN</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;123_456&#x27;</span>)</span><br><span class="line"><span class="number">123</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">&#x27;123_456&#x27;</span>)</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>很明显对于以上的结果不是我们所期望的，所以在处理分隔符时要特别注意。当然要解决上述问题，也很简单只需要非数字的字符删掉即可。这里我们来定义一个 <code>removeNonDigits</code> 的函数：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">RE_NON_DIGIT</span> = <span class="regexp">/[^0-9]/gu</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeNonDigits</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  str = str.<span class="title function_">replace</span>(<span class="variable constant_">RE_NON_DIGIT</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Number</span>(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该函数通过调用字符串的 <code>replace</code> 方法来移除非数字的字符，具体的使用方式如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">removeNonDigits</span>(<span class="string">&#x27;123_456&#x27;</span>)</span><br><span class="line"><span class="number">123456</span></span><br><span class="line"><span class="title function_">removeNonDigits</span>(<span class="string">&#x27;149,600,000&#x27;</span>)</span><br><span class="line"><span class="number">149600000</span></span><br><span class="line"><span class="title function_">removeNonDigits</span>(<span class="string">&#x27;1,407,836&#x27;</span>)</span><br><span class="line"><span class="number">1407836</span></span><br></pre></td></tr></table></figure>

<h3 id="八、-语法"><a href="#八、-语法" class="headerlink" title="八、&lt;Type&gt; 语法"></a>八、<code>&lt;Type&gt;</code> 语法</h3><h4 id="8-1-TypeScript-断言"><a href="#8-1-TypeScript-断言" class="headerlink" title="8.1 TypeScript 断言"></a>8.1 TypeScript 断言</h4><p>有时候你会遇到这样的情况，你会比 TypeScript 更了解某个值的详细信息。通常这会发生在你清楚地知道一个实体具有比它现有类型更确切的类型。</p>
<p>通过类型断言这种方式可以告诉编译器，“相信我，我知道自己在干什么”。类型断言好比其他语言里的类型转换，但是不进行特殊的数据检查和解构。它没有运行时的影响，只是在编译阶段起作用。</p>
<p>类型断言有两种形式：</p>
<h5 id="8-1-1-“尖括号”-语法"><a href="#8-1-1-“尖括号”-语法" class="headerlink" title="8.1.1 “尖括号” 语法"></a>8.1.1 “尖括号” 语法</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">someValue</span>: <span class="built_in">any</span> = <span class="string">&quot;this is a string&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">strLength</span>: <span class="built_in">number</span> = (&lt;<span class="built_in">string</span>&gt;someValue).<span class="property">length</span>;</span><br></pre></td></tr></table></figure>

<h5 id="8-1-2-as-语法"><a href="#8-1-2-as-语法" class="headerlink" title="8.1.2 as 语法"></a>8.1.2 as 语法</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">someValue</span>: <span class="built_in">any</span> = <span class="string">&quot;this is a string&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">strLength</span>: <span class="built_in">number</span> = (someValue <span class="keyword">as</span> <span class="built_in">string</span>).<span class="property">length</span>;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-TypeScript-泛型"><a href="#8-2-TypeScript-泛型" class="headerlink" title="8.2 TypeScript 泛型"></a>8.2 TypeScript 泛型</h4><p>对于刚接触 TypeScript 泛型的读者来说，首次看到 <code>&lt;T&gt;</code> 语法会感到陌生。其实它没有什么特别，就像传递参数一样，我们传递了我们想要用于特定函数调用的类型。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/blog/typescript/451893401-5ee175dbe37f2_4.jpg" alt="img"></p>
<p>参考上面的图片，当我们调用 <code>identity&lt;Number&gt;(1)</code> ，<code>Number</code> 类型就像参数 <code>1</code> 一样，它将在出现 <code>T</code> 的任何位置填充该类型。图中 <code>&lt;T&gt;</code> 内部的 <code>T</code> 被称为类型变量，它是我们希望传递给 identity 函数的类型占位符，同时它被分配给 <code>value</code> 参数用来代替它的类型：此时 <code>T</code> 充当的是类型，而不是特定的 Number 类型。</p>
<p>其中 <code>T</code> 代表 <strong>Type</strong>，在定义泛型时通常用作第一个类型变量名称。但实际上 <code>T</code> 可以用任何有效名称代替。除了 <code>T</code> 之外，以下是常见泛型变量代表的意思：</p>
<ul>
<li>K（Key）：表示对象中的键类型；</li>
<li>V（Value）：表示对象中的值类型；</li>
<li>E（Element）：表示元素类型。</li>
</ul>
<p>其实并不是只能定义一个类型变量，我们可以引入希望定义的任何数量的类型变量。比如我们引入一个新的类型变量 <code>U</code>，用于扩展我们定义的 <code>identity</code> 函数：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity &lt;T, U&gt;(<span class="attr">value</span>: T, <span class="attr">message</span>: U) : T &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(identity&lt;<span class="title class_">Number</span>, <span class="built_in">string</span>&gt;(<span class="number">68</span>, <span class="string">&quot;Semlinker&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/blog/typescript/1921711313-5ee175ee5d7a4_5.jpg" alt="img"></p>
<p>除了为类型变量显式设定值之外，一种更常见的做法是使编译器自动选择这些类型，从而使代码更简洁。我们可以完全省略尖括号，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity &lt;T, U&gt;(<span class="attr">value</span>: T, <span class="attr">message</span>: U) : T &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">identity</span>(<span class="number">68</span>, <span class="string">&quot;Semlinker&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>对于上述代码，编译器足够聪明，能够知道我们的参数类型，并将它们赋值给 T 和 U，而不需要开发人员显式指定它们。</p>
<h3 id="九、-XXX-装饰器"><a href="#九、-XXX-装饰器" class="headerlink" title="九、@XXX 装饰器"></a>九、@XXX 装饰器</h3><h4 id="9-1-装饰器语法"><a href="#9-1-装饰器语法" class="headerlink" title="9.1 装饰器语法"></a>9.1 装饰器语法</h4><p>对于一些刚接触 TypeScript 的小伙伴来说，在第一次看到 <code>@Plugin(&#123;...&#125;)</code> 这种语法可能会觉得很惊讶。其实这是装饰器的语法，装饰器的本质是一个函数，通过装饰器我们可以方便地定义与对象相关的元数据。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Plugin</span>(&#123;</span><br><span class="line">  <span class="attr">pluginName</span>: <span class="string">&#x27;Device&#x27;</span>,</span><br><span class="line">  <span class="attr">plugin</span>: <span class="string">&#x27;cordova-plugin-device&#x27;</span>,</span><br><span class="line">  <span class="attr">pluginRef</span>: <span class="string">&#x27;device&#x27;</span>,</span><br><span class="line">  <span class="attr">repo</span>: <span class="string">&#x27;https://github.com/apache/cordova-plugin-device&#x27;</span>,</span><br><span class="line">  <span class="attr">platforms</span>: [<span class="string">&#x27;Android&#x27;</span>, <span class="string">&#x27;Browser&#x27;</span>, <span class="string">&#x27;iOS&#x27;</span>, <span class="string">&#x27;macOS&#x27;</span>, <span class="string">&#x27;Windows&#x27;</span>],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Device</span> <span class="keyword">extends</span> <span class="title class_ inherited__">IonicNativePlugin</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>在以上代码中，我们通过装饰器来保存 ionic-native 插件的相关元信息，而 <code>@Plugin(&#123;...&#125;)</code> 中的 <code>@</code> 符号只是语法糖，为什么说是语法糖呢？这里我们来看一下编译生成的 ES5 代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> __decorate = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__decorate</span>) || <span class="keyword">function</span> (<span class="params">decorators, target, key, desc</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> c = <span class="variable language_">arguments</span>.<span class="property">length</span>, r = c &lt; <span class="number">3</span> ? target : desc === <span class="literal">null</span> ? desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(target, key) : desc, d;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Reflect</span> === <span class="string">&quot;object&quot;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">Reflect</span>.<span class="property">decorate</span> === <span class="string">&quot;function&quot;</span>) r = <span class="title class_">Reflect</span>.<span class="title function_">decorate</span>(decorators, target, key, desc);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">for</span> (<span class="keyword">var</span> i = decorators.<span class="property">length</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) <span class="keyword">if</span> (d = decorators[i]) r = (c &lt; <span class="number">3</span> ? <span class="title function_">d</span>(r) : c &gt; <span class="number">3</span> ? <span class="title function_">d</span>(target, key, r) : <span class="title function_">d</span>(target, key)) || r;</span><br><span class="line">    <span class="keyword">return</span> c &gt; <span class="number">3</span> &amp;&amp; r &amp;&amp; <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, key, r), r;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Device</span> = <span class="comment">/** <span class="doctag">@class</span> */</span> (<span class="keyword">function</span> (<span class="params">_super</span>) &#123;</span><br><span class="line">    <span class="title function_">__extends</span>(<span class="title class_">Device</span>, _super);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Device</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _super !== <span class="literal">null</span> &amp;&amp; _super.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>) || <span class="variable language_">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Device</span> = <span class="title function_">__decorate</span>([</span><br><span class="line">        <span class="title class_">Plugin</span>(&#123;</span><br><span class="line">            <span class="attr">pluginName</span>: <span class="string">&#x27;Device&#x27;</span>,</span><br><span class="line">            <span class="attr">plugin</span>: <span class="string">&#x27;cordova-plugin-device&#x27;</span>,</span><br><span class="line">            <span class="attr">pluginRef</span>: <span class="string">&#x27;device&#x27;</span>,</span><br><span class="line">            <span class="attr">repo</span>: <span class="string">&#x27;https://github.com/apache/cordova-plugin-device&#x27;</span>,</span><br><span class="line">            <span class="attr">platforms</span>: [<span class="string">&#x27;Android&#x27;</span>, <span class="string">&#x27;Browser&#x27;</span>, <span class="string">&#x27;iOS&#x27;</span>, <span class="string">&#x27;macOS&#x27;</span>, <span class="string">&#x27;Windows&#x27;</span>],</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="title class_">Injectable</span>()</span><br><span class="line">    ], <span class="title class_">Device</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Device</span>;</span><br><span class="line">&#125;(<span class="title class_">IonicNativePlugin</span>));</span><br></pre></td></tr></table></figure>

<p>通过生成的代码可知，<code>@Plugin(&#123;...&#125;)</code> 和 <code>@Injectable()</code> 最终会被转换成普通的方法调用，它们的调用结果最终会以数组的形式作为参数传递给 <code>__decorate</code> 函数，而在 <code>__decorate</code> 函数内部会以 <code>Device</code> 类作为参数调用各自的类型装饰器，从而扩展对应的功能。</p>
<h4 id="9-2-装饰器的分类"><a href="#9-2-装饰器的分类" class="headerlink" title="9.2 装饰器的分类"></a>9.2 装饰器的分类</h4><p>在 TypeScript 中装饰器分为类装饰器、属性装饰器、方法装饰器和参数装饰器四大类。</p>
<h5 id="9-2-1-类装饰器"><a href="#9-2-1-类装饰器" class="headerlink" title="9.2.1 类装饰器"></a>9.2.1 类装饰器</h5><p>类装饰器声明：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">ClassDecorator</span> = &lt;<span class="title class_">TFunction</span> <span class="keyword">extends</span> <span class="title class_">Function</span>&gt;<span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  target: TFunction</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="title class_">TFunction</span> | <span class="built_in">void</span>;</span><br></pre></td></tr></table></figure>

<p>类装饰器顾名思义，就是用来装饰类的。它接收一个参数：</p>
<ul>
<li>target: TFunction - 被装饰的类</li>
</ul>
<p>看完第一眼后，是不是感觉都不好了。没事，我们马上来个例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Greeter</span>(<span class="params">target: <span class="built_in">Function</span></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">  target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">greet</span> = <span class="keyword">function</span> (<span class="params"></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello Semlinker!&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Greeter</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Greeting</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 内部实现</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myGreeting = <span class="keyword">new</span> <span class="title class_">Greeting</span>();</span><br><span class="line">myGreeting.<span class="title function_">greet</span>(); <span class="comment">// console output: &#x27;Hello Semlinker!&#x27;;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，我们定义了 <code>Greeter</code> 类装饰器，同时我们使用了 <code>@Greeter</code> 语法糖，来使用装饰器。</p>
<blockquote>
<p>友情提示：读者可以直接复制上面的代码，在 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play/index.html">TypeScript Playground</a> 中运行查看结果。</p>
</blockquote>
<h5 id="9-2-2-属性装饰器"><a href="#9-2-2-属性装饰器" class="headerlink" title="9.2.2 属性装饰器"></a>9.2.2 属性装饰器</h5><p>属性装饰器声明：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">PropertyDecorator</span> = <span class="function">(<span class="params">target:<span class="built_in">Object</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">  propertyKey: <span class="built_in">string</span> | <span class="built_in">symbol</span> </span>) =&gt;</span> <span class="built_in">void</span>;</span><br></pre></td></tr></table></figure>

<p>属性装饰器顾名思义，用来装饰类的属性。它接收两个参数：</p>
<ul>
<li>target: Object - 被装饰的类</li>
<li>propertyKey: string | symbol - 被装饰类的属性名</li>
</ul>
<p>趁热打铁，马上来个例子热热身：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">logProperty</span>(<span class="params">target: <span class="built_in">any</span>, key: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">delete</span> target[key];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> backingField = <span class="string">&quot;_&quot;</span> + key;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, backingField, &#123;</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// property getter</span></span><br><span class="line">  <span class="keyword">const</span> getter = <span class="keyword">function</span> (<span class="params"><span class="variable language_">this</span>: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> currVal = <span class="variable language_">this</span>[backingField];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Get: <span class="subst">$&#123;key&#125;</span> =&gt; <span class="subst">$&#123;currVal&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> currVal;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// property setter</span></span><br><span class="line">  <span class="keyword">const</span> setter = <span class="keyword">function</span> (<span class="params"><span class="variable language_">this</span>: <span class="built_in">any</span>, newVal: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Set: <span class="subst">$&#123;key&#125;</span> =&gt; <span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">this</span>[backingField] = newVal;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create new property with getter and setter</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, key, &#123;</span><br><span class="line">    <span class="attr">get</span>: getter,</span><br><span class="line">    <span class="attr">set</span>: setter,</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123; </span><br><span class="line">  <span class="meta">@logProperty</span></span><br><span class="line">  <span class="keyword">public</span> <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name : <span class="built_in">string</span></span>) &#123; </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;semlinker&quot;</span>);</span><br><span class="line">p1.<span class="property">name</span> = <span class="string">&quot;kakuqo&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>以上代码我们定义了一个 <code>logProperty</code> 函数，来跟踪用户对属性的操作，当代码成功运行后，在控制台会输出以下结果：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Set</span>: <span class="function"><span class="params">name</span> =&gt;</span> semlinker</span><br><span class="line"><span class="title class_">Set</span>: <span class="function"><span class="params">name</span> =&gt;</span> kakuqo</span><br></pre></td></tr></table></figure>

<h5 id="9-2-3-方法装饰器"><a href="#9-2-3-方法装饰器" class="headerlink" title="9.2.3 方法装饰器"></a>9.2.3 方法装饰器</h5><p>方法装饰器声明：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">MethodDecorator</span> = &lt;T&gt;<span class="function">(<span class="params">target:<span class="built_in">Object</span>, propertyKey: <span class="built_in">string</span> | <span class="built_in">symbol</span>,          </span></span></span><br><span class="line"><span class="params"><span class="function">  descriptor: TypePropertyDescript&lt;T&gt;</span>) =&gt;</span> <span class="title class_">TypedPropertyDescriptor</span>&lt;T&gt; | <span class="built_in">void</span>;</span><br></pre></td></tr></table></figure>

<p>方法装饰器顾名思义，用来装饰类的方法。它接收三个参数：</p>
<ul>
<li>target: Object - 被装饰的类</li>
<li>propertyKey: string | symbol - 方法名</li>
<li>descriptor: TypePropertyDescript - 属性描述符</li>
</ul>
<p>废话不多说，直接上例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">LogOutput</span>(<span class="params">tarage: <span class="built_in">Function</span>, key: <span class="built_in">string</span>, descriptor: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> originalMethod = descriptor.<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">let</span> newMethod = <span class="keyword">function</span>(<span class="params">...args: <span class="built_in">any</span>[]</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">result</span>: <span class="built_in">any</span> = originalMethod.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">loggedOutput</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">loggedOutput</span> = <span class="keyword">new</span> <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loggedOutput</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">method</span>: key,</span><br><span class="line">      <span class="attr">parameters</span>: args,</span><br><span class="line">      <span class="attr">output</span>: result,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line">  descriptor.<span class="property">value</span> = newMethod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">  <span class="meta">@LogOutput</span></span><br><span class="line">  double (<span class="attr">num</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num * <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> calc = <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">calc.<span class="title function_">double</span>(<span class="number">11</span>);</span><br><span class="line"><span class="comment">// console ouput: [&#123;method: &quot;double&quot;, output: 22, ...&#125;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(calc.<span class="property">loggedOutput</span>); </span><br></pre></td></tr></table></figure>

<h5 id="9-2-4-参数装饰器"><a href="#9-2-4-参数装饰器" class="headerlink" title="9.2.4 参数装饰器"></a>9.2.4 参数装饰器</h5><p>参数装饰器声明：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">ParameterDecorator</span> = <span class="function">(<span class="params">target: <span class="built_in">Object</span>, propertyKey: <span class="built_in">string</span> | <span class="built_in">symbol</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">  parameterIndex: <span class="built_in">number</span> </span>) =&gt;</span> <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>参数装饰器顾名思义，是用来装饰函数参数，它接收三个参数：</p>
<ul>
<li>target: Object - 被装饰的类</li>
<li>propertyKey: string | symbol - 方法名</li>
<li>parameterIndex: number - 方法中参数的索引值</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Log</span>(<span class="params">target: <span class="built_in">Function</span>, key: <span class="built_in">string</span>, parameterIndex: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> functionLogged = key || target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>.<span class="property">name</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`The parameter in position <span class="subst">$&#123;parameterIndex&#125;</span> at <span class="subst">$&#123;functionLogged&#125;</span> has</span></span><br><span class="line"><span class="string">    been decorated`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Greeter</span> &#123;</span><br><span class="line">  <span class="attr">greeting</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="meta">@Log</span> phrase: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">greeting</span> = phrase; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// console output: The parameter in position 0 </span></span><br><span class="line"><span class="comment">// at Greeter has been decorated</span></span><br></pre></td></tr></table></figure>

<h3 id="十、-XXX-私有字段"><a href="#十、-XXX-私有字段" class="headerlink" title="十、#XXX 私有字段"></a>十、#XXX 私有字段</h3><p>在 TypeScript 3.8 版本就开始支持 <strong>ECMAScript 私有字段</strong>，使用方式如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  #<span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.#name&#125;</span>!`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> semlinker = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Semlinker&quot;</span>);</span><br><span class="line"></span><br><span class="line">semlinker.#name;</span><br><span class="line"><span class="comment">//     ~~~~~</span></span><br><span class="line"><span class="comment">// Property &#x27;#name&#x27; is not accessible outside class &#x27;Person&#x27;</span></span><br><span class="line"><span class="comment">// because it has a private identifier.</span></span><br></pre></td></tr></table></figure>

<p>与常规属性（甚至使用 <code>private</code> 修饰符声明的属性）不同，私有字段要牢记以下规则：</p>
<ul>
<li>私有字段以 <code>#</code> 字符开头，有时我们称之为私有名称；</li>
<li>每个私有字段名称都唯一地限定于其包含的类；</li>
<li>不能在私有字段上使用 TypeScript 可访问性修饰符（如 public 或 private）；</li>
<li>私有字段不能在包含的类之外访问，甚至不能被检测到。</li>
</ul>
<h4 id="10-1-私有字段与-private-的区别"><a href="#10-1-私有字段与-private-的区别" class="headerlink" title="10.1 私有字段与 private 的区别"></a>10.1 私有字段与 private 的区别</h4><p>说到这里使用 <code>#</code> 定义的私有字段与 <code>private</code> 修饰符定义字段有什么区别呢？现在我们先来看一个 <code>private</code> 的示例：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> name: <span class="built_in">string</span></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Semlinker&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<p>在上面代码中，我们创建了一个 Person 类，该类中使用 <code>private</code> 修饰符定义了一个私有属性 <code>name</code>，接着使用该类创建一个 <code>person</code> 对象，然后通过 <code>person.name</code> 来访问 <code>person</code> 对象的私有属性，这时 TypeScript 编译器会提示以下异常：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Property</span> <span class="string">&#x27;name&#x27;</span> is <span class="keyword">private</span> and only accessible within <span class="keyword">class</span> <span class="string">&#x27;Person&#x27;</span>.(<span class="number">2341</span>)</span><br></pre></td></tr></table></figure>

<p>那如何解决这个异常呢？当然你可以使用类型断言把 person 转为 any 类型：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>((person <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<p>通过这种方式虽然解决了 TypeScript 编译器的异常提示，但是在运行时我们还是可以访问到 <code>Person</code> 类内部的私有属性，为什么会这样呢？我们来看一下编译生成的 ES5 代码，也许你就知道答案了：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Person</span> = <span class="comment">/** <span class="doctag">@class</span> */</span> (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Person</span>;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Semlinker&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<p>这时相信有些小伙伴会好奇，在 TypeScript 3.8 以上版本通过 <code>#</code> 号定义的私有字段编译后会生成什么代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  #<span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.#name&#125;</span>!`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码目标设置为 ES2015，会编译生成以下代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> __classPrivateFieldSet = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__classPrivateFieldSet</span>) </span><br><span class="line">  || <span class="keyword">function</span> (<span class="params">receiver, privateMap, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!privateMap.<span class="title function_">has</span>(receiver)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;attempted to set private field on non-instance&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    privateMap.<span class="title function_">set</span>(receiver, value);</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> __classPrivateFieldGet = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__classPrivateFieldGet</span>) </span><br><span class="line">  || <span class="keyword">function</span> (<span class="params">receiver, privateMap</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!privateMap.<span class="title function_">has</span>(receiver)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;attempted to get private field on non-instance&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> privateMap.<span class="title function_">get</span>(receiver);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _name;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">      _name.<span class="title function_">set</span>(<span class="variable language_">this</span>, <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line">      <span class="title function_">__classPrivateFieldSet</span>(<span class="variable language_">this</span>, _name, name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;__classPrivateFieldGet(<span class="variable language_">this</span>, _name)&#125;</span>!`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">_name = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br></pre></td></tr></table></figure>

<p>通过观察上述代码，使用 <code>#</code> 号定义的 ECMAScript 私有字段，会通过 <code>WeakMap</code> 对象来存储，同时编译器会生成 <code>__classPrivateFieldSet</code> 和 <code>__classPrivateFieldGet</code> 这两个方法用于设置值和获取值。</p>
<h3 id="十一、参考资源"><a href="#十一、参考资源" class="headerlink" title="十一、参考资源"></a>十一、参考资源</h3><ul>
<li><a target="_blank" rel="noopener" href="https://2ality.com/2018/02/numeric-separators.html">ES proposal: numeric separators</a></li>
<li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/">typescriptlang.org</a></li>
</ul>
<h3 id="十二、推荐阅读"><a href="#十二、推荐阅读" class="headerlink" title="十二、推荐阅读"></a>十二、推荐阅读</h3><ul>
<li><a target="_blank" rel="noopener" href="http://www.semlinker.com/ts-quickstart-2020/">了不起的 TypeScript 入门教程</a></li>
<li><a target="_blank" rel="noopener" href="http://www.semlinker.com/master-ts-generic/">一文读懂 TypeScript 泛型及应用</a></li>
<li><a target="_blank" rel="noopener" href="http://www.semlinker.com/you-dont-know-websocket/">你不知道的 WebSocket</a></li>
<li><a target="_blank" rel="noopener" href="http://www.semlinker.com/you-dont-know-blob/">你不知道的 Blob</a></li>
<li><a target="_blank" rel="noopener" href="http://www.semlinker.com/you-dont-know-weakmap/">你不知道的 WeakMap</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io">Blank</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io/posts/168b0f7a/">https://wangyyovo.github.io/posts/168b0f7a/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://wangyyovo.github.io" target="_blank">Blank</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/typescript/">typescript</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/c47179b9/" title="Wireshark过滤器表达式"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/087f5330b37f6a52f3510424eed4e3fb.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Wireshark过滤器表达式</div></div><div class="info-2"><div class="info-item-1"> 过滤器表达式 Wireshark Version 3.4.7 (v3.4.7-0-ge42cbf6a415f)  Wireshark 提供了一种显示过滤语言，使您能够精确控制显示哪些数据包。 它们可用于检查协议或字段的存在、字段的值，甚至可以将两个字段相互比较。 这些比较可以与逻辑运算符（如“and”和“or”）以及括号组合成复杂的表达式。  以下部分将更详细地介绍显示过滤器功能。 更多操作提示 Wireshark Wiki 显示过滤器页面 上有许多显示过滤器示例： https://gitlab.com/wireshark/wireshark/wikis/DisplayFilters 过滤器字段最简单的显示过滤器是单个协议的过滤器。要显示包含特定协议的数据包，请在 Wireshark 的显示过滤器工具栏中键入协议。 例如，要仅显示 TCP 数据包，请在 Wireshark 的显示过滤器工具栏中键入 tcp。 同样，要显示包含特定字段的数据包，请在 Wireshark 的显示过滤器工具栏中键入该字段。 例如，要仅显示 HTTP 请求，请在 Wireshark 的显示过滤器工具栏中...</div></div></div></a><a class="pagination-related" href="/posts/5b4d812a/" title="Nginx Ingress注解Annotations"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/7ad9570c1892b128f84b9971f7946fc4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Nginx Ingress注解Annotations</div></div><div class="info-2"><div class="info-item-1"> Nginx Ingress注解Annotations https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/  Nginx Ingress 注解使用在 Ingress 资源实例中，用以设置当前 Ingress 资源实例中 Nginx 虚拟主机的相关配置，对应配置的是 Nginx 当前虚拟主机的 server 指令域内容。在与 Nginx Ingress 配置映射具有相同功能配置时，将按照所在指令域层级遵循 Nginx 配置规则覆盖。 Nginx Ingress注解按照配置功能有如下分类。 1、Nginx原生配置指令支持在注解中添加 Nginx 原生配置指令。配置说明如下表所示。    注解 类型 功能描述    nginx.ingress.kubernetes.io&#x2F;server-snippet string 在 server 指令域添加 Nginx 配置指令   nginx.ingress.kubernetes.io&#x2F;configurati...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/7ba6bd2/" title="快速搭建一个TypeScript项目"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-03</div><div class="info-item-2">快速搭建一个TypeScript项目</div></div><div class="info-2"><div class="info-item-1"> 快速搭建一个TypeScript项目在团队开发中为了更好的协作，我们应该在项目中制定各种规则，比如：代码风格、变量命名、文件命名、git commit 提交格式等等。 这篇文章就介绍如何搭建快速搭建一个具有自定义规则的 TypeScript 项目。 创建项目1234$ mkdir ts-project$ cd ts-project$ yarn init$ git init  创建.gitignore123456789101112131415161718192021222324252627# serverserver/.DS_Storenode_modules/dist/npm-debug.log*yarn-debug.log*yarn-error.log*test/unit/coveragetest/e2e/reportsselenium-debug.logdoc/lib/# Editor directories and files.idea.vscode*.suo*.ntvs**.njsproj*.sln# cache.sass-cache/# package-lock.js...</div></div></div></a><a class="pagination-related" href="/posts/a50a4073/" title="TypeScript高级类型"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/typescript/773e7dd8015bcc418c9ff401e9a02588.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-29</div><div class="info-item-2">TypeScript高级类型</div></div><div class="info-2"><div class="info-item-1"> TypeScript高级类型 https://www.cnblogs.com/tangshiwei/p/12052494.html  前言对于有 JavaScript 基础的同学来说，入门 TypeScript 其实很容易，只需要简单掌握其基础的类型系统就可以逐步将 JS 应用过渡到 TS 应用。 1234// jsconst double = (num) =&gt; 2 * num// tsconst double = (num: number): number =&gt; 2 * num  然而，当应用越来越复杂，我们很容易把一些变量设置为 any 类型，TypeScript 写着写着也就成了 AnyScript。为了让大家能更加深入的了解 TypeScript 的类型系统，本文将重点介绍其高级类型，帮助大家摆脱 AnyScript。 泛型在讲解高级类型之前，我们需要先简单理解泛型是什么。 泛型是强类型语言中比较重要的一个概念，合理的使用泛型可以提升代码的可复用性，让系统更加灵活。下面是维基百科对泛型的描述： 泛型允许程序员在强类型程序设计语言中编写代码时使用一些以后才指定...</div></div></div></a><a class="pagination-related" href="/posts/c7ecdf25/" title="Typescript中的interface和type"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/typescript/aeb261dce302ffcf1bb02a965c96b2e2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-29</div><div class="info-item-2">Typescript中的interface和type</div></div><div class="info-2"><div class="info-item-1"> Typescript中的interface和type到底有什么区别详解相同点都可以描述一个对象或者函数 interface 12345678interface User &#123; name: string age: number&#125; interface SetUser &#123; (name: string, age: number): void;&#125;  type 123456789101112type User = &#123; name: string age: number&#125;;type SetUser = (name: string, age: number): void;type Tuple = [number, string];const a: Tuple = [2, &#x27;sir&#x27;];type Size = &#x27;small&#x27; | &#x27;default&#x27; | &#x27;big&#x27; | number;const b: Size = 24;  都允许拓展（extends） inte...</div></div></div></a><a class="pagination-related" href="/posts/9f47fabe/" title="typescript学习笔记"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/typescript/efa24028d4cd9b621b972925b15fcabb.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-26</div><div class="info-item-2">typescript学习笔记</div></div><div class="info-2"><div class="info-item-1"> typescript学习笔记 https://gitee.com/samuelsue/typescript-learning-notes  配置ts运行环境需要安装的依赖 123456789101112&quot;devDependencies&quot;: &#123;    &quot;@typescript-eslint/eslint-plugin&quot;: &quot;^3.1.0&quot;,    &quot;@typescript-eslint/parser&quot;: &quot;^3.1.0&quot;,    &quot;clean-webpack-plugin&quot;: &quot;^3.0.0&quot;,    &quot;eslint&quot;: &quot;^7.2.0&quot;,    &quot;html-webpack-plugin&quot;: &quot;^4.3.0&quot;,    &quot;ts-loader&quot;: &quot;^7.0.5&quot;,    &quot;webpack&quot;: &q...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Blank</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">356</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">54</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/wangyyovo" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%86%E6%95%B0-TS-%E4%B8%AD%E9%82%A3%E4%BA%9B%E5%A5%87%E6%80%AA%E7%9A%84%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.</span> <span class="toc-text">细数 TS 中那些奇怪的符号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81-%E9%9D%9E%E7%A9%BA%E6%96%AD%E8%A8%80%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">1.0.1.</span> <span class="toc-text">一、! 非空断言操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%BF%BD%E7%95%A5-undefined-%E5%92%8C-null-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">1.1 忽略 undefined 和 null 类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E6%97%B6%E5%BF%BD%E7%95%A5-undefined-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.0.1.2.</span> <span class="toc-text">1.2 调用函数时忽略 undefined 类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.0.2.</span> <span class="toc-text">二、?. 运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E5%8F%AF%E9%80%89%E5%85%83%E7%B4%A0%E8%AE%BF%E9%97%AE"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">2.1 可选元素访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%8F%AF%E9%80%89%E9%93%BE%E4%B8%8E%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">2.2 可选链与函数调用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81-%E7%A9%BA%E5%80%BC%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.0.3.</span> <span class="toc-text">三、?? 空值合并运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">3.1 短路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E4%B8%8D%E8%83%BD%E4%B8%8E-%E6%88%96-%E6%93%8D%E4%BD%9C%E7%AC%A6%E5%85%B1%E7%94%A8"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">3.2 不能与 &amp;&amp; 或 || 操作符共用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E4%B8%8E%E5%8F%AF%E9%80%89%E9%93%BE%E6%93%8D%E4%BD%9C%E7%AC%A6-%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.0.3.3.</span> <span class="toc-text">3.3 与可选链操作符 ?. 的关系</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7"><span class="toc-number">1.0.4.</span> <span class="toc-text">四、?: 可选属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">4.1 工具类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-1-Partial"><span class="toc-number">1.0.4.1.1.</span> <span class="toc-text">4.1.1 Partial&lt;T&gt;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-Required"><span class="toc-number">1.0.4.1.2.</span> <span class="toc-text">4.1.2 Required&lt;T&gt;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.0.5.</span> <span class="toc-text">五、&amp; 运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E5%90%8C%E5%90%8D%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E7%9A%84%E5%90%88%E5%B9%B6"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">5.1 同名基础类型属性的合并</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-%E5%90%8C%E5%90%8D%E9%9D%9E%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%E7%9A%84%E5%90%88%E5%B9%B6"><span class="toc-number">1.0.5.2.</span> <span class="toc-text">5.2 同名非基础类型属性的合并</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81-%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">1.0.6.</span> <span class="toc-text">六、| 分隔符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-number">1.0.6.1.</span> <span class="toc-text">6.1 类型保护</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-1-in-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.0.6.1.1.</span> <span class="toc-text">6.1.1 in 关键字</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-2-typeof-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.0.6.1.2.</span> <span class="toc-text">6.1.2 typeof 关键字</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-3-instanceof-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.0.6.1.3.</span> <span class="toc-text">6.1.3 instanceof 关键字</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%B0%93%E8%AF%8D%EF%BC%88type-predicate%EF%BC%89"><span class="toc-number">1.0.6.1.4.</span> <span class="toc-text">6.1.4 自定义类型保护的类型谓词（type predicate）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81-%E6%95%B0%E5%AD%97%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">1.0.7.</span> <span class="toc-text">七、_ 数字分隔符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-%E4%BD%BF%E7%94%A8%E9%99%90%E5%88%B6"><span class="toc-number">1.0.7.1.</span> <span class="toc-text">7.1 使用限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-%E8%A7%A3%E6%9E%90%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">1.0.7.2.</span> <span class="toc-text">7.2 解析分隔符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AB%E3%80%81-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.0.8.</span> <span class="toc-text">八、&lt;Type&gt; 语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-TypeScript-%E6%96%AD%E8%A8%80"><span class="toc-number">1.0.8.1.</span> <span class="toc-text">8.1 TypeScript 断言</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-1-%E2%80%9C%E5%B0%96%E6%8B%AC%E5%8F%B7%E2%80%9D-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.0.8.1.1.</span> <span class="toc-text">8.1.1 “尖括号” 语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-2-as-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.0.8.1.2.</span> <span class="toc-text">8.1.2 as 语法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-TypeScript-%E6%B3%9B%E5%9E%8B"><span class="toc-number">1.0.8.2.</span> <span class="toc-text">8.2 TypeScript 泛型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9D%E3%80%81-XXX-%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">1.0.9.</span> <span class="toc-text">九、@XXX 装饰器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%AD%E6%B3%95"><span class="toc-number">1.0.9.1.</span> <span class="toc-text">9.1 装饰器语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.0.9.2.</span> <span class="toc-text">9.2 装饰器的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#9-2-1-%E7%B1%BB%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">1.0.9.2.1.</span> <span class="toc-text">9.2.1 类装饰器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-2-2-%E5%B1%9E%E6%80%A7%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">1.0.9.2.2.</span> <span class="toc-text">9.2.2 属性装饰器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-2-3-%E6%96%B9%E6%B3%95%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">1.0.9.2.3.</span> <span class="toc-text">9.2.3 方法装饰器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-2-4-%E5%8F%82%E6%95%B0%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">1.0.9.2.4.</span> <span class="toc-text">9.2.4 参数装饰器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E3%80%81-XXX-%E7%A7%81%E6%9C%89%E5%AD%97%E6%AE%B5"><span class="toc-number">1.0.10.</span> <span class="toc-text">十、#XXX 私有字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-%E7%A7%81%E6%9C%89%E5%AD%97%E6%AE%B5%E4%B8%8E-private-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.0.10.1.</span> <span class="toc-text">10.1 私有字段与 private 的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90"><span class="toc-number">1.0.11.</span> <span class="toc-text">十一、参考资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB"><span class="toc-number">1.0.12.</span> <span class="toc-text">十二、推荐阅读</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d14168d/" title="虚拟机问题合集"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="虚拟机问题合集"/></a><div class="content"><a class="title" href="/posts/d14168d/" title="虚拟机问题合集">虚拟机问题合集</a><time datetime="2022-07-16T13:30:36.000Z" title="发表于 2022-07-16 21:30:36">2022-07-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f540045f/" title="用go语言编写移动端sdk和app开发"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/941ed1ec2925719a0c92e76f4f786b6a.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用go语言编写移动端sdk和app开发"/></a><div class="content"><a class="title" href="/posts/f540045f/" title="用go语言编写移动端sdk和app开发">用go语言编写移动端sdk和app开发</a><time datetime="2022-07-04T12:14:21.000Z" title="发表于 2022-07-04 20:14:21">2022-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5faac006/" title="在线编程IDE"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在线编程IDE"/></a><div class="content"><a class="title" href="/posts/5faac006/" title="在线编程IDE">在线编程IDE</a><time datetime="2022-06-12T13:30:36.000Z" title="发表于 2022-06-12 21:30:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7594185d/" title="即时性能分析工具Pyroscope"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/3bfb3279740bc9a5b5ef436fa887ef07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="即时性能分析工具Pyroscope"/></a><div class="content"><a class="title" href="/posts/7594185d/" title="即时性能分析工具Pyroscope">即时性能分析工具Pyroscope</a><time datetime="2022-06-12T08:07:36.000Z" title="发表于 2022-06-12 16:07:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/82a7aa7c/" title="golang性能调试优化方法"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="golang性能调试优化方法"/></a><div class="content"><a class="title" href="/posts/82a7aa7c/" title="golang性能调试优化方法">golang性能调试优化方法</a><time datetime="2022-06-12T03:00:36.000Z" title="发表于 2022-06-12 11:00:36">2022-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Blank</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.2</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>