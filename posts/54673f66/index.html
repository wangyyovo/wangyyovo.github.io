<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>golangæ•°æ®ç»“æ„ç®—æ³• | Blank</title><meta name="author" content="Blank"><meta name="copyright" content="Blank"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1.æ’åº1.1 å†’æ³¡æ’åº1.1.1 å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆæ£€æµ‹æ˜¯å¦å·²æå‰æœ‰åº 12345678910111213141516171819202122232425262728293031323334353637383940414243444546package mainimport (	&quot;fmt&quot;	&quot;math&#x2F;rand&quot;	&quot;time&quot;)&#x2F;&#x2F; è·å–">
<meta property="og:type" content="article">
<meta property="og:title" content="golangæ•°æ®ç»“æ„ç®—æ³•">
<meta property="og:url" content="https://wangyyovo.github.io/posts/54673f66/">
<meta property="og:site_name" content="Blank">
<meta property="og:description" content="1.æ’åº1.1 å†’æ³¡æ’åº1.1.1 å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆæ£€æµ‹æ˜¯å¦å·²æå‰æœ‰åº 12345678910111213141516171819202122232425262728293031323334353637383940414243444546package mainimport (	&quot;fmt&quot;	&quot;math&#x2F;rand&quot;	&quot;time&quot;)&#x2F;&#x2F; è·å–">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/algorithm/38b729ad735ef910dc048dd9c1a11743.jpg">
<meta property="article:published_time" content="2019-11-22T10:00:36.000Z">
<meta property="article:modified_time" content="2019-11-22T10:00:36.000Z">
<meta property="article:author" content="Blank">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/algorithm/38b729ad735ef910dc048dd9c1a11743.jpg"><link rel="shortcut icon" href="https://raw.githubusercontents.com/wangyyovo/CDN/master/theme/favicon.ico"><link rel="canonical" href="https://wangyyovo.github.io/posts/54673f66/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'golangæ•°æ®ç»“æ„ç®—æ³•',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2019-11-22 18:00:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="alternate" href="/atom.xml" title="Blank" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontents.com/wangyyovo/CDN/master/theme/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">356</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">54</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> ç›¸å†Œ</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ•™ç¨‹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li><li><a class="site-page child" href="/posts/507c070f/"><span> ğŸ“‘ Aplayeræ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/2df239ce/"><span> ğŸ“‘ æ¨™ç±¤å¤–æ›</span></a></li><li><a class="site-page child" href="/posts/b37b5fe3/"><span> ğŸ“‘ è‡ªå®šç¾©ä»£ç¢¼é…è‰²</span></a></li><li><a class="site-page child" href="/posts/ea33ab97/"><span> ğŸ“‘ è‡ªå®šç¾©å´é‚Šæ¬„</span></a></li><li><a class="site-page child" href="/posts/89757140/"><span> ğŸ“‘ Markdown</span></a></li><li><a class="site-page child" href="/posts/9db656e5/"><span> ğŸ“‘ ä»£ç é«˜äº®æµ‹è¯•</span></a></li><li><a class="site-page child" href="/posts/c9711c19/"><span> ğŸ“‘ ç•¶è¨­ç½®top_imgç‚ºfalseæ™‚</span></a></li><li><a class="site-page child" href="/posts/39b121ef/"><span> ğŸ“‘ Hexoå…§ç½®æ¨™ç±¤å¤–æ›</span></a></li><li><a class="site-page child" href="/posts/7670b080/"><span> ğŸ“‘ Butterfly ç¾åŒ–/å„ªåŒ–/é­”æ”¹ æ•™ç¨‹åˆé›†</span></a></li><li><a class="site-page child" href="/posts/913b2502/"><span> ğŸ“‘ æ²¡æœ‰å°é¢</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/algorithm/38b729ad735ef910dc048dd9c1a11743.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Blank</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> ç›¸å†Œ</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ•™ç¨‹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li><li><a class="site-page child" href="/posts/507c070f/"><span> ğŸ“‘ Aplayeræ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/2df239ce/"><span> ğŸ“‘ æ¨™ç±¤å¤–æ›</span></a></li><li><a class="site-page child" href="/posts/b37b5fe3/"><span> ğŸ“‘ è‡ªå®šç¾©ä»£ç¢¼é…è‰²</span></a></li><li><a class="site-page child" href="/posts/ea33ab97/"><span> ğŸ“‘ è‡ªå®šç¾©å´é‚Šæ¬„</span></a></li><li><a class="site-page child" href="/posts/89757140/"><span> ğŸ“‘ Markdown</span></a></li><li><a class="site-page child" href="/posts/9db656e5/"><span> ğŸ“‘ ä»£ç é«˜äº®æµ‹è¯•</span></a></li><li><a class="site-page child" href="/posts/c9711c19/"><span> ğŸ“‘ ç•¶è¨­ç½®top_imgç‚ºfalseæ™‚</span></a></li><li><a class="site-page child" href="/posts/39b121ef/"><span> ğŸ“‘ Hexoå…§ç½®æ¨™ç±¤å¤–æ›</span></a></li><li><a class="site-page child" href="/posts/7670b080/"><span> ğŸ“‘ Butterfly ç¾åŒ–/å„ªåŒ–/é­”æ”¹ æ•™ç¨‹åˆé›†</span></a></li><li><a class="site-page child" href="/posts/913b2502/"><span> ğŸ“‘ æ²¡æœ‰å°é¢</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">golangæ•°æ®ç»“æ„ç®—æ³•</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2019-11-22T10:00:36.000Z" title="å‘è¡¨äº 2019-11-22 18:00:36">2019-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2019-11-22T10:00:36.000Z" title="æ›´æ–°äº 2019-11-22 18:00:36">2019-11-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/algorithm/">algorithm</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">30.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>170åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="golangæ•°æ®ç»“æ„ç®—æ³•"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src="\assets\js\APlayer.min.js"> </script><h1 id="1-æ’åº"><a href="#1-æ’åº" class="headerlink" title="1.æ’åº"></a>1.æ’åº</h1><h2 id="1-1-å†’æ³¡æ’åº"><a href="#1-1-å†’æ³¡æ’åº" class="headerlink" title="1.1 å†’æ³¡æ’åº"></a>1.1 å†’æ³¡æ’åº</h2><h3 id="1-1-1-å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆ"><a href="#1-1-1-å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆ" class="headerlink" title="1.1.1 å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆ"></a>1.1.1 å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆ</h3><p><strong>æ£€æµ‹æ˜¯å¦å·²æå‰æœ‰åº</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BubbleSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="comment">// éå†æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">	<span class="keyword">var</span> isSorted <span class="type">bool</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		isSorted = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; n-i<span class="number">-1</span>; j++ &#123;</span><br><span class="line">			<span class="comment">// å·¦å…ƒç´  &gt; å³å…ƒç´ </span></span><br><span class="line">			<span class="keyword">if</span> arr[j] &gt; arr[j+<span class="number">1</span>] &#123;</span><br><span class="line">				arr[j], arr[j+<span class="number">1</span>] = arr[j+<span class="number">1</span>], arr[j]</span><br><span class="line">				<span class="comment">// å‘ç”Ÿäº¤æ¢åˆ™è¿˜æœªæ’åºå®Œæ¯•</span></span><br><span class="line">				isSorted = <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Println(<span class="string">&quot;[DEBUG]:\t&quot;</span>, arr)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ²¡æœ‰å‘ç”Ÿäº¤æ¢åˆ™è¯´æ˜æ’åºå®Œæˆ</span></span><br><span class="line">		<span class="keyword">if</span> isSorted &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = BubbleSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼©çŸ­æ‰«æè·ç¦»</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BubbleSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	end := n - <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> end &gt; <span class="number">0</span> &#123;</span><br><span class="line">		cur := <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; end; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> arr[j] &gt; arr[j+<span class="number">1</span>] &#123;</span><br><span class="line">				arr[j], arr[j+<span class="number">1</span>] = arr[j+<span class="number">1</span>], arr[j]</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// è®°å½•æ¯è¶Ÿæœ€åå‘ç”Ÿäº¤æ¢çš„ä½ç½®ï¼Œæ­¤ä½ç½®ä¹‹åå‡å·²æœ‰åºï¼Œä¸‹ä¸€è¶Ÿåªéœ€éå†åˆ°æ­¤ä½ç½®å³å¯</span></span><br><span class="line">			cur = j</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG]:\t&quot;</span>, arr)</span><br><span class="line">		end = cur</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = BubbleSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="1-1-2-åŒå‘å†’æ³¡æ’åº-é¸¡å°¾é…’æ’åº"><a href="#1-1-2-åŒå‘å†’æ³¡æ’åº-é¸¡å°¾é…’æ’åº" class="headerlink" title="1.1.2 åŒå‘å†’æ³¡æ’åº(é¸¡å°¾é…’æ’åº)"></a>1.1.2 åŒå‘å†’æ³¡æ’åº(é¸¡å°¾é…’æ’åº)</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BubbleSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	left := <span class="number">0</span></span><br><span class="line">	right := n - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// left  ä»¥å·¦å·²æœ‰åº</span></span><br><span class="line">	<span class="comment">// right ä»¥å³å·²æœ‰åº</span></span><br><span class="line">	<span class="comment">// ä¸¤ä¸ªåŒºé—´æ¸¸æ ‡ç›¸é‡åˆ™é›†åˆæœ‰åº</span></span><br><span class="line">	<span class="keyword">for</span> left &lt; right &#123;</span><br><span class="line">		<span class="comment">// ä»å·¦åˆ°å³ï¼Œé€‰å‡ºæœ€å¤§å€¼</span></span><br><span class="line">		<span class="keyword">for</span> i := left; i &lt; right; i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> arr[i] &gt; arr[i+<span class="number">1</span>] &#123;</span><br><span class="line">				arr[i], arr[i+<span class="number">1</span>] = arr[i+<span class="number">1</span>], arr[i]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		right--</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG right]:\t&quot;</span>, arr)</span><br><span class="line">		<span class="comment">// ä»å³åˆ°å·¦ï¼Œé€‰å‡ºæœ€å°å€¼</span></span><br><span class="line">		<span class="keyword">for</span> i := right; i &gt; left; i-- &#123;</span><br><span class="line">			<span class="keyword">if</span> arr[i<span class="number">-1</span>] &gt; arr[i] &#123;</span><br><span class="line">				arr[i<span class="number">-1</span>], arr[i] = arr[i], arr[i<span class="number">-1</span>]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		left++</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG left]:\t&quot;</span>, arr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = BubbleSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-é€‰æ‹©æ’åº"><a href="#1-2-é€‰æ‹©æ’åº" class="headerlink" title="1.2 é€‰æ‹©æ’åº"></a>1.2 é€‰æ‹©æ’åº</h2><p>é€‰æ‹©æ’åºæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ï¼Œæ— è®ºä»€ä¹ˆæ•°æ®è¿›å»éƒ½æ˜¯ O(nÂ²) çš„æ—¶é—´å¤æ‚åº¦ã€‚æ‰€ä»¥ç”¨åˆ°å®ƒçš„æ—¶å€™ï¼Œæ•°æ®è§„æ¨¡è¶Šå°è¶Šå¥½ã€‚å”¯ä¸€çš„å¥½å¤„å¯èƒ½å°±æ˜¯ä¸å ç”¨é¢å¤–çš„å†…å­˜ç©ºé—´äº†å§ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SelectSort</span> <span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		<span class="comment">// å‡è®¾æ— åºåŒºé—´ç¬¬ä¸€ä¸ªå€¼ä¸ºæœ€å°å€¼</span></span><br><span class="line">		min := i</span><br><span class="line">		<span class="keyword">for</span> next := min + <span class="number">1</span>; next &lt; n; next++ &#123;</span><br><span class="line">			<span class="comment">// æ‰¾åˆ°æ›´å°å€¼ï¼Œè®°å½•å…¶ä½ç½®</span></span><br><span class="line">			<span class="keyword">if</span> arr[min] &gt; arr[next] &#123;</span><br><span class="line">				min = next</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// å°†æ— åºåŒºé—´çš„æœ€å°å€¼è¿½åŠ åˆ°æœ‰åºåŒºé—´</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG min]:\t&quot;</span>, arr[min])</span><br><span class="line">		arr[i], arr[min] = arr[min], arr[i]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = SelectSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="1-3-æ’å…¥æ’åº"><a href="#1-3-æ’å…¥æ’åº" class="headerlink" title="1.3 æ’å…¥æ’åº"></a>1.3 æ’å…¥æ’åº</h2><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ O(n2)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InsertSort</span> <span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;[ALREADY SORTED]:\t&quot;</span>, arr)</span><br><span class="line">		<span class="keyword">return</span> []<span class="type">int</span>&#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// éå†æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="comment">// å‘å‰æ‰¾ä½ç½®</span></span><br><span class="line">		<span class="keyword">for</span> j := i; j &gt; <span class="number">0</span>; j-- &#123;</span><br><span class="line">			<span class="comment">// åˆé€‚ä½ç½®æ’å…¥</span></span><br><span class="line">			<span class="keyword">if</span> arr[j<span class="number">-1</span>] &gt; arr[j] &#123;</span><br><span class="line">				arr[j<span class="number">-1</span>], arr[j] = arr[j], arr[j<span class="number">-1</span>]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG]:\t&quot;</span>, arr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = InsertSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="1-4-å¸Œå°”æ’åº"><a href="#1-4-å¸Œå°”æ’åº" class="headerlink" title="1.4 å¸Œå°”æ’åº"></a>1.4 å¸Œå°”æ’åº</h2><p>å¸Œå°”æ’åºï¼Œä¹Ÿç§°é€’å‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚</p>
<p>å¸Œå°”æ’åºæ˜¯åŸºäºæ’å…¥æ’åºçš„ä»¥ä¸‹ä¸¤ç‚¹æ€§è´¨è€Œæå‡ºæ”¹è¿›æ–¹æ³•çš„ï¼š</p>
<ul>
<li>æ’å…¥æ’åºåœ¨å¯¹å‡ ä¹å·²ç»æ’å¥½åºçš„æ•°æ®æ“ä½œæ—¶ï¼Œæ•ˆç‡é«˜ï¼Œå³å¯ä»¥è¾¾åˆ°çº¿æ€§æ’åºçš„æ•ˆç‡ï¼›</li>
<li>ä½†æ’å…¥æ’åºä¸€èˆ¬æ¥è¯´æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºæ’å…¥æ’åºæ¯æ¬¡åªèƒ½å°†æ•°æ®ç§»åŠ¨ä¸€ä½ï¼›</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(Nlog2N)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ShellSort</span> <span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;[ALREADY SORTED]:\t&quot;</span>, arr)</span><br><span class="line">		<span class="keyword">return</span> []<span class="type">int</span>&#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	step := n / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ­¥é•¿å‡å°‘åˆ° 0 åˆ™æ’åºå®Œæ¯•</span></span><br><span class="line">	<span class="keyword">for</span> step &gt; <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG step]:\t&quot;</span>, step)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// éå†ç¬¬ä¸€ä¸ªæ­¥é•¿åŒºé—´ä¹‹åçš„æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">		<span class="keyword">for</span> i := step; i &lt; n; i++ &#123;</span><br><span class="line">			j := i</span><br><span class="line">			<span class="comment">// å‰ä¸€ä¸ªå…ƒç´ æ›´å¤§åˆ™äº¤æ¢å€¼</span></span><br><span class="line">			<span class="comment">// j &gt;= step	// é¿å…å‘ä¸‹è¶Šç•Œ</span></span><br><span class="line">			<span class="keyword">for</span> j &gt;= step &amp;&amp; arr[j-step] &gt; arr[j] &#123;</span><br><span class="line">				arr[j-step], arr[j] = arr[j], arr[j-step]</span><br><span class="line">				j -= step</span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Println(<span class="string">&quot;[DEBUG]:\t&quot;</span>, arr)</span><br><span class="line">		&#125;</span><br><span class="line">		step /= <span class="number">2</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = ShellSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-5-å¿«é€Ÿæ’åº"><a href="#1-5-å¿«é€Ÿæ’åº" class="headerlink" title="1.5 å¿«é€Ÿæ’åº"></a>1.5 å¿«é€Ÿæ’åº</h2><p>å¿«é€Ÿæ’åºæ˜¯ç”±ä¸œå°¼Â·éœå°”æ‰€å‘å±•çš„ä¸€ç§æ’åºç®—æ³•ã€‚åœ¨å¹³å‡çŠ¶å†µä¸‹ï¼Œæ’åº n ä¸ªé¡¹ç›®è¦ ÎŸ(nlogn) æ¬¡æ¯”è¾ƒã€‚å¿«é€Ÿæ’åºæ˜¯å†’æ³¡æ’åºçš„ä¼˜åŒ–ç‰ˆï¼ŒåŒå±äºäº¤æ¢ç±»æ’åºã€‚å®ƒä½¿ç”¨äº† â€œåˆ†æ²»æ³•â€ çš„æ€æƒ³ï¼Œå°†é›†åˆåˆ†å‰²ä¸ºç›¸ä¼¼å­é›†ï¼Œå†å¯¹å­é›†è¿›è¡Œé€’å½’æ’åºï¼Œæœ€åå°†å­é›†çš„æ’åºç»“æœç»„åˆå³å¯ã€‚</p>
<p>åˆ†æ²»æ³•</p>
<ul>
<li>å…ˆä»æ•°åˆ—ä¸­å–å‡ºä¸€ä¸ªæ•°ä½œä¸ºkeyå€¼ï¼›</li>
<li>å°†æ¯”è¿™ä¸ªæ•°å°çš„æ•°å…¨éƒ¨æ”¾åœ¨å®ƒçš„å·¦è¾¹ï¼Œå¤§äºæˆ–ç­‰äºå®ƒçš„æ•°å…¨éƒ¨æ”¾åœ¨å®ƒçš„å³è¾¹ï¼›</li>
<li>å¯¹å·¦å³ä¸¤ä¸ªå°æ•°åˆ—é‡å¤ç¬¬äºŒæ­¥ï¼Œç›´è‡³å„åŒºé—´åªæœ‰1ä¸ªæ•°ã€‚</li>
</ul>
<p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(N*logN)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">QuickSort</span> <span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="comment">// é€’å½’ç»“æŸæ¡ä»¶</span></span><br><span class="line">	<span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line">		temp := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">		<span class="built_in">copy</span>(temp, arr)</span><br><span class="line">		<span class="keyword">return</span> temp</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½¿ç”¨ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†å€¼</span></span><br><span class="line">	pivot := arr[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å°å…ƒç´  å’Œ å¤§å…ƒç´ å„æˆä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">	low := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, n)</span><br><span class="line">	high := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, n)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ›´å°çš„å…ƒç´ æ”¾ low[]</span></span><br><span class="line">	<span class="comment">// æ›´å¤§çš„å…ƒç´ æ”¾ high[]</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> arr[i] &lt; pivot &#123;</span><br><span class="line">			low = <span class="built_in">append</span>(low, arr[i])</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			high = <span class="built_in">append</span>(high, arr[i])</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// å­åŒºé—´é€’å½’å¿«æ’ï¼Œåˆ†æ²»æ’åº</span></span><br><span class="line">	low, high = QuickSort(low), QuickSort(high)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[DEBUG low]:\t&quot;</span>, low)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[DEBUG high]:\t&quot;</span>, high)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(<span class="built_in">append</span>(low, arr[<span class="number">0</span>]), high...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = QuickSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-6-å½’å¹¶æ’åº"><a href="#1-6-å½’å¹¶æ’åº" class="headerlink" title="1.6 å½’å¹¶æ’åº"></a>1.6 å½’å¹¶æ’åº</h2><p>å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚å½’å¹¶æ’åºä¸å¿«é€Ÿæ’åºç±»ä¼¼ï¼Œä¹Ÿé‡‡ç”¨äº†â€œåˆ†æ²»æ³•â€çš„æ€æƒ³ã€‚</p>
<p>å¿«é€Ÿæ’åºï¼šé€‰å–åŸºå‡†åï¼Œå°†é›†åˆåˆ†å‰²ä¸ºå·¦å³å­é›†åˆå†è¿›è¡Œé€’å½’åˆ†ç»„ï¼Œæœ€ååˆå¹¶æ’åºå¥½çš„å„å­é›†åˆ.</p>
<p>å½’å¹¶æ’åºï¼šå°†é›†åˆå‡åˆ†ä¸ºå·¦å³å­é›†åˆï¼Œå„è‡ªåœ¨å†…éƒ¨è¿›è¡Œé€’å½’æ’åºï¼Œæœ€ååˆå¹¶æ’åºå¥½çš„å„å­é›†åˆ</p>
<p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(NlogN)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(left, right []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	<span class="comment">// éå†æ¯”è¾ƒååˆå¹¶ä¸¤ä¸ªæ•°ç»„</span></span><br><span class="line">	res := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, <span class="built_in">len</span>(left)+<span class="built_in">len</span>(right))</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(left) &gt; <span class="number">0</span> || <span class="built_in">len</span>(right) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// æ•°ç»„æå‰æ’åºå®Œæ¯•</span></span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(left) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">append</span>(res, right...)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(right) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">append</span>(res, left...)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ¯”è¾ƒæ›´å°çš„å€¼è¿½åŠ åˆ° res[] ä¸­</span></span><br><span class="line">		<span class="keyword">if</span> left[<span class="number">0</span>] &lt; right[<span class="number">0</span>] &#123;</span><br><span class="line">			res = <span class="built_in">append</span>(res, left[<span class="number">0</span>])</span><br><span class="line">			left = left[<span class="number">1</span>:]</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			res = <span class="built_in">append</span>(res, right[<span class="number">0</span>])</span><br><span class="line">			right = right[<span class="number">1</span>:]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MergeSort</span> <span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	<span class="comment">// é€’å½’ç»“æŸæ¡ä»¶</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(arr) &lt;= <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> arr</span><br><span class="line">	&#125;</span><br><span class="line">	mid := <span class="built_in">len</span>(arr) / <span class="number">2</span></span><br><span class="line">	left := MergeSort(arr[:mid])</span><br><span class="line">	right := MergeSort(arr[mid:])</span><br><span class="line">	arr = merge(left, right)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[DEBUG merged]:\t&quot;</span>, arr)</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = MergeSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="1-7-å †æ’åº"><a href="#1-7-å †æ’åº" class="headerlink" title="1.7 å †æ’åº"></a>1.7 å †æ’åº</h2><p>å †æ’åºï¼ˆHeapsortï¼‰æ˜¯æŒ‡åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•ã€‚å †ç§¯æ˜¯ä¸€ä¸ªè¿‘ä¼¼å®Œå…¨äºŒå‰æ ‘çš„ç»“æ„ï¼Œå¹¶åŒæ—¶æ»¡è¶³å †ç§¯çš„æ€§è´¨ï¼šå³å­ç»“ç‚¹çš„é”®å€¼æˆ–ç´¢å¼•æ€»æ˜¯å°äºï¼ˆæˆ–è€…å¤§äºï¼‰å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚å †æ’åºå¯ä»¥è¯´æ˜¯ä¸€ç§åˆ©ç”¨å †çš„æ¦‚å¿µæ¥æ’åºçš„é€‰æ‹©æ’åºã€‚åˆ†ä¸ºä¸¤ç§æ–¹æ³•ï¼ˆä¸€èˆ¬å‡åºé‡‡ç”¨å¤§é¡¶å †ï¼Œé™åºé‡‡ç”¨å°é¡¶å †)ï¼š</p>
<p>å¤§é¡¶å †ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ï¼Œåœ¨å †æ’åºç®—æ³•ä¸­ç”¨äºå‡åºæ’åˆ—ï¼›<br>å°é¡¶å †ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ï¼Œåœ¨å †æ’åºç®—æ³•ä¸­ç”¨äºé™åºæ’åˆ—ï¼›</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HeapSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	arrLen := <span class="built_in">len</span>(arr)</span><br><span class="line">	buildMaxHeap(arr, arrLen)</span><br><span class="line">	<span class="keyword">for</span> i := arrLen - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">		swap(arr, <span class="number">0</span>, i)</span><br><span class="line">		arrLen -= <span class="number">1</span></span><br><span class="line">		heapify(arr, <span class="number">0</span>, arrLen)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">buildMaxHeap</span><span class="params">(arr []<span class="type">int</span>, arrLen <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := arrLen / <span class="number">2</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">		heapify(arr, i, arrLen)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">heapify</span><span class="params">(arr []<span class="type">int</span>, i, arrLen <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	left := <span class="number">2</span>*i + <span class="number">1</span></span><br><span class="line">	right := <span class="number">2</span>*i + <span class="number">2</span></span><br><span class="line">	largest := i</span><br><span class="line">	<span class="keyword">if</span> left &lt; arrLen &amp;&amp; arr[left] &gt; arr[largest] &#123;</span><br><span class="line">		largest = left</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> right &lt; arrLen &amp;&amp; arr[right] &gt; arr[largest] &#123;</span><br><span class="line">		largest = right</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> largest != i &#123;</span><br><span class="line">		swap(arr, i, largest)</span><br><span class="line">		heapify(arr, largest, arrLen)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(arr []<span class="type">int</span>, i, j <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = HeapSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="1-8-è®¡æ•°æ’åº"><a href="#1-8-è®¡æ•°æ’åº" class="headerlink" title="1.8 è®¡æ•°æ’åº"></a>1.8 è®¡æ•°æ’åº</h2><p>è®¡æ•°æ’åºçš„æ ¸å¿ƒåœ¨äºå°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ã€‚ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸º ï¼šO(N + max + 1)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getMax</span><span class="params">(arr []<span class="type">int</span>)</span></span> (max <span class="type">int</span>) &#123;</span><br><span class="line">	max = arr[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">		<span class="keyword">if</span> max &lt; v &#123;</span><br><span class="line">			max = v</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CountSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	max := getMax(arr)</span><br><span class="line">	sortedArr := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="built_in">len</span>(arr))</span><br><span class="line">	countsArr := <span class="built_in">make</span>([]<span class="type">int</span>, max+<span class="number">1</span>) <span class="comment">// max+1 æ˜¯ä¸ºäº†é˜²æ­¢ countsArr[] è®¡æ•°æ—¶æº¢å‡º</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// å…ƒç´ è®¡æ•°</span></span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">		countsArr[v]++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç»Ÿè®¡ç‹¬ç‰¹æ•°å­—ä¸ªæ•°å¹¶ç´¯åŠ </span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= max; i++ &#123;</span><br><span class="line">		countsArr[i] += countsArr[i<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;[DEBUG countsArr]:\t&quot;</span>, countsArr)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è®© arr ä¸­æ¯ä¸ªå…ƒç´ æ‰¾åˆ°å…¶ä½ç½®</span></span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">		sortedArr[countsArr[v]<span class="number">-1</span>] = v</span><br><span class="line">		<span class="comment">//fmt.Print(countsArr[v]-1, &quot; &quot;)</span></span><br><span class="line">		<span class="comment">// ä¿è¯ç¨³å®šæ€§</span></span><br><span class="line">		countsArr[v]--</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sortedArr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = CountSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-9-åŸºæ•°æ’åº"><a href="#1-9-åŸºæ•°æ’åº" class="headerlink" title="1.9 åŸºæ•°æ’åº"></a>1.9 åŸºæ•°æ’åº</h2><p>åŸºæ•°æ’åºæ˜¯ä¸€ç§éæ¯”è¾ƒå‹æ•´æ•°æ’åºç®—æ³•ï¼Œå…¶åŸç†æ˜¯å°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚ç”±äºæ•´æ•°ä¹Ÿå¯ä»¥è¡¨è¾¾å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚åå­—æˆ–æ—¥æœŸï¼‰å’Œç‰¹å®šæ ¼å¼çš„æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥åŸºæ•°æ’åºä¹Ÿä¸æ˜¯åªèƒ½ä½¿ç”¨äºæ•´æ•°</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RadixSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	max := getMax(arr)</span><br><span class="line">	<span class="comment">// æ•°ç»„ä¸­æœ€å¤§å€¼å†³å®šäº†å¾ªç¯æ¬¡æ•°ï¼Œ101 å¾ªç¯ä¸‰æ¬¡</span></span><br><span class="line">	<span class="keyword">for</span> bit := <span class="number">1</span>; max/bit &gt; <span class="number">0</span>; bit *= <span class="number">10</span> &#123;</span><br><span class="line">		arr = bitSort(arr, bit)</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG bit]\t&quot;</span>, bit)</span><br><span class="line">		fmt.Println(<span class="string">&quot;[DEBUG arr]\t&quot;</span>, arr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// å¯¹æŒ‡å®šçš„ä½è¿›è¡Œæ’åº</span></span><br><span class="line"><span class="comment">// bit å¯å– 1ï¼Œ10ï¼Œ100 ç­‰å€¼</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bitSort</span><span class="params">(arr []<span class="type">int</span>, bit <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="comment">// å„ä¸ªä½çš„ç›¸åŒçš„æ•°ç»Ÿè®¡åˆ° bitCounts[] ä¸­</span></span><br><span class="line">	bitCounts := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		num := (arr[i] / bit) % <span class="number">10</span></span><br><span class="line">		bitCounts[num]++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		bitCounts[i] += bitCounts[i<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tmp := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="keyword">for</span> i := n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">		num := (arr[i] / bit) % <span class="number">10</span></span><br><span class="line">		tmp[bitCounts[num]<span class="number">-1</span>] = arr[i]</span><br><span class="line">		bitCounts[num]--</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = tmp[i]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ•°ç»„ä¸­æœ€å¤§çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getMax</span><span class="params">(arr []<span class="type">int</span>)</span></span> (max <span class="type">int</span>) &#123;</span><br><span class="line">	max = arr[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">		<span class="keyword">if</span> max &lt; v &#123;</span><br><span class="line">			max = v</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = RadixSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-10-æ¡¶æ’åº"><a href="#1-10-æ¡¶æ’åº" class="headerlink" title="1.10 æ¡¶æ’åº"></a>1.10 æ¡¶æ’åº</h2><p>æ¡¶æ’åºæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆã€‚å®ƒåˆ©ç”¨äº†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé«˜æ•ˆä¸å¦çš„å…³é”®å°±åœ¨äºè¿™ä¸ªæ˜ å°„å‡½æ•°çš„ç¡®å®šã€‚æ¡¶æ’åº (Bucket sort)çš„å·¥ä½œçš„åŸç†ï¼šå‡è®¾è¾“å…¥æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œå°†æ•°æ®åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶å†åˆ†åˆ«æ’åºï¼ˆæœ‰å¯èƒ½å†ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–æ˜¯ä»¥é€’å½’æ–¹å¼ç»§ç»­ä½¿ç”¨æ¡¶æ’åºè¿›è¡Œæ’ï¼‰ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– n ä¸ª [0, max] å…ƒç´ ç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetArr</span><span class="params">(n, max <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		arr[i] = rand.Intn(max + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sortInBucket</span><span class="params">(bucket []<span class="type">int</span>)</span></span> &#123;<span class="comment">//æ­¤å¤„å®ç°æ’å…¥æ’åºæ–¹å¼ï¼Œå…¶å®å¯ä»¥ç”¨ä»»æ„å…¶ä»–æ’åºæ–¹å¼</span></span><br><span class="line">	length := <span class="built_in">len</span>(bucket)</span><br><span class="line">	<span class="keyword">if</span> length == <span class="number">1</span> &#123;<span class="keyword">return</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; length; i++ &#123;</span><br><span class="line">		backup := bucket[i]</span><br><span class="line">		j := i <span class="number">-1</span>;</span><br><span class="line">		<span class="comment">//å°†é€‰å‡ºçš„è¢«æ’æ•°æ¯”è¾ƒåæ’å…¥å·¦è¾¹æœ‰åºåŒº</span></span><br><span class="line">		<span class="keyword">for</span>  j &gt;= <span class="number">0</span> &amp;&amp; backup &lt; bucket[j] &#123;<span class="comment">//æ³¨æ„j &gt;= 0å¿…é¡»åœ¨å‰è¾¹ï¼Œå¦åˆ™ä¼šæ•°ç»„è¶Šç•Œ</span></span><br><span class="line">			bucket[j+<span class="number">1</span>] = bucket[j]<span class="comment">//ç§»åŠ¨æœ‰åºæ•°ç»„</span></span><br><span class="line">			j -- <span class="comment">//åå‘ç§»åŠ¨ä¸‹æ ‡</span></span><br><span class="line">		&#125;</span><br><span class="line">		bucket[j + <span class="number">1</span>] = backup <span class="comment">//æ’é˜Ÿæ’å…¥ç§»åŠ¨åçš„ç©ºä½</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è·å–æ•°ç»„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getMaxInArr</span><span class="params">(arr []<span class="type">int</span>)</span></span> <span class="type">int</span>&#123;</span><br><span class="line">	max := arr[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(arr); i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> arr[i] &gt; max&#123; max = arr[i]&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> max</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ¡¶æ’åº</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BucketSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	<span class="comment">//æ¡¶æ•°</span></span><br><span class="line">	num := <span class="built_in">len</span>(arr)</span><br><span class="line">	<span class="comment">//kï¼ˆæ•°ç»„æœ€å¤§å€¼ï¼‰</span></span><br><span class="line">	max := getMaxInArr(arr)</span><br><span class="line">	<span class="comment">//äºŒç»´åˆ‡ç‰‡</span></span><br><span class="line">	buckets := <span class="built_in">make</span>([][]<span class="type">int</span>, num)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆ†é…å…¥æ¡¶</span></span><br><span class="line">	index := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; num; i++ &#123;</span><br><span class="line">		index = arr[i] * (num<span class="number">-1</span>) /max<span class="comment">//åˆ†é…æ¡¶index = value * (n-1) /k</span></span><br><span class="line"></span><br><span class="line">		buckets[index] = <span class="built_in">append</span>(buckets[index], arr[i])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//æ¡¶å†…æ’åº</span></span><br><span class="line">	tmpPos := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; num; i++ &#123;</span><br><span class="line">		bucketLen := <span class="built_in">len</span>(buckets[i])</span><br><span class="line">		<span class="keyword">if</span> bucketLen &gt; <span class="number">0</span>&#123;</span><br><span class="line">			sortInBucket(buckets[i])</span><br><span class="line"></span><br><span class="line">			<span class="built_in">copy</span>(arr[tmpPos:], buckets[i])</span><br><span class="line"></span><br><span class="line">			tmpPos += bucketLen</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	arr := GetArr(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[UNSORTED]:\t&quot;</span>, arr)</span><br><span class="line">	arr = BucketSort(arr)</span><br><span class="line">	fmt.Println(<span class="string">&quot;[SORTED]:\t&quot;</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="2-æŸ¥æ‰¾"><a href="#2-æŸ¥æ‰¾" class="headerlink" title="2.æŸ¥æ‰¾"></a>2.æŸ¥æ‰¾</h1><h2 id="2-1-é¡ºåºæŸ¥æ‰¾"><a href="#2-1-é¡ºåºæŸ¥æ‰¾" class="headerlink" title="2.1 é¡ºåºæŸ¥æ‰¾"></a>2.1 é¡ºåºæŸ¥æ‰¾</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	items := []<span class="type">int</span>&#123;<span class="number">95</span>, <span class="number">78</span>, <span class="number">46</span>, <span class="number">58</span>, <span class="number">45</span>, <span class="number">86</span>, <span class="number">99</span>, <span class="number">251</span>, <span class="number">320</span>&#125;</span><br><span class="line">	<span class="keyword">if</span> index := linearSearch(items, <span class="number">45</span>); index == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;not exist&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;exist, index is %d\n&quot;</span>, *index)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">linearSearch</span><span class="params">(a []<span class="type">int</span>, key <span class="type">int</span>)</span></span> (index *<span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">for</span> i, item := <span class="keyword">range</span> a &#123;</span><br><span class="line">		<span class="keyword">if</span> item == key &#123;</span><br><span class="line">			index = &amp;i</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-æ’å€¼æŸ¥æ‰¾"><a href="#2-2-æ’å€¼æŸ¥æ‰¾" class="headerlink" title="2.2 æ’å€¼æŸ¥æ‰¾"></a>2.2 æ’å€¼æŸ¥æ‰¾</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sort&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	items := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">6</span>&#125;</span><br><span class="line"></span><br><span class="line">	sort.Ints(items)</span><br><span class="line"></span><br><span class="line">	fmt.Println(interpolationSearch(<span class="number">5</span>, items))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">interpolationSearch</span><span class="params">(key <span class="type">int</span>, a []<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := <span class="built_in">len</span>(a) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		<span class="keyword">var</span> guess <span class="type">int</span></span><br><span class="line">		<span class="keyword">if</span> high == low &#123;</span><br><span class="line">			guess = high</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			size := high - low</span><br><span class="line">			offset := size * (key - a[low]) / (a[high] - a[low])</span><br><span class="line">			guess = low + offset</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> a[guess] &lt; key &#123;</span><br><span class="line">			low = guess + <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> a[guess] &gt; key &#123;</span><br><span class="line">			high = guess - <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-3-äºŒåˆ†æŸ¥æ‰¾"><a href="#2-3-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="2.3 äºŒåˆ†æŸ¥æ‰¾"></a>2.3 äºŒåˆ†æŸ¥æ‰¾</h2><p>äºŒåˆ†æŸ¥æ‰¾å‰ææ˜¯æœ‰åº</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sort&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	items := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// sort</span></span><br><span class="line">	sort.Ints(items) <span class="comment">// &#123;1, 2, 3, 5, 6, 7, 8, 9&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// éé€’å½’</span></span><br><span class="line">	fmt.Println(BinarySearch(<span class="number">8</span>, items))  		<span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line">	<span class="comment">// é€’å½’</span></span><br><span class="line">	fmt.Println(BinarySearchRecursive(<span class="number">8</span>, items)) <span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line">	<span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line">	fmt.Println(BinarySearchFirst(<span class="number">8</span>, items)) <span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line">	<span class="comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line">	fmt.Println(BinarySearchLast(<span class="number">8</span>, items)) <span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line">	<span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line">	fmt.Println(BinarySearchFirstGT(<span class="number">8</span>, items)) <span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line">	<span class="comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line">	fmt.Println(BinarySearchLastLT(<span class="number">8</span>, items)) <span class="comment">// -1: æŸ¥æ‰¾ä¸åˆ°ä½ </span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éé€’å½’</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearch</span><span class="params">(key <span class="type">int</span>, a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := <span class="built_in">len</span>(a) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		mid := low + (high-low)/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> a[mid] &lt; key &#123;</span><br><span class="line">			low = mid + <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> a[mid] &gt; key &#123;</span><br><span class="line">			high = mid - <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> mid</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é€’å½’</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearchRecursive</span><span class="params">(v <span class="type">int</span>,a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(a)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> bs(a, v, <span class="number">0</span>, n<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bs</span><span class="params">(a []<span class="type">int</span>, v <span class="type">int</span>, low, high <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> low &gt; high &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	mid := (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> a[mid] == v &#123;</span><br><span class="line">		<span class="keyword">return</span> mid</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> a[mid] &gt; v &#123;</span><br><span class="line">		<span class="keyword">return</span> bs(a, v, low, mid<span class="number">-1</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> bs(a, v, mid+<span class="number">1</span>, high)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearchFirst</span><span class="params">(v <span class="type">int</span>,a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(a)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := n - <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		mid := (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> a[mid] &gt; v &#123;</span><br><span class="line">			high = mid - <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> a[mid] &lt; v &#123;</span><br><span class="line">			low = mid + <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> mid == <span class="number">0</span> || a[mid<span class="number">-1</span>] != v &#123;</span><br><span class="line">				<span class="keyword">return</span> mid</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				high = mid - <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearchLast</span><span class="params">(v <span class="type">int</span>,a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(a)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := n - <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		mid := (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> a[mid] &gt; v &#123;</span><br><span class="line">			high = mid - <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> a[mid] &lt; v &#123;</span><br><span class="line">			low = mid + <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> mid == n<span class="number">-1</span> || a[mid+<span class="number">1</span>] != v &#123;</span><br><span class="line">				<span class="keyword">return</span> mid</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				low = mid + <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearchFirstGT</span><span class="params">(v <span class="type">int</span>,a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(a)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := n - <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		<span class="comment">//é¿å…æº¢å‡º</span></span><br><span class="line">		mid := low + (high-low)&gt;&gt;<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> a[mid] &gt;= v &#123;</span><br><span class="line">			<span class="keyword">if</span> mid == <span class="number">0</span> || a[mid<span class="number">-1</span>] &lt; v &#123;</span><br><span class="line">				<span class="keyword">return</span> mid</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				high = mid - <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			low = mid + <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinarySearchLastLT</span><span class="params">( v <span class="type">int</span>,a []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(a)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	low := <span class="number">0</span></span><br><span class="line">	high := n - <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> low &lt;= high &#123;</span><br><span class="line">		mid := low + (high-low)&gt;&gt;<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> a[mid] &gt; v &#123;</span><br><span class="line">			high = mid - <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> mid == n<span class="number">-1</span> || a[mid+<span class="number">1</span>] &gt; v &#123;</span><br><span class="line">				<span class="keyword">return</span> mid</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				low = mid + <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="3-é“¾è¡¨"><a href="#3-é“¾è¡¨" class="headerlink" title="3.é“¾è¡¨"></a>3.é“¾è¡¨</h1><h2 id="3-1-å•é“¾è¡¨"><a href="#3-1-å•é“¾è¡¨" class="headerlink" title="3.1 å•é“¾è¡¨"></a>3.1 å•é“¾è¡¨</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Item the type of the linked list</span></span><br><span class="line"><span class="keyword">type</span> Item <span class="keyword">interface</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Node a single node that composes the list</span></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span> &#123;</span><br><span class="line">	data Item</span><br><span class="line">	next *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ItemLinkedList the linked list of Items</span></span><br><span class="line"><span class="keyword">type</span> ItemLinkedList <span class="keyword">struct</span> &#123;</span><br><span class="line">	head *Node</span><br><span class="line">	size <span class="type">int</span></span><br><span class="line">	lock sync.RWMutex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Append adds an Item to the end of the linked list</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> Append(t Item) &#123;</span><br><span class="line">	ll.lock.Lock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.Unlock()</span><br><span class="line">	node := Node&#123;t, <span class="literal">nil</span>&#125;</span><br><span class="line">	<span class="keyword">if</span> ll.head == <span class="literal">nil</span> &#123;</span><br><span class="line">		ll.head = &amp;node</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		last := ll.head</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> last.next == <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">			last = last.next</span><br><span class="line">		&#125;</span><br><span class="line">		last.next = &amp;node</span><br><span class="line">	&#125;</span><br><span class="line">	ll.size++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Insert adds an Item at position i</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> Insert(i <span class="type">int</span>, t Item) <span class="type">error</span> &#123;</span><br><span class="line">	ll.lock.Lock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.Unlock()</span><br><span class="line">	<span class="keyword">if</span> i &lt; <span class="number">0</span> || i &gt; ll.size &#123;</span><br><span class="line">		<span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;Index out of bounds&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	addNode := Node&#123;t, <span class="literal">nil</span>&#125;</span><br><span class="line">	<span class="keyword">if</span> i == <span class="number">0</span> &#123;</span><br><span class="line">		addNode.next = ll.head</span><br><span class="line">		ll.head = &amp;addNode</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	node := ll.head</span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; i<span class="number">-2</span>; j++ &#123;</span><br><span class="line">		node = node.next</span><br><span class="line">	&#125;</span><br><span class="line">	addNode.next = node.next</span><br><span class="line">	node.next = &amp;addNode</span><br><span class="line">	ll.size++</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RemoveAt removes a node at position i</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> RemoveAt(i <span class="type">int</span>) (*Item, <span class="type">error</span>) &#123;</span><br><span class="line">	ll.lock.Lock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.Unlock()</span><br><span class="line">	<span class="keyword">if</span> i &lt; <span class="number">0</span> || i &gt; ll.size &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;Index out of bounds&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	node := ll.head</span><br><span class="line">	j := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j &lt; i<span class="number">-1</span> &#123;</span><br><span class="line">		j++</span><br><span class="line">		node = node.next</span><br><span class="line">	&#125;</span><br><span class="line">	remove := node.next</span><br><span class="line">	node.next = remove.next</span><br><span class="line">	ll.size--</span><br><span class="line">	<span class="keyword">return</span> &amp;remove.data, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IndexOf returns the position of the Item t</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> IndexOf(t Item) <span class="type">int</span> &#123;</span><br><span class="line">	ll.lock.RLock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.RUnlock()</span><br><span class="line">	node := ll.head</span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> node.data == t &#123;</span><br><span class="line">			<span class="keyword">return</span> i</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> node.next == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">		&#125;</span><br><span class="line">		node = node.next</span><br><span class="line">		i++</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IsEmpty returns true if the list is empty</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> IsEmpty() <span class="type">bool</span> &#123;</span><br><span class="line">	ll.lock.RLock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.RUnlock()</span><br><span class="line">	<span class="keyword">if</span> ll.head == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Size returns the linked list size</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> Size() <span class="type">int</span> &#123;</span><br><span class="line">	ll.lock.RLock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.RUnlock()</span><br><span class="line">	last := ll.head</span><br><span class="line">	<span class="keyword">if</span> last == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	size := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> last.next == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		last = last.next</span><br><span class="line">		size++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> size</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Insert adds an Item at position i</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> String() &#123;</span><br><span class="line">	ll.lock.RLock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.RUnlock()</span><br><span class="line">	node := ll.head</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; node != <span class="literal">nil</span>; i++ &#123;</span><br><span class="line">		fmt.Print(node.data)</span><br><span class="line">		fmt.Print(<span class="string">&quot; &quot;</span>)</span><br><span class="line">		node = node.next</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Head returns a pointer to the first node of the list</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ll *ItemLinkedList)</span></span> Head() *Node &#123;</span><br><span class="line">	ll.lock.RLock()</span><br><span class="line">	<span class="keyword">defer</span> ll.lock.RUnlock()</span><br><span class="line">	<span class="keyword">return</span> ll.head</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	list := ItemLinkedList&#123;&#125;</span><br><span class="line">	list.Append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;b&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">	list.Append(<span class="string">&quot;d&quot;</span>)</span><br><span class="line">	list.String() <span class="comment">// 1 2 3 4 a b c d</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(fmt.Sprintf(<span class="string">&quot;list length: %v&quot;</span>,list.Size()))</span><br><span class="line"></span><br><span class="line">	_ = list.Insert(<span class="number">1</span>,<span class="string">&quot;x&quot;</span>)</span><br><span class="line">	list.String() <span class="comment">// 1 x 2 3 4 a b c d</span></span><br><span class="line"></span><br><span class="line">	index := list.IndexOf(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">	fmt.Println(fmt.Sprintf(<span class="string">&quot;index: %d&quot;</span>,index))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-åŒé“¾è¡¨"><a href="#3-2-åŒé“¾è¡¨" class="headerlink" title="3.2 åŒé“¾è¡¨"></a>3.2 åŒé“¾è¡¨</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span>  LinkList <span class="keyword">interface</span> &#123;</span><br><span class="line">	Clear() <span class="comment">//æ¸…ç©º</span></span><br><span class="line">	Len()<span class="comment">//æ±‚é•¿åº¦</span></span><br><span class="line">	Front()*Element <span class="comment">//ç¬¬ä¸€ä¸ª</span></span><br><span class="line">	Back()*Element <span class="comment">//æœ€åä¸€ä¸ª</span></span><br><span class="line">	Remove(e *Element) * Element</span><br><span class="line">	Setdata(old,<span class="built_in">new</span> <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	Insert(e,mark *Element)*Element</span><br><span class="line">	InsertValue(v <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element</span><br><span class="line">	PushFront(data  <span class="keyword">interface</span>&#123;&#125;)*Element</span><br><span class="line">	PushBack(data  <span class="keyword">interface</span>&#123;&#125;)*Element</span><br><span class="line">	InsertBefore(data  <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element</span><br><span class="line">	InsertAfter(data  <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element</span><br><span class="line">	MoveBrfore(e,mark *Element)</span><br><span class="line">	MoveAfter(e,mark *Element)</span><br><span class="line">	Show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Element <span class="keyword">struct</span>&#123;</span><br><span class="line">	prev,next *Element <span class="comment">//å‰ä¸€ä¸ªæŒ‡é’ˆï¼Œåä¸€ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">	value  <span class="keyword">interface</span>&#123;&#125;  <span class="comment">//æ•°æ®</span></span><br><span class="line">	list * List</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> List <span class="keyword">struct</span>&#123;</span><br><span class="line">	root Element  <span class="comment">//æ ¹å…ƒç´ ï¼Œé•¿åº¦</span></span><br><span class="line">	<span class="built_in">len</span> <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="title">New</span><span class="params">()</span></span> *List&#123;</span><br><span class="line">	list:=<span class="built_in">new</span>(List)</span><br><span class="line">	list.Clear() <span class="comment">//æ¸…ç©º</span></span><br><span class="line">	<span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Clear()&#123;</span><br><span class="line">	<span class="keyword">if</span> firstelem:=list.root.next;firstelem!=<span class="literal">nil</span> &amp;&amp; firstelem.list==list&#123;</span><br><span class="line">		firstelem.prev=<span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> lastelem:=list.root.prev;lastelem!=<span class="literal">nil</span> &amp;&amp; lastelem.list==list&#123;</span><br><span class="line">		lastelem.prev=<span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	list.root.next=&amp;list.root</span><br><span class="line">	list.root.prev=&amp;list.root</span><br><span class="line">	list.<span class="built_in">len</span>=<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Len()<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> list.<span class="built_in">len</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>Front() *Element&#123;</span><br><span class="line">	<span class="keyword">if</span>  list.<span class="built_in">len</span>==<span class="number">0</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list.root.next<span class="comment">//ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Back()*Element&#123;</span><br><span class="line">	<span class="keyword">if</span>  list.<span class="built_in">len</span>==<span class="number">0</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list.root.prev<span class="comment">//æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Insert(e,mark *Element)*Element&#123;</span><br><span class="line">	nbak :=mark.next  <span class="comment">//å¤‡ä»½</span></span><br><span class="line">	mark.next =e</span><br><span class="line">	e.prev=mark</span><br><span class="line">	e.next=nbak</span><br><span class="line">	nbak.prev=e</span><br><span class="line">	e.list=list <span class="comment">//ä¿å­˜é“¾è¡¨çš„éƒ½æŒ‡é’ˆ</span></span><br><span class="line">	list.<span class="built_in">len</span>++ <span class="comment">//é•¿åº¦+1</span></span><br><span class="line">	<span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> InsertValue(v <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element&#123;</span><br><span class="line">	<span class="keyword">return</span> list.Insert(&amp;Element&#123;value:v&#125;,mark) <span class="comment">//æ’å…¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> PushFront(data  <span class="keyword">interface</span>&#123;&#125;)*Element&#123;</span><br><span class="line">	<span class="keyword">return</span> list.InsertValue(data,&amp;list.root) <span class="comment">//å‰é¢æ’å…¥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> PushBack(data  <span class="keyword">interface</span>&#123;&#125;)*Element&#123;</span><br><span class="line">	<span class="keyword">return</span> list.InsertValue(data,list.root.prev) <span class="comment">//åé¢æ’å…¥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>Remove(e* Element)* Element&#123;</span><br><span class="line">	e.prev.next=e.next</span><br><span class="line">	e.next.prev=e.prev</span><br><span class="line">	e.next=<span class="literal">nil</span></span><br><span class="line">	e.prev=<span class="literal">nil</span></span><br><span class="line">	e.list=<span class="literal">nil</span></span><br><span class="line">	list.<span class="built_in">len</span>--</span><br><span class="line">	<span class="keyword">return</span> e</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ é™¤æŒ‡å®šæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>Removedata(data <span class="keyword">interface</span>&#123;&#125;) <span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">	<span class="keyword">for</span> phead:=list.root.next;phead!=&amp;list.root;phead=phead.next&#123;</span><br><span class="line">		<span class="keyword">if</span> phead.value==data&#123;</span><br><span class="line">			list.Remove(phead)  <span class="comment">//æŸ¥æ‰¾å¹¶åˆ é™¤</span></span><br><span class="line">			<span class="keyword">return</span> phead.value</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Show()&#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;é“¾è¡¨å¼€å§‹&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> phead:=list.root.next;phead!=&amp;list.root;phead=phead.next&#123;</span><br><span class="line">		fmt.Println(phead.value)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;é“¾è¡¨ç»“æŸ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>InsertBefore(data  <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element&#123;</span><br><span class="line">	<span class="keyword">if</span> mark.list!=list&#123;  <span class="comment">//æ²¡æœ‰å‰ç½®</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list.InsertValue(data,mark.prev)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>InsertAfter(data  <span class="keyword">interface</span>&#123;&#125;,mark *Element)*Element&#123;</span><br><span class="line">	<span class="keyword">if</span> mark.list!=list&#123;  <span class="comment">//æ²¡æœ‰å‰ç½®</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list.InsertValue(data,mark)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>MoveBrfore(e,mark *Element)&#123;</span><br><span class="line">	<span class="keyword">if</span> e.list!=list || list.root.next==e&#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	list.Insert(list.Remove(e),mark.prev)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span>ReMoveAfter(e,mark *Element)&#123;</span><br><span class="line">	<span class="keyword">if</span> e.list!=list || list.root.prev==e&#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	list.Insert(list.Remove(e),&amp;list.root)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *List)</span></span> Setdata(old,<span class="built_in">new</span> <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line">	<span class="keyword">for</span> phead:=list.root.next;phead!=&amp;list.root;phead=phead.next&#123;</span><br><span class="line">		<span class="keyword">if</span> phead.value==old&#123;</span><br><span class="line">			phead.value=<span class="built_in">new</span>  <span class="comment">//æ›´æ–°</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//fmt.Println(phead.value)</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	mylist:=New()</span><br><span class="line">	mylist.PushFront(<span class="number">1</span>)</span><br><span class="line">	mylist.PushFront(<span class="number">2</span>)</span><br><span class="line">	mylist.PushFront(<span class="number">3</span>)</span><br><span class="line">	mylist.PushFront(<span class="number">4</span>)</span><br><span class="line">	mylist.PushBack(<span class="number">5</span>)</span><br><span class="line">	mylist.Show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="4-é˜Ÿåˆ—"><a href="#4-é˜Ÿåˆ—" class="headerlink" title="4.é˜Ÿåˆ—"></a>4.é˜Ÿåˆ—</h1><h2 id="4-1-é“¾å¼é˜Ÿåˆ—"><a href="#4-1-é“¾å¼é˜Ÿåˆ—" class="headerlink" title="4.1 é“¾å¼é˜Ÿåˆ—"></a>4.1 é“¾å¼é˜Ÿåˆ—</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é“¾è¡¨å•èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">type</span>  QNode <span class="keyword">struct</span>&#123;</span><br><span class="line">	data  <span class="keyword">interface</span>&#123;&#125; <span class="comment">//æ•°æ®</span></span><br><span class="line">	next * QNode <span class="comment">//åœ°å€</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> QueueLink <span class="keyword">struct</span>&#123;  <span class="comment">//é˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå°¾éƒ¨</span></span><br><span class="line">	rear *QNode</span><br><span class="line">	front *QNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span>  SQueue <span class="keyword">interface</span> &#123;</span><br><span class="line">	length() <span class="type">int</span></span><br><span class="line">	Enqueue(value  <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	Dequeue()(  <span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewLinkQueue</span><span class="params">()</span></span> * QueueLink&#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;QueueLink&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(qlk *QueueLink)</span></span>length() <span class="type">int</span>&#123;</span><br><span class="line">	length := <span class="number">0</span></span><br><span class="line">	pnode := qlk.front <span class="comment">//å¤‡ä»½</span></span><br><span class="line">	<span class="keyword">for</span> pnode != qlk.rear&#123; <span class="comment">//ä¸€ç›´åˆ°å¾ªç¯åˆ°é‡åˆä¸ºzhi</span></span><br><span class="line">		pnode = pnode.next  <span class="comment">//å¾ªç¯é“¾è¡¨å°¾éƒ¨</span></span><br><span class="line">		length++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> length</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">( qlk *QueueLink)</span></span> Enqueue(value  <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line">	newnode :=&amp;QNode&#123;data:value&#125; <span class="comment">//æ„é€ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿”å›åœ°å€</span></span><br><span class="line">	<span class="keyword">if</span> qlk.front == <span class="literal">nil</span>&#123;  <span class="comment">//åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">		qlk.front = newnode</span><br><span class="line">		qlk.rear = newnode</span><br><span class="line"></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		qlk.rear.next = newnode</span><br><span class="line">		qlk.rear = qlk.rear.next</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(qlk *QueueLink )</span></span> Dequeue()( value <span class="keyword">interface</span>&#123;&#125;,err <span class="type">error</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> qlk.front == <span class="literal">nil</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>,<span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	newnode := qlk.front</span><br><span class="line">	<span class="keyword">if</span> qlk.front == qlk.rear&#123;</span><br><span class="line">		qlk.front = <span class="literal">nil</span></span><br><span class="line">		qlk.rear = <span class="literal">nil</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		qlk.front = qlk.front.next <span class="comment">//åˆ é™¤ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> newnode.data,<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	myq := NewLinkQueue()</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</span><br><span class="line">		myq.Enqueue(i)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;length&quot;</span>,myq.length())</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</span><br><span class="line">		fmt.Println(myq.Dequeue())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-2-æ•°ç»„é˜Ÿåˆ—"><a href="#4-2-æ•°ç»„é˜Ÿåˆ—" class="headerlink" title="4.2 æ•°ç»„é˜Ÿåˆ—"></a>4.2 æ•°ç»„é˜Ÿåˆ—</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> QueueInter <span class="keyword">interface</span> &#123;</span><br><span class="line">	Size()<span class="type">int</span>   		<span class="comment">//å¤§å°</span></span><br><span class="line">	Front()<span class="keyword">interface</span>&#123;&#125; 	<span class="comment">//ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">	End()<span class="keyword">interface</span>&#123;&#125; 	<span class="comment">//æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">	IsEmpty() <span class="type">bool</span> 		<span class="comment">//æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">	Enqueue(data <span class="keyword">interface</span>&#123;&#125;) 	<span class="comment">//å…¥é˜Ÿ</span></span><br><span class="line">	Dequeue() <span class="keyword">interface</span>&#123;&#125; 		<span class="comment">//å‡ºå¯¹</span></span><br><span class="line">	Clear()				<span class="comment">//æ¸…ç©º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span>  Queue <span class="keyword">struct</span>&#123;</span><br><span class="line">	datastore []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	theSize <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> Clear()&#123;</span><br><span class="line">	myqueue.datastore = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>)  <span class="comment">//å¼€è¾Ÿå†…å­˜</span></span><br><span class="line">	myqueue.theSize = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewQueue</span><span class="params">()</span></span> *Queue&#123;</span><br><span class="line">	myqueue := <span class="built_in">new</span>(Queue)</span><br><span class="line">	myqueue.Clear()</span><br><span class="line">	<span class="keyword">return</span> myqueue</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> Size()<span class="type">int</span>   &#123;</span><br><span class="line">	<span class="keyword">return</span>  myqueue.theSize <span class="comment">//å¤§å°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> Front()<span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	<span class="keyword">if</span> myqueue.Size() == <span class="number">0</span>&#123; <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> myqueue.datastore[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> End()<span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	<span class="keyword">if</span> myqueue.Size() == <span class="number">0</span>&#123; <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> myqueue.datastore[myqueue.theSize<span class="number">-1</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> IsEmpty() <span class="type">bool</span>&#123;</span><br><span class="line">	<span class="keyword">return</span>  myqueue.theSize == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> Enqueue(data <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	myqueue.datastore = <span class="built_in">append</span>( myqueue.datastore,data) <span class="comment">//å…¥é˜Ÿ</span></span><br><span class="line">	myqueue.theSize++</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(myqueue *Queue)</span></span> Dequeue() <span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	<span class="keyword">if</span> myqueue.Size() == <span class="number">0</span>&#123; <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	data := myqueue.datastore[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span>  myqueue.Size()&gt;<span class="number">1</span> &#123;</span><br><span class="line">		myqueue.datastore = myqueue.datastore[<span class="number">1</span>:myqueue.theSize] <span class="comment">//æˆªå–</span></span><br><span class="line">	&#125;</span><br><span class="line">	myqueue.theSize--</span><br><span class="line">	<span class="keyword">return</span>  data</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	myq := NewQueue()</span><br><span class="line">	myq.Enqueue(<span class="number">1</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">2</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">3</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">4</span>)</span><br><span class="line">	fmt.Println(myq.Size())</span><br><span class="line">	fmt.Println(myq.Dequeue())</span><br><span class="line">	fmt.Println(myq.Dequeue())</span><br><span class="line">	fmt.Println(myq.Dequeue())</span><br><span class="line">	fmt.Println(myq.Dequeue())</span><br><span class="line">	fmt.Println(myq.Size())</span><br><span class="line">	myq.Enqueue(<span class="number">1</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">2</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">3</span>)</span><br><span class="line">	myq.Enqueue(<span class="number">4</span>)</span><br><span class="line">	myq.Clear()</span><br><span class="line">	fmt.Println(myq.Size())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-3-ä¼˜å…ˆé˜Ÿåˆ—"><a href="#4-3-ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="4.3 ä¼˜å…ˆé˜Ÿåˆ—"></a>4.3 ä¼˜å…ˆé˜Ÿåˆ—</h2><p>åŸºäºäºŒå‰å †</p>
<h1 id="5-æ ˆ"><a href="#5-æ ˆ" class="headerlink" title="5.æ ˆ"></a>5.æ ˆ</h1><h2 id="5-1-æ•°ç»„æ ˆ"><a href="#5-1-æ•°ç»„æ ˆ" class="headerlink" title="5.1 æ•°ç»„æ ˆ"></a>5.1 æ•°ç»„æ ˆ</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StackArray <span class="keyword">interface</span>&#123;</span><br><span class="line">	Clear()</span><br><span class="line">	Size()<span class="type">int</span></span><br><span class="line">	Pop() <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	Push(data <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	isEmpty() <span class="type">bool</span></span><br><span class="line">	isFull() <span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ArrayList <span class="keyword">struct</span>&#123;</span><br><span class="line">	dataStore [] <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	theSize <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">()</span></span> *ArrayList&#123;</span><br><span class="line">	list := <span class="built_in">new</span>(ArrayList)</span><br><span class="line">	list.dataStore = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>,<span class="number">10</span>) <span class="comment">//åˆ†é…å†…å­˜10ä¸ªæ•°ç»„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">	list.theSize = <span class="number">0</span>  <span class="comment">//0</span></span><br><span class="line">	<span class="comment">//fmt.Println(&quot;new&quot;,list.theSize,cap(list.dataStore))</span></span><br><span class="line">	<span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(list *ArrayList)</span></span> Append (newval  <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line">	<span class="comment">//list.checkmemisfull()</span></span><br><span class="line">	list.dataStore=<span class="built_in">append</span>(list.dataStore,newval) <span class="comment">//æ•°æ®å åŠ </span></span><br><span class="line">	<span class="comment">//fmt.Println(list.theSize,cap(list.dataStore))</span></span><br><span class="line">	<span class="comment">//list.dataStore[list.theSize]=newval  //èµ‹å€¼</span></span><br><span class="line">	list.theSize++ <span class="comment">//ç´¢å¼•ç§»åŠ¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span>Remove(index <span class="type">int</span>)<span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> index &lt; <span class="number">0</span> || index &gt;= list.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;ç´¢å¼•è¶Šç•Œ&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	list.dataStore = <span class="built_in">append</span>(list.dataStore[:index],list.dataStore[index+<span class="number">1</span>:]...) <span class="comment">//åˆ é™¤</span></span><br><span class="line">	list.theSize--</span><br><span class="line">	<span class="keyword">return</span>  <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span>Clear() &#123;</span><br><span class="line">	list.dataStore = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>,<span class="number">10</span>) <span class="comment">//æ¸…ç©º</span></span><br><span class="line">	list.theSize = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span>  Stack <span class="keyword">struct</span>&#123;</span><br><span class="line">	myarray *ArrayList</span><br><span class="line">	capsize <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStack</span><span class="params">()</span></span>*Stack&#123;</span><br><span class="line">	mystack := <span class="built_in">new</span>(Stack)</span><br><span class="line">	mystack.myarray = New()</span><br><span class="line">	mystack.capsize = <span class="number">10</span>  <span class="comment">//0</span></span><br><span class="line">	<span class="keyword">return</span> mystack</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> Clear()&#123;</span><br><span class="line">	mystack.myarray.Clear()</span><br><span class="line">	mystack.myarray.theSize = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> Size()<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> mystack.myarray.theSize</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> isEmpty() <span class="type">bool</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> mystack.myarray.theSize == <span class="number">0</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> isFull() <span class="type">bool</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> mystack.capsize == mystack.myarray.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> Pop() <span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">	<span class="keyword">if</span> !mystack.isEmpty()&#123;</span><br><span class="line">		last := mystack.myarray.dataStore[mystack.myarray.theSize<span class="number">-1</span>]</span><br><span class="line">		mystack.myarray.Remove(mystack.myarray.theSize<span class="number">-1</span>)</span><br><span class="line">		<span class="keyword">return</span> last</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mystack *Stack)</span></span> Push(data <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line">	<span class="keyword">if</span> !mystack.isFull()&#123;</span><br><span class="line">		mystack.myarray.Append(data)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	mystack :=NewStack()</span><br><span class="line">	mystack.Push(<span class="number">1</span>)</span><br><span class="line">	mystack.Push(<span class="number">2</span>)</span><br><span class="line">	mystack.Push(<span class="number">3</span>)</span><br><span class="line">	mystack.Push(<span class="number">4</span>)</span><br><span class="line">	fmt.Println(mystack.Pop())</span><br><span class="line">	fmt.Println(mystack.Pop())</span><br><span class="line">	fmt.Println(mystack.Pop())</span><br><span class="line">	fmt.Println(mystack.Pop())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-2-é“¾å¼æ ˆ"><a href="#5-2-é“¾å¼æ ˆ" class="headerlink" title="5.2 é“¾å¼æ ˆ"></a>5.2 é“¾å¼æ ˆ</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span>&#123;</span><br><span class="line">	data <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	next *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LinkStack <span class="keyword">interface</span> &#123;</span><br><span class="line">	IsEmpty() <span class="type">bool</span></span><br><span class="line">	Push(value <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	Pop()(<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>)</span><br><span class="line">	Length() <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStack</span><span class="params">()</span></span> *Node &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Node&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *Node)</span></span>IsEmpty() <span class="type">bool</span> &#123;  <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">	<span class="keyword">return</span> n.next == <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *Node)</span></span>Push(value <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	newnode := &amp;Node&#123;data:value&#125; <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">	newnode.next = n.next</span><br><span class="line">	n.next = newnode</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *Node)</span></span>Pop() (<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> n.IsEmpty() == <span class="literal">true</span>&#123;</span><br><span class="line">		<span class="keyword">return</span>  <span class="literal">nil</span>,errors.New(<span class="string">&quot;bug&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	value := n.next.data</span><br><span class="line">	n.next = n.next.next</span><br><span class="line">	<span class="keyword">return</span> value,<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *Node)</span></span>Length() <span class="type">int</span> &#123;</span><br><span class="line">	pnext := n</span><br><span class="line">	length := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> pnext.next != <span class="literal">nil</span>&#123;<span class="comment">//è¿”å›é•¿åº¦</span></span><br><span class="line">		pnext = pnext.next</span><br><span class="line">		length++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> length</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	mystack := NewStack()</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>;i &lt; <span class="number">10</span>;i++&#123;</span><br><span class="line">		mystack.Push(i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> data,err := mystack.Pop();err == <span class="literal">nil</span>;data,err = mystack.Pop()&#123;</span><br><span class="line">		fmt.Println(data)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-å †"><a href="#6-å †" class="headerlink" title="6.å †"></a>6.å †</h1><h2 id="6-1-äºŒå‰å †"><a href="#6-1-äºŒå‰å †" class="headerlink" title="6.1 äºŒå‰å †"></a>6.1 äºŒå‰å †</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> IBinaryHeap <span class="keyword">interface</span> &#123;</span><br><span class="line">	Add(data <span class="type">int</span>)</span><br><span class="line">	AddSlice(data []<span class="type">int</span>)</span><br><span class="line">	Length() <span class="type">int</span></span><br><span class="line">	BuildMax(dataLen <span class="type">int</span>)</span><br><span class="line">	BuildMin(dataLen <span class="type">int</span>)</span><br><span class="line">	SortAsc()</span><br><span class="line">	SortDesc()</span><br><span class="line">	Show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> BinaryHeap <span class="keyword">struct</span> &#123;</span><br><span class="line">	data []<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> Add(data <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> b.Length() == <span class="number">0</span> &#123;</span><br><span class="line">		b.data = <span class="built_in">append</span>(b.data, <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	b.data = <span class="built_in">append</span>(b.data, data)</span><br><span class="line">	b.data[<span class="number">0</span>]++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> AddSlice(data []<span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">for</span> _, item := <span class="keyword">range</span> data &#123;</span><br><span class="line">		b.Add(item)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> Length() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(b.data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuildMax : æ„å»ºå¤§æ ¹å †</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> BuildMax(dataLen <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="comment">// å¾ªç¯æ‰€æœ‰çš„çˆ¶èŠ‚ç‚¹(ä»åå‘å‰å¾ªç¯)</span></span><br><span class="line">	<span class="keyword">for</span> i := (dataLen - <span class="number">1</span>) / <span class="number">2</span>; i &gt;= <span class="number">1</span>; i-- &#123;</span><br><span class="line">		<span class="comment">// æ‰¾å‡ºæœ€å¤§çš„å„¿å­èŠ‚ç‚¹</span></span><br><span class="line">		<span class="keyword">var</span> maxIndex = i * <span class="number">2</span> <span class="comment">// å‡è®¾æœ€å¤§çš„å°±æ˜¯å·¦å„¿å­(å› ä¸ºæ˜¯çˆ¶èŠ‚ç‚¹,å¿…å®šå­˜åœ¨å·¦å„¿å­)</span></span><br><span class="line">		<span class="comment">// å¦‚æœæœ‰å³å„¿å­, å¹¶ä¸”å³å„¿å­æ›´å¤§,åˆ™è®°å½•</span></span><br><span class="line">		<span class="keyword">if</span> (maxIndex+<span class="number">1</span>) &lt; dataLen &amp;&amp; b.data[maxIndex+<span class="number">1</span>] &gt; b.data[maxIndex] &#123;</span><br><span class="line">			maxIndex = i*<span class="number">2</span> + <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒ, å¦‚æœæ›´å¤§å°±äº¤æ¢</span></span><br><span class="line">		<span class="keyword">for</span> b.data[maxIndex] &gt; b.data[i] &#123;</span><br><span class="line">			b.data[maxIndex], b.data[i] = b.data[i], b.data[maxIndex]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuildMin : æ„å»ºå°æ ¹å †</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> BuildMin(dataLen <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="comment">// å¾ªç¯æ‰€æœ‰çš„çˆ¶èŠ‚ç‚¹(ä»åå‘å‰å¾ªç¯)</span></span><br><span class="line">	<span class="keyword">for</span> i := (dataLen - <span class="number">1</span>) / <span class="number">2</span>; i &gt;= <span class="number">1</span>; i-- &#123;</span><br><span class="line">		<span class="comment">// æ‰¾å‡ºæœ€å¤§çš„å„¿å­èŠ‚ç‚¹</span></span><br><span class="line">		<span class="keyword">var</span> minIndex = i * <span class="number">2</span> <span class="comment">// å‡è®¾æœ€å¤§çš„å°±æ˜¯å·¦å„¿å­(å› ä¸ºæ˜¯çˆ¶èŠ‚ç‚¹,å¿…å®šå­˜åœ¨å·¦å„¿å­)</span></span><br><span class="line">		<span class="comment">// å¦‚æœæœ‰å³å„¿å­, å¹¶ä¸”å³å„¿å­æ›´å¤§,åˆ™è®°å½•</span></span><br><span class="line">		<span class="keyword">if</span> (minIndex+<span class="number">1</span>) &lt; dataLen &amp;&amp; b.data[minIndex+<span class="number">1</span>] &lt; b.data[minIndex] &#123;</span><br><span class="line">			minIndex++</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒ, å¦‚æœæ›´å°å°±äº¤æ¢</span></span><br><span class="line">		<span class="keyword">for</span> b.data[minIndex] &lt; b.data[i] &#123;</span><br><span class="line">			b.data[minIndex], b.data[i] = b.data[i], b.data[minIndex]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SortRise : å¯¹å †åšå‡åºæ’åˆ—</span></span><br><span class="line"><span class="comment">// 1. ç»„åˆå¤§é¡¶å †</span></span><br><span class="line"><span class="comment">// 2. æ ¹èŠ‚ç‚¹ä¸æœ€åä¸€ä¸ªå¶å­èŠ‚ç‚¹äº’æ¢</span></span><br><span class="line"><span class="comment">// 3. åœ¨é™¤æœ€åä¸€ä¸ªå¶å­èŠ‚ç‚¹çš„å †ä¸­ç»§ç»­æ‰§è¡Œ1å’Œ2æ­¥éª¤, åˆ°å †ä¸­å‰©ä½™1ä¸ªèŠ‚ç‚¹ä¸ºæ­¢</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> SortAsc() &#123;</span><br><span class="line">	<span class="keyword">var</span> dataLen = <span class="built_in">len</span>(b.data)</span><br><span class="line">	<span class="keyword">for</span> dataLen &gt; <span class="number">2</span> &#123;</span><br><span class="line">		b.BuildMax(dataLen)</span><br><span class="line"></span><br><span class="line">		b.data[<span class="number">1</span>], b.data[dataLen<span class="number">-1</span>] = b.data[dataLen<span class="number">-1</span>], b.data[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">		dataLen--</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SortRise : å¯¹å †åšé™åºæ’åˆ—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> SortDesc() &#123;</span><br><span class="line">	<span class="keyword">var</span> dataLen = <span class="built_in">len</span>(b.data)</span><br><span class="line">	<span class="keyword">for</span> dataLen &gt; <span class="number">2</span> &#123;</span><br><span class="line">		b.BuildMin(dataLen)</span><br><span class="line"></span><br><span class="line">		b.data[<span class="number">1</span>], b.data[dataLen<span class="number">-1</span>] = b.data[dataLen<span class="number">-1</span>], b.data[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">		dataLen--</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *BinaryHeap)</span></span> Show() &#123;</span><br><span class="line">	<span class="keyword">for</span> k, item := <span class="keyword">range</span> b.data &#123;</span><br><span class="line">		<span class="keyword">if</span> k &gt; <span class="number">0</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%v,&quot;</span>, item)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> data = &amp;BinaryHeap&#123;data: []<span class="type">int</span>&#123;<span class="number">6</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">22</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">12</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	data.Show()</span><br><span class="line">	data.Add(<span class="number">88</span>)</span><br><span class="line">	data.AddSlice([]<span class="type">int</span>&#123;<span class="number">3</span>, <span class="number">28</span>&#125;)</span><br><span class="line">	data.Show()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n----------max&quot;</span>)</span><br><span class="line">	data.BuildMax(data.Length())</span><br><span class="line">	data.Show()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n----------min&quot;</span>)</span><br><span class="line">	data.BuildMin(data.Length())</span><br><span class="line">	data.Show()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n----------asc&quot;</span>)</span><br><span class="line">	data.SortAsc()</span><br><span class="line">	data.Show()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n----------desc&quot;</span>)</span><br><span class="line">	data.SortDesc()</span><br><span class="line">	data.Show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="7-é›†åˆ"><a href="#7-é›†åˆ" class="headerlink" title="7.é›†åˆ"></a>7.é›†åˆ</h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bytes&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> HashSet <span class="keyword">struct</span> &#123;</span><br><span class="line">	m <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewHashSet</span><span class="params">()</span></span> *HashSet &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;HashSet&#123;m: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="type">bool</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Add(e <span class="keyword">interface</span>&#123;&#125;) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> self.m[e] &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	self.m[e] = <span class="literal">true</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Remove(e <span class="keyword">interface</span>&#123;&#125;) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="built_in">delete</span>(self.m, e)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Clear() <span class="type">bool</span> &#123;</span><br><span class="line">	self.m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="type">bool</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Contains(e <span class="keyword">interface</span>&#123;&#125;) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> self.m[e]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Len() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(self.m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Same(other *HashSet) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> other == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> self.Len() != other.Len() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> k, _ := <span class="keyword">range</span> other.m &#123;</span><br><span class="line">		<span class="keyword">if</span> !self.Contains(k) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Elements() <span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	<span class="comment">// for k := range self.m&#123;</span></span><br><span class="line">	<span class="comment">//    snapshot = snapshot(snapshot, k)</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	initialLen := self.Len()</span><br><span class="line">	actualLen := <span class="number">0</span></span><br><span class="line">	snapshot := <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, initialLen)</span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> self.m &#123;</span><br><span class="line">		<span class="keyword">if</span> actualLen &lt; initialLen &#123;</span><br><span class="line">			snapshot[actualLen] = k</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			snapshot = <span class="built_in">append</span>(snapshot, k)</span><br><span class="line">		&#125;</span><br><span class="line">		actualLen++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> actualLen &lt; initialLen &#123;</span><br><span class="line">		snapshot = snapshot[:actualLen]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> snapshot</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> buf bytes.Buffer</span><br><span class="line">	buf.WriteString(<span class="string">&quot;Set&#123;&quot;</span>)</span><br><span class="line">	flag := <span class="literal">true</span></span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> self.m &#123;</span><br><span class="line">		<span class="keyword">if</span> flag &#123;</span><br><span class="line">			flag = <span class="literal">false</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			buf.WriteString(<span class="string">&quot; &quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		buf.WriteString(fmt.Sprintf(<span class="string">&quot;%v&quot;</span>, k))</span><br><span class="line">	&#125;</span><br><span class="line">	buf.WriteString(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> buf.String()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> IsSuperSet(other *HashSet) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> other == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	selfLen := self.Len()</span><br><span class="line">	otherLen := other.Len()</span><br><span class="line">	<span class="keyword">if</span> otherLen == <span class="number">0</span> || selfLen == otherLen &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> selfLen &gt; <span class="number">0</span> &amp;&amp; otherLen == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> other.m &#123;</span><br><span class="line">		<span class="keyword">if</span> !self.Contains(v) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±äºAæˆ–å±äºBçš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Union(other *HashSet) *HashSet &#123;</span><br><span class="line">	<span class="comment">// if other == nil || other.Len() == 0&#123;</span></span><br><span class="line">	<span class="comment">//    return self</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// for v := range other.m&#123;</span></span><br><span class="line">	<span class="comment">//    self.Add(v)</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	<span class="comment">// return self</span></span><br><span class="line">	<span class="comment">//ä¸èƒ½æ”¹å˜é›†åˆAçš„èŒƒå›´</span></span><br><span class="line">	union := NewHashSet()</span><br><span class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> self.m &#123;</span><br><span class="line">		union.Add(v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> other.m &#123;</span><br><span class="line">		union.Add(v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> union</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±äºAä¸”å±äºBçš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Intersect(other *HashSet) *HashSet &#123;</span><br><span class="line">	<span class="keyword">if</span> other == <span class="literal">nil</span> || other.Len() == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> NewHashSet()</span><br><span class="line">	&#125;</span><br><span class="line">	intsSet := NewHashSet()</span><br><span class="line">	<span class="keyword">for</span> v, _ := <span class="keyword">range</span> other.m &#123;</span><br><span class="line">		<span class="keyword">if</span> self.Contains(v) &#123;</span><br><span class="line">			intsSet.Add(v)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> intsSet</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±äºAä¸”ä¸å±äºBçš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> Difference(other *HashSet) *HashSet &#123;</span><br><span class="line">	diffSet := NewHashSet()</span><br><span class="line">	<span class="keyword">if</span> other == <span class="literal">nil</span> || other.Len() == <span class="number">0</span> &#123;</span><br><span class="line">		diffSet.Union(self)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> v := <span class="keyword">range</span> self.m &#123;</span><br><span class="line">			<span class="keyword">if</span> !other.Contains(v) &#123;</span><br><span class="line">				diffSet.Add(v)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> diffSet</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é›†åˆAä¸é›†åˆBä¸­æ‰€æœ‰ä¸å±äºAâˆ©Bçš„å…ƒç´ çš„é›†åˆ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(self *HashSet)</span></span> SymmetricDifference(other *HashSet) *HashSet &#123;</span><br><span class="line">	<span class="comment">//æ­¤æ—¶Aâˆ©B=âˆ…ï¼ŒAä¸­æ‰€æœ‰å…ƒç´ å‡ä¸å±äºç©ºé›†</span></span><br><span class="line">	<span class="comment">// if other == nil || other.Len() == 0&#123;</span></span><br><span class="line">	<span class="comment">//    return self</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	<span class="comment">// ints := self.Intersect(other)</span></span><br><span class="line">	<span class="comment">// //æ­¤æ—¶Aâˆ©B=âˆ…ï¼ŒAä¸ºç©ºæˆ–Bä¸ºç©º,Bä¸ºç©ºå‰é¢å·²ç»åˆ¤æ–­ï¼Œæ­¤æ—¶Bä¸èƒ½ä¸ºç©ºï¼Œå³Aä¸ºç©º</span></span><br><span class="line">	<span class="comment">// if ints == nil || ints.Len() == 0 &#123;</span></span><br><span class="line">	<span class="comment">//    return other</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// unionSet := self.Union(other)</span></span><br><span class="line">	<span class="comment">// result := NewHashSet()</span></span><br><span class="line">	<span class="comment">// for v := range unionSet.m&#123;</span></span><br><span class="line">	<span class="comment">//    if !ints.Contains(v)&#123;</span></span><br><span class="line">	<span class="comment">//       result.Add(v)</span></span><br><span class="line">	<span class="comment">//    &#125;</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	ints := self.Difference(other)</span><br><span class="line">	union := self.Union(other)</span><br><span class="line">	<span class="keyword">return</span> union.Difference(ints)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	set1 := NewHashSet()</span><br><span class="line">	set1.Add(<span class="number">1</span>)</span><br><span class="line">	set1.Add(<span class="string">&quot;e2&quot;</span>)</span><br><span class="line">	set1.Add(<span class="number">3</span>)</span><br><span class="line">	set1.Add(<span class="string">&quot;e4&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;set1:&quot;</span>, set1)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;set1 Elements:%v\n&quot;</span>, set1.Elements())</span><br><span class="line"></span><br><span class="line">	set2 := NewHashSet()</span><br><span class="line">	set2.Add(<span class="number">3</span>)</span><br><span class="line">	set2.Add(<span class="string">&quot;e2&quot;</span>)</span><br><span class="line">	set2.Add(<span class="number">5</span>)</span><br><span class="line">	set2.Add(<span class="string">&quot;e6&quot;</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;set2:&quot;</span>, set1)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;set1 union set2:%v\n&quot;</span>, set1.Union(set2))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;set1 intersect set2:%v\n&quot;</span>, set1.Intersect(set2))</span><br><span class="line">	fmt.Println(set1, set2)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;set1 difference set2:%v\n&quot;</span>, set1.Difference(set2))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;set1 SymmetricDifference set2:%v\n&quot;</span>, set1.SymmetricDifference(set2))</span><br><span class="line">	set1.Clear()</span><br><span class="line">	fmt.Println(set1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="8-åˆ—è¡¨"><a href="#8-åˆ—è¡¨" class="headerlink" title="8.åˆ—è¡¨"></a>8.åˆ—è¡¨</h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ListLength  =<span class="number">10</span>  <span class="comment">//å®šä¹‰åˆ—è¡¨å…¨å±€é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//interface  å®ä¾‹åŒ–intï¼Œint., string ,string</span></span><br><span class="line"><span class="keyword">type</span>  List <span class="keyword">interface</span> &#123;</span><br><span class="line">	Size() <span class="type">int</span>  <span class="comment">//å‡½æ•°å¤§å°ï¼Œè¿”å›å¤§å°</span></span><br><span class="line">	Get(index <span class="type">int</span>)(<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>) <span class="comment">//æ ¹æ®ç´¢å¼•æŠ“å–æ•°æ®</span></span><br><span class="line">	Set(index <span class="type">int</span>,newval <span class="keyword">interface</span>&#123;&#125;)<span class="type">error</span> <span class="comment">//è®¾ç½®</span></span><br><span class="line">	Insert(index <span class="type">int</span>,newval <span class="keyword">interface</span>&#123;&#125;)<span class="type">error</span> <span class="comment">//æ’å…¥</span></span><br><span class="line">	Append(newval <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span><span class="comment">//è¿½åŠ </span></span><br><span class="line">	Remove(index <span class="type">int</span>)<span class="type">error</span>   <span class="comment">//åˆ é™¤</span></span><br><span class="line">	Clear() <span class="comment">//æ¸…ç©º</span></span><br><span class="line">	String() <span class="type">string</span> <span class="comment">//è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">type</span> ArrayList <span class="keyword">struct</span>&#123;</span><br><span class="line">	dataStore []  <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	theSize  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ›å»ºæ–°çš„é“¾è¡¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="title">New</span><span class="params">()</span></span> *ArrayList&#123;</span><br><span class="line">	list:=<span class="built_in">new</span>(ArrayList)</span><br><span class="line">	list.dataStore = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>,ListLength) <span class="comment">//åˆ†é…å†…å­˜10ä¸ªæ•°ç»„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">	list.theSize=<span class="number">0</span>  <span class="comment">//0</span></span><br><span class="line">	<span class="comment">//fmt.Println(&quot;new&quot;,list.theSize,cap(list.dataStore))</span></span><br><span class="line">	<span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é“¾è¡¨é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList)</span></span> Size() <span class="type">int</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> list.theSize  <span class="comment">//è¿”å›å¤§å°</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿½åŠ æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(list *ArrayList)</span></span>  Append (newval  <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line"></span><br><span class="line">	list.dataStore=<span class="built_in">append</span>(list.dataStore,newval) <span class="comment">//æ•°æ®å åŠ </span></span><br><span class="line">	list.theSize++ <span class="comment">//ç´¢å¼•ç§»åŠ¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è·å–ç´¢å¼•æ‰€åœ¨æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList)</span></span>  Get(index <span class="type">int</span>)(<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> index &lt;<span class="number">0</span> || index &gt;=list.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>,errors.New(<span class="string">&quot;ç´¢å¼•è¶Šç•Œ&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list.dataStore[index],<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®ç´¢å¼•æ›´æ”¹æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList)</span></span>  Set(index <span class="type">int</span>,newval <span class="keyword">interface</span>&#123;&#125;)(<span class="type">error</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> index &lt;<span class="number">0</span> || index &gt;=list.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;ç´¢å¼•è¶Šç•Œ&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	list.dataStore[index]=newval <span class="comment">//èµ‹å€¼æ–°çš„å€¼</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ£€æŸ¥åˆ‡ç‰‡æ˜¯å¦å·²æ»¡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span> checkmemisfull()&#123;</span><br><span class="line">	<span class="keyword">if</span> list.Size()==<span class="built_in">cap</span>(list.dataStore)&#123;</span><br><span class="line">		newDataStore:=<span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>,<span class="number">2</span>*list.Size())<span class="comment">//å¼€è¾Ÿæ›´å¤§å†…å­˜</span></span><br><span class="line">		<span class="built_in">copy</span>(newDataStore,list.dataStore) <span class="comment">//æ‹·è´</span></span><br><span class="line">		list.dataStore=newDataStore <span class="comment">//èµ‹å€¼</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span>Insert(index <span class="type">int</span>,newval <span class="keyword">interface</span>&#123;&#125;)<span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> index &lt;<span class="number">0</span> || index &gt;=list.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;ç´¢å¼•è¶Šç•Œ&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	list.checkmemisfull()</span><br><span class="line">	list.dataStore=list.dataStore[:list.Size()+<span class="number">1</span>]<span class="comment">//å¼€è¾Ÿå†…å­˜,å»¶å±•ä½¿ç”¨çš„å†…å­˜</span></span><br><span class="line">	<span class="keyword">for</span> i:=list.Size();i&gt;index;i--&#123;</span><br><span class="line">		list.dataStore[i]=list.dataStore[i<span class="number">-1</span>] <span class="comment">//ä»åå¾€å‰èµ‹å€¼</span></span><br><span class="line">	&#125;</span><br><span class="line">	list.dataStore[index]=newval  <span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line">	list.theSize++ <span class="comment">//ç´¢å¼•åŠ 1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ ¹æ®ç´¢å¼•ç§»å‡ºæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span>Remove(index <span class="type">int</span>)<span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> index &lt;<span class="number">0</span> || index &gt;=list.theSize&#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;ç´¢å¼•è¶Šç•Œ&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	list.dataStore=<span class="built_in">append</span>(list.dataStore[:index],list.dataStore[index+<span class="number">1</span>:]...) <span class="comment">//åˆ é™¤</span></span><br><span class="line">	list.theSize--</span><br><span class="line">	<span class="keyword">return</span>  <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¸…ç©ºæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span>Clear() &#123;</span><br><span class="line">	list.dataStore=<span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;,<span class="number">0</span>,<span class="number">10</span>) <span class="comment">//æ¸…ç©º</span></span><br><span class="line">	list.theSize=<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list *ArrayList )</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span>  fmt.Sprint(list.dataStore)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	list :=New()</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span> ;i++  &#123;</span><br><span class="line">		list.Append(i)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;åˆ—è¡¨é•¿åº¦ï¼š%d\nè¾“å‡ºåˆ—è¡¨\n%d\n&quot;</span>,list.theSize,list.dataStore)</span><br><span class="line"></span><br><span class="line">	list.Remove(<span class="number">3</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;è¾“å‡ºåˆ—è¡¨&quot;</span>)</span><br><span class="line">	fmt.Println(list.dataStore)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	list.Insert(<span class="number">3</span>,<span class="number">100</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;è¾“å‡ºåˆ—è¡¨&quot;</span>)</span><br><span class="line">	fmt.Println(list.dataStore)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;è¾“å‡ºåˆ—è¡¨&quot;</span>)</span><br><span class="line">	fmt.Println(list.String())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>è¿­ä»£å™¨</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">type</span> Iterator <span class="keyword">interface</span> &#123;</span><br><span class="line">	HasNext() <span class="type">bool</span><span class="comment">//åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ª</span></span><br><span class="line">	Next()(<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>) <span class="comment">//è·å–ä¸‹ä¸€ä¸ª</span></span><br><span class="line">	Remove()<span class="comment">//åˆ é™¤</span></span><br><span class="line">	getindex()<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Iterable <span class="keyword">interface</span> &#123;</span><br><span class="line">	Iterator () Iterator <span class="comment">//æ„é€ è¿­ä»£å™¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> ArrayListIterator <span class="keyword">struct</span>&#123;</span><br><span class="line">	list * ArrayList  <span class="comment">//æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line">	currentindex  <span class="type">int</span> <span class="comment">//å½“å‰çš„ç´¢å¼•</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(list * ArrayList )</span></span> Iterator() Iterator&#123;</span><br><span class="line">	iterator:=<span class="built_in">new</span>(ArrayListIterator) <span class="comment">//åˆ›é€ è¿­ä»£å™¨</span></span><br><span class="line">	iterator.currentindex=<span class="number">0</span></span><br><span class="line">	iterator.list=list <span class="comment">//æŒ‡é’ˆä¼ é€’</span></span><br><span class="line">	<span class="keyword">return</span> iterator  <span class="comment">//è¿”å›è¿­ä»£å™¨ï¼Œé©¾é©­æ•°ç»„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="params">(it *ArrayListIterator)</span></span>getindex() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> it.currentindex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="params">(it *ArrayListIterator)</span></span>HasNext() <span class="type">bool</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> it.currentindex &lt;it.list.Size()  <span class="comment">//å­˜åœ¨ä¸‹ä¸€ä¸ª</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="params">(it *ArrayListIterator)</span></span>Next()(<span class="keyword">interface</span>&#123;&#125;,<span class="type">error</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> !it.HasNext()&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>,errors.New(<span class="string">&quot;æ²¡æœ‰æ•°æ®&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	value,err:=it.list.Get(it.currentindex)<span class="comment">//æå–ä¸Šä¸€ä¸ª</span></span><br><span class="line">	it.currentindex++</span><br><span class="line">	<span class="keyword">return</span> value,err</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span>  <span class="params">(it *ArrayListIterator)</span></span>	Remove()&#123;</span><br><span class="line">	it.currentindex--</span><br><span class="line">	it.list.Remove(it.currentindex) <span class="comment">//åˆ é™¤</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	list :=New()</span><br><span class="line">	list.Append(<span class="number">1</span>)</span><br><span class="line">	fmt.Println(list)</span><br><span class="line">	list.Append(<span class="number">2</span>)</span><br><span class="line">	fmt.Println(list)</span><br><span class="line">	list.Append(<span class="number">3</span>)</span><br><span class="line">	fmt.Println(list)</span><br><span class="line">	list.Append(<span class="number">4</span>)</span><br><span class="line">	fmt.Println(list)</span><br><span class="line">	<span class="keyword">for</span> it:=list.Iterator();it.HasNext();&#123;</span><br><span class="line">		item,_:=it.Next()</span><br><span class="line">		<span class="keyword">if</span> item==<span class="number">3</span>&#123;</span><br><span class="line">			it.Remove()</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(item)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(list)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="9-å“ˆå¸Œè¡¨"><a href="#9-å“ˆå¸Œè¡¨" class="headerlink" title="9.å“ˆå¸Œè¡¨"></a>9.å“ˆå¸Œè¡¨</h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// hash è¡¨, key, v ç»„æˆ</span></span><br><span class="line"><span class="keyword">type</span> Key <span class="keyword">interface</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Value <span class="keyword">interface</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆä¸€ä¸ªhashè¡¨</span></span><br><span class="line"><span class="keyword">type</span> HashTable <span class="keyword">struct</span> &#123;</span><br><span class="line">	Items <span class="keyword">map</span>[<span class="type">int</span>] Value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™hashè¡¨ä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ht *HashTable)</span></span> Put(key Key, value Value)  &#123;</span><br><span class="line">	index := customeHash(key)</span><br><span class="line">	<span class="keyword">if</span> ht.Items == <span class="literal">nil</span>&#123;</span><br><span class="line">		ht.Items = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]Value)</span><br><span class="line">	&#125;</span><br><span class="line">	ht.Items[index] = value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">customeHash</span><span class="params">(k Key)</span></span> <span class="type">int</span>  &#123;</span><br><span class="line">	<span class="comment">// è‡ªå®šä¹‰hashç®—æ³•</span></span><br><span class="line">	key := fmt.Sprintf(<span class="string">&quot;%s&quot;</span>, k)</span><br><span class="line">	h := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="built_in">len</span>(key); i++&#123;</span><br><span class="line">		h = <span class="number">31</span> * h + <span class="type">int</span>(key[i])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> h</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ht *HashTable)</span></span> Get(key Key) Value  &#123;</span><br><span class="line">	index := customeHash(key)</span><br><span class="line">	<span class="keyword">return</span> ht.Items[index]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ht *HashTable)</span></span> Remove(key Key)  &#123;</span><br><span class="line">	index := customeHash(key)</span><br><span class="line">	<span class="built_in">delete</span>(ht.Items, index)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ht *HashTable)</span></span> Size() <span class="type">int</span>  &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(ht.Items)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ht *HashTable)</span></span>String() &#123;</span><br><span class="line">	<span class="comment">// mapéå†æ— åº</span></span><br><span class="line">	<span class="keyword">for</span> k,v := <span class="keyword">range</span> ht.Items &#123;</span><br><span class="line">		fmt.Println(fmt.Sprintf(<span class="string">&quot;k: %v\tv: %v&quot;</span>,k,v))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">populateHashTable</span><span class="params">(count <span class="type">int</span>, start <span class="type">int</span>)</span></span> *HashTable &#123;</span><br><span class="line">	dict := HashTable&#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> i := start; i &lt; (start + count); i++ &#123;</span><br><span class="line">		dict.Put(fmt.Sprintf(<span class="string">&quot;key%d&quot;</span>, i), fmt.Sprintf(<span class="string">&quot;value%d&quot;</span>, i))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> &amp;dict</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	dict := populateHashTable(<span class="number">3</span>, <span class="number">0</span>)</span><br><span class="line">	size := dict.Size()</span><br><span class="line">	fmt.Println(fmt.Sprintf(<span class="string">&quot;Test failed, expected 3 and got %d&quot;</span>, size))</span><br><span class="line">	dict.String()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="9-æ ‘"><a href="#9-æ ‘" class="headerlink" title="9.æ ‘"></a>9.æ ‘</h1><h2 id="9-1-äºŒå‰æ ‘"><a href="#9-1-äºŒå‰æ ‘" class="headerlink" title="9.1 äºŒå‰æ ‘"></a>9.1 äºŒå‰æ ‘</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> BinaryTreeNode <span class="keyword">struct</span> &#123;</span><br><span class="line">	Data  <span class="keyword">interface</span>&#123;&#125;     <span class="comment">//æ•°æ®</span></span><br><span class="line">	Left  *BinaryTreeNode <span class="comment">//å·¦å­æ ‘</span></span><br><span class="line">	Right *BinaryTreeNode <span class="comment">//å³å­æ ‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewTree</span><span class="params">(data <span class="keyword">interface</span>&#123;&#125;)</span></span> *BinaryTreeNode &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;BinaryTreeNode&#123;</span><br><span class="line">		Data: data,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CreateNode</span><span class="params">(data <span class="keyword">interface</span>&#123;&#125;)</span></span> *BinaryTreeNode &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;BinaryTreeNode&#123;</span><br><span class="line">		Data: data,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot; %v&quot;</span>, tree.Data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‰åºéå†:ä»¥å½“å‰èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œæ ¹â€”â€”&gt;å·¦â€”â€”&gt;å³</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> PreTraverseRecursion(<span class="built_in">print</span> <span class="type">bool</span>) (treeString <span class="type">string</span>) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	treeString += tree.String()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> tree.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Left.PreTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> tree.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Right.PreTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">print</span> &#123;</span><br><span class="line">		fmt.Println(fmt.Sprintf(<span class="string">&quot;å‰åºéå†:[%v]&quot;</span>, treeString))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸­åºéå†:ä»¥å½“å‰èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå·¦â€”â€”&gt;æ ¹â€”â€”&gt;å³</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> MidTraverseRecursion(<span class="built_in">print</span> <span class="type">bool</span>) (treeString <span class="type">string</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> tree.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Left.MidTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	treeString += tree.String()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> tree.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Right.MidTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">print</span> &#123;</span><br><span class="line">		fmt.Println(fmt.Sprintf(<span class="string">&quot;ä¸­åºéå†:[%v]&quot;</span>, treeString))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åç»­éå†ï¼šä»¥å½“å‰èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå·¦â€”â€”&gt;å³â€”â€”&gt;æ ¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> PostTraverseRecursion(<span class="built_in">print</span> <span class="type">bool</span>) (treeString <span class="type">string</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> tree.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Left.PostTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> tree.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">		treeString += tree.Right.PostTraverseRecursion(<span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	treeString += tree.String()</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">print</span> &#123;</span><br><span class="line">		fmt.Println(fmt.Sprintf(<span class="string">&quot;ååºéå†:[%v]&quot;</span>, treeString))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±‚æ¬¡éå†(å¹¿åº¦ä¼˜å…ˆéå†)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> BreadthFirstSearch(<span class="built_in">print</span> <span class="type">bool</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> result []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	nodes := []*BinaryTreeNode&#123;tree&#125;</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(nodes) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		curNode := nodes[<span class="number">0</span>]</span><br><span class="line">		nodes = nodes[<span class="number">1</span>:]</span><br><span class="line">		result = <span class="built_in">append</span>(result, curNode.Data)</span><br><span class="line">		<span class="keyword">if</span> curNode.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">			nodes = <span class="built_in">append</span>(nodes, curNode.Left)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> curNode.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">			nodes = <span class="built_in">append</span>(nodes, curNode.Right)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">print</span> &#123;</span><br><span class="line">		fmt.Print(fmt.Sprintf(<span class="string">&quot;å±‚æ¬¡éå†:[&quot;</span>))</span><br><span class="line">		<span class="keyword">for</span> _, v := <span class="keyword">range</span> result &#123;</span><br><span class="line">			fmt.Print(<span class="string">&quot; &quot;</span>)</span><br><span class="line">			fmt.Print(v)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;]&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±‚æ•°(é€’å½’å®ç°)</span></span><br><span class="line"><span class="comment">//å¯¹ä»»æ„ä¸€ä¸ªå­æ ‘çš„æ ¹èŠ‚ç‚¹æ¥è¯´ï¼Œå®ƒçš„æ·±åº¦=å·¦å³å­æ ‘æ·±åº¦çš„æœ€å¤§å€¼+1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> Layers() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	leftLayers := tree.Left.Layers()</span><br><span class="line">	rightLayers := tree.Right.Layers()</span><br><span class="line">	<span class="keyword">if</span> leftLayers &gt; rightLayers &#123;</span><br><span class="line">		<span class="keyword">return</span> leftLayers + <span class="number">1</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> rightLayers + <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å±‚æ•°(éé€’å½’å®ç°)</span></span><br><span class="line"><span class="comment">//å€ŸåŠ©é˜Ÿåˆ—ï¼Œåœ¨è¿›è¡ŒæŒ‰å±‚éå†æ—¶ï¼Œè®°å½•éå†çš„å±‚æ•°å³å¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tree *BinaryTreeNode)</span></span> LayersByQueue() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> tree == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	layers := <span class="number">0</span></span><br><span class="line">	nodes := []*BinaryTreeNode&#123;tree&#125;</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(nodes) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		layers++</span><br><span class="line">		size := <span class="built_in">len</span>(nodes) <span class="comment">//æ¯å±‚çš„èŠ‚ç‚¹æ•°</span></span><br><span class="line">		count := <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> count &lt; size &#123;</span><br><span class="line">			count++</span><br><span class="line">			curNode := nodes[<span class="number">0</span>]</span><br><span class="line">			nodes = nodes[<span class="number">1</span>:]</span><br><span class="line">			<span class="keyword">if</span> curNode.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">				nodes = <span class="built_in">append</span>(nodes, curNode.Left)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> curNode.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">				nodes = <span class="built_in">append</span>(nodes, curNode.Right)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> layers</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := NewTree(<span class="number">3</span>)</span><br><span class="line">	tree.Left = CreateNode(<span class="number">0</span>)</span><br><span class="line">	tree.Left.Right = CreateNode(<span class="number">2</span>)</span><br><span class="line">	tree.Right = CreateNode(<span class="number">5</span>)</span><br><span class="line">	tree.Right.Left = CreateNode(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å‰åº</span></span><br><span class="line">	tree.PreTraverseRecursion(<span class="literal">true</span>)</span><br><span class="line">	<span class="comment">// ä¸­åº</span></span><br><span class="line">	tree.MidTraverseRecursion(<span class="literal">true</span>)</span><br><span class="line">	<span class="comment">// åç»­</span></span><br><span class="line">	tree.PostTraverseRecursion(<span class="literal">true</span>)</span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	tree.BreadthFirstSearch(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;å±‚æ•°: &quot;</span>, tree.Layers())</span><br><span class="line">	fmt.Println(<span class="string">&quot;å±‚æ•°: &quot;</span>, tree.LayersByQueue())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="9-2-äºŒåˆ†æœç´¢æ ‘"><a href="#9-2-äºŒåˆ†æœç´¢æ ‘" class="headerlink" title="9.2 äºŒåˆ†æœç´¢æ ‘"></a>9.2 äºŒåˆ†æœç´¢æ ‘</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span> &#123;</span><br><span class="line">	E <span class="type">int</span></span><br><span class="line">	Left *Node</span><br><span class="line">	Right *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¦å®šåœ¨æ­¤æ ·ä¾‹ä»£ç ä¸­æˆ‘ä»¬çš„äºŒåˆ†æœç´¢æ ‘ä¸­æ²¡æœ‰é‡å¤å…ƒç´ </span></span><br><span class="line"><span class="comment">// å¦‚æœæƒ³åŒ…æ¶µé‡å¤å…ƒç´ çš„è¯ï¼Œåªéœ€è¦ä»¥ä¸‹å®šä¹‰ï¼š</span></span><br><span class="line"><span class="comment">// å·¦å­æ ‘å°äºç­‰äºæ­¤èŠ‚ç‚¹ï¼Œæˆ–å³å­æ ‘å¤§äºç­‰äºèŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">type</span> Tree <span class="keyword">struct</span> &#123;</span><br><span class="line">	root *Node</span><br><span class="line">	size <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Tree)</span></span> Size() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> t.size</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Tree)</span></span> Root() *Node &#123;</span><br><span class="line">	<span class="keyword">return</span> t.root</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> IsEmpty() <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> this.size == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InitNode</span><span class="params">(E <span class="type">int</span>)</span></span> *Node &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Node&#123;</span><br><span class="line">		E:E,</span><br><span class="line">		Left:<span class="literal">nil</span>,</span><br><span class="line">		Right:<span class="literal">nil</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> AddE(e <span class="type">int</span>) &#123;</span><br><span class="line">	this.root = this.add(this.root,e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘ä»¥nodeä¸ºæ ¹çš„äºŒåˆ†æœç´¢æ ‘ä¸­æ’å…¥å…ƒç´ Eï¼Œé€’å½’ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> add(node *Node,e <span class="type">int</span>) *Node&#123;</span><br><span class="line">	<span class="comment">// ä¸ç®¡æ˜¯é€’å½’è¿˜æ˜¯å›æº¯ï¼Œé¦–å…ˆæˆ‘ä»¬éƒ½åº”è¯¥å…ˆå†™å‡ºé€’å½’çš„ç»“æŸæ¡ä»¶æ˜¯ä»€ä¹ˆ</span></span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		this.size++</span><br><span class="line">		<span class="keyword">return</span> InitNode(e)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> e &gt; node.E &#123;</span><br><span class="line">		node.Right = this.add(node.Right, e)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> e &lt; node.E &#123;</span><br><span class="line">		node.Left = this.add(node.Left, e)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾äºŒåˆ†æœç´¢ä¸­æ˜¯å¦å«æœ‰å…ƒç´ E</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span>Contains(e <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> this.contains(this.root, e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’çš„æ–¹å¼æŸ¥æ‰¾å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span>contains (node *Node, e <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> e == node.E &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> e &gt; node.E &#123;</span><br><span class="line">		<span class="keyword">return</span> this.contains(node.Right,e)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> this.contains(node.Left, e)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†ç®—æ³•</span></span><br><span class="line"><span class="comment">// 1.å‰åºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(this *Tree)</span></span>PreOrder()&#123;</span><br><span class="line">	PreOrder(this.root)</span><br><span class="line">	fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PreOrder</span><span class="params">(node *Node)</span></span>  &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%d &quot;</span>,node.E)</span><br><span class="line">	PreOrder(node.Left)</span><br><span class="line">	PreOrder(node.Right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éé€’å½’çš„å‰åºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> PreOrderNR() &#123;</span><br><span class="line">	stack := <span class="built_in">make</span>([]*Node, <span class="number">0</span>)</span><br><span class="line">	stack = <span class="built_in">append</span>(stack, this.root)</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(stack) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		curNode := stack[<span class="built_in">len</span>(stack)<span class="number">-1</span>]</span><br><span class="line">		stack = stack[:<span class="built_in">len</span>(stack)<span class="number">-1</span>]</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%d &quot;</span>,curNode.E)</span><br><span class="line">		<span class="keyword">if</span> curNode.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">			stack = <span class="built_in">append</span>(stack, curNode.Right)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> curNode.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">			stack = <span class="built_in">append</span>(stack, curNode.Left)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.ä¸­åºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(this *Tree)</span></span>MidOrder()&#123;</span><br><span class="line">	MidOrder(this.root)</span><br><span class="line">	fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MidOrder</span><span class="params">(node *Node)</span></span>  &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	MidOrder(node.Left)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%d &quot;</span>,node.E)</span><br><span class="line">	MidOrder(node.Right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.ååºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> BackOrder()&#123;</span><br><span class="line">	BackOrder(this.root)</span><br><span class="line">	<span class="built_in">println</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BackOrder</span><span class="params">(node *Node)</span></span>  &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	BackOrder(node.Left)</span><br><span class="line">	BackOrder(node.Right)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%d &quot;</span>,node.E)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// äºŒåˆ†æœç´¢æ ‘çš„å±‚åºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span>LevelOrder()&#123;</span><br><span class="line">	queue := <span class="built_in">make</span>([]*Node,<span class="number">0</span>)</span><br><span class="line">	queue = <span class="built_in">append</span>(queue, this.root)</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(queue) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		curNode := queue[<span class="number">0</span>]</span><br><span class="line">		queue = queue[<span class="number">1</span>:]</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%d &quot;</span>,curNode.E)</span><br><span class="line">		<span class="keyword">if</span> curNode.Left != <span class="literal">nil</span> &#123;</span><br><span class="line">			queue = <span class="built_in">append</span>(queue,curNode.Left)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> curNode.Right != <span class="literal">nil</span> &#123;</span><br><span class="line">			queue = <span class="built_in">append</span>(queue,curNode.Right)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// äºŒåˆ†æœç´¢æ ‘ä¸­æœç´¢æœ€å°å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> FindMin() <span class="type">int</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> this.IsEmpty() &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;äºŒå‰æ ‘ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤ä»»ä½•èŠ‚ç‚¹&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> minimum(this.root).E</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minimum</span><span class="params">(node *Node)</span></span> *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> node.Left == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> minimum(node.Left)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// äºŒåˆ†æœç´¢æ ‘ä¸­æœç´¢æœ€å¤§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> FindMax() <span class="type">int</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> this.IsEmpty() &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;äºŒå‰æ ‘ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤ä»»ä½•èŠ‚ç‚¹&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> maximum(this.root).E</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maximum</span><span class="params">(node *Node)</span></span> *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> node.Right == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maximum(node.Right)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»äºŒåˆ†æœç´¢æ ‘ä¸­åˆ é™¤æœ€å°å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> DelMin() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> ret <span class="type">int</span> = this.FindMin()</span><br><span class="line">	this.root = this.rmMin(this.root)</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ é™¤æ‰ä»¥nodeä¸ºæ ¹çš„äºŒåˆ†æœç´¢æ ‘çš„æœ€å°èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">// è¿”å›åˆ é™¤èŠ‚ç‚¹åæ–°çš„äºŒåˆ†æœç´¢æ ‘çš„æ ¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> rmMin(node *Node) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> node.Left == <span class="literal">nil</span> &#123;</span><br><span class="line">		nodeRight := node.Right</span><br><span class="line">		node.Right = <span class="literal">nil</span></span><br><span class="line">		this.size--</span><br><span class="line">		<span class="keyword">return</span> nodeRight</span><br><span class="line">	&#125;</span><br><span class="line">	node.Left = this.rmMin(node.Left)</span><br><span class="line">	<span class="keyword">return</span> node</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»äºŒåˆ†æœç´¢æ ‘ç§åˆ é™¤æœ€å¤§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> DelMax() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> ret <span class="type">int</span> = this.FindMax()</span><br><span class="line">	this.root = this.rmMax(this.root)</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ é™¤æ‰ä»¥nodeä¸ºæ ¹çš„äºŒåˆ†æœç´¢æ ‘çš„æœ€å°èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">// è¿”å›åˆ é™¤èŠ‚ç‚¹åæ–°çš„äºŒåˆ†æœç´¢æ ‘çš„æ ¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> rmMax(node *Node) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> node.Right == <span class="literal">nil</span> &#123;</span><br><span class="line">		nodeLeft := node.Left</span><br><span class="line">		node.Left = <span class="literal">nil</span></span><br><span class="line">		this.size--</span><br><span class="line">		<span class="keyword">return</span> nodeLeft</span><br><span class="line">	&#125;</span><br><span class="line">	node.Right = this.rmMax(node.Right)</span><br><span class="line">	<span class="keyword">return</span> node</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨äºŒåˆ†æœç´¢æ ‘ä¸­åˆ é™¤å€¼ä¸ºeçš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> Remove (e <span class="type">int</span>)&#123;</span><br><span class="line">	this.root = this.remove(this.root,e)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> remove(node *Node,e <span class="type">int</span>) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> e &gt; node.E &#123;</span><br><span class="line">		node.Right = this.remove(node.Right,e)</span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> e &lt; node.E &#123;</span><br><span class="line">		node.Left = this.remove(node.Left,e)</span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// å¦‚æœå·¦å­æ ‘ä¸ºç©ºçš„æ—¶å€™</span></span><br><span class="line">		<span class="keyword">if</span> node.Left == <span class="literal">nil</span> &#123;</span><br><span class="line">			nodeRight := node.Right</span><br><span class="line">			node.Right = <span class="literal">nil</span></span><br><span class="line">			this.size--</span><br><span class="line">			<span class="keyword">return</span> nodeRight</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// å¦‚æœå³å­æ ‘ä¸ºç©º</span></span><br><span class="line">		<span class="keyword">if</span> node.Right == <span class="literal">nil</span> &#123;</span><br><span class="line">			nodeLeft := node.Left</span><br><span class="line">			node.Left = <span class="literal">nil</span></span><br><span class="line">			this.size--</span><br><span class="line">			<span class="keyword">return</span> nodeLeft</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// å¦‚æœå·¦å³å­æ ‘éƒ½ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°nodeçš„åç»§</span></span><br><span class="line">		<span class="comment">// å°±æ˜¯æ‰€æœ‰æ¯”nodeå€¼å¤§çš„èŠ‚ç‚¹ä¸­å€¼æœ€å°çš„é‚£ä¸ªï¼Œæ˜¾ç„¶å®ƒåœ¨nodeçš„å³å­æ ‘ä¸­</span></span><br><span class="line">		nodeNext := minimum(node.Right)</span><br><span class="line">		nodeNext.Right = this.rmMin(node.Right)</span><br><span class="line">		nodeNext.Left = node.Left</span><br><span class="line">		node.Left = <span class="literal">nil</span></span><br><span class="line">		node.Right = <span class="literal">nil</span></span><br><span class="line">		<span class="keyword">return</span> nodeNext</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äºŒå‰æ ‘çš„æ‰“å°æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Tree)</span></span> String() <span class="type">string</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> (</span><br><span class="line">		builder strings.Builder</span><br><span class="line">	)</span><br><span class="line">	generateBSTString(this.root,<span class="number">0</span>,&amp;builder)</span><br><span class="line">	<span class="keyword">return</span> builder.String()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateBSTString</span><span class="params">(node *Node,depth <span class="type">int</span>,builder *strings.Builder)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Fprintln(builder,generateDepthString(depth) + <span class="string">&quot;null&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Fprintln(builder,generateDepthString(depth),node.E)</span><br><span class="line">	generateBSTString(node.Left,depth+<span class="number">1</span>,builder)</span><br><span class="line">	generateBSTString(node.Right,depth+<span class="number">1</span>,builder)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateDepthString</span><span class="params">(depth <span class="type">int</span>)</span></span> <span class="type">string</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> builder strings.Builder</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;depth;i++ &#123;</span><br><span class="line">		fmt.Fprintf(&amp;builder,<span class="string">&quot;--&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> builder.String()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	tree := Tree&#123;&#125;</span><br><span class="line">	tree.AddE(<span class="number">3</span>)</span><br><span class="line">	tree.Root().Left = InitNode(<span class="number">0</span>)</span><br><span class="line">	tree.Root().Left.Right = InitNode(<span class="number">2</span>)</span><br><span class="line">	tree.Root().Right = InitNode(<span class="number">5</span>)</span><br><span class="line">	tree.Root().Right.Left = InitNode(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(tree.String())</span><br><span class="line"></span><br><span class="line">	tree.PreOrder()</span><br><span class="line">	tree.MidOrder()</span><br><span class="line">	tree.BackOrder()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-3-çº¢é»‘æ ‘"><a href="#9-3-çº¢é»‘æ ‘" class="headerlink" title="9.3 çº¢é»‘æ ‘"></a>9.3 çº¢é»‘æ ‘</h2><p>çº¢é»‘æ ‘ï¼ˆRed Black Treeï¼‰ æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚ çº¢é»‘æ ‘å’ŒAVLæ ‘ç±»ä¼¼ï¼Œéƒ½æ˜¯åœ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é€šè¿‡ç‰¹å®šæ“ä½œä¿æŒäºŒå‰æŸ¥æ‰¾æ ‘çš„å¹³è¡¡ï¼Œä»è€Œè·å¾—è¾ƒé«˜çš„æŸ¥æ‰¾æ€§èƒ½ã€‚ </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright 2015, Hu Keping . All rights reserved.</span></span><br><span class="line"><span class="comment">// Use of this source code is governed by a BSD-style</span></span><br><span class="line"><span class="comment">// license that can be found in the LICENSE file.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Package rbtree implements operations on Red-Black tree.</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Red-Black tree properties:  http://en.wikipedia.org/wiki/Rbtree</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  1) A node is either red or black</span></span><br><span class="line"><span class="comment">//  2) The root is black</span></span><br><span class="line"><span class="comment">//  3) All leaves (NULL) are black</span></span><br><span class="line"><span class="comment">//  4) Both children of every red node are black</span></span><br><span class="line"><span class="comment">//  5) Every simple path from root to leaves contains the same number</span></span><br><span class="line"><span class="comment">//     of black nodes.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span> &#123;</span><br><span class="line">	Left   *Node</span><br><span class="line">	Right  *Node</span><br><span class="line">	Parent *Node</span><br><span class="line">	Color  <span class="type">uint</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// for use by client.</span></span><br><span class="line">	Item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	RED   = <span class="number">0</span></span><br><span class="line">	BLACK = <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Item <span class="keyword">interface</span> &#123;</span><br><span class="line">	Less(than Item) <span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rbtree represents a Red-Black tree.</span></span><br><span class="line"><span class="keyword">type</span> Rbtree <span class="keyword">struct</span> &#123;</span><br><span class="line">	NIL   *Node</span><br><span class="line">	root  *Node</span><br><span class="line">	count <span class="type">uint</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">less</span><span class="params">(x, y Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> x.Less(y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// New returns an initialized Red-Black tree</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">()</span></span> *Rbtree &#123; <span class="keyword">return</span> <span class="built_in">new</span>(Rbtree).Init() &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Init() *Rbtree &#123;</span><br><span class="line">	node := &amp;Node&#123;<span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>, BLACK, <span class="literal">nil</span>&#125;</span><br><span class="line">	<span class="keyword">return</span> &amp;Rbtree&#123;</span><br><span class="line">		NIL:   node,</span><br><span class="line">		root:  node,</span><br><span class="line">		count: <span class="number">0</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> leftRotate(x *Node) &#123;</span><br><span class="line">	<span class="comment">// Since we are doing the left rotation, the right child should *NOT* nil.</span></span><br><span class="line">	<span class="keyword">if</span> x.Right == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// The illation of left rotation</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">//          |                                  |</span></span><br><span class="line">	<span class="comment">//          X                                  Y</span></span><br><span class="line">	<span class="comment">//         / \         left rotate            / \</span></span><br><span class="line">	<span class="comment">//        Î±  Y       -------------&gt;         X   Î³</span></span><br><span class="line">	<span class="comment">//           / \                            / \</span></span><br><span class="line">	<span class="comment">//          Î²  Î³                         Î±  Î²</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// It should be note that during the rotating we do not change</span></span><br><span class="line">	<span class="comment">// the Nodes&#x27; color.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	y := x.Right</span><br><span class="line">	x.Right = y.Left</span><br><span class="line">	<span class="keyword">if</span> y.Left != t.NIL &#123;</span><br><span class="line">		y.Left.Parent = x</span><br><span class="line">	&#125;</span><br><span class="line">	y.Parent = x.Parent</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> x.Parent == t.NIL &#123;</span><br><span class="line">		t.root = y</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> x == x.Parent.Left &#123;</span><br><span class="line">		x.Parent.Left = y</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		x.Parent.Right = y</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	y.Left = x</span><br><span class="line">	x.Parent = y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> rightRotate(x *Node) &#123;</span><br><span class="line">	<span class="comment">// Since we are doing the right rotation, the left child should *NOT* nil.</span></span><br><span class="line">	<span class="keyword">if</span> x.Left == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// The illation of right rotation</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">//          |                                  |</span></span><br><span class="line">	<span class="comment">//          X                                  Y</span></span><br><span class="line">	<span class="comment">//         / \         right rotate           / \</span></span><br><span class="line">	<span class="comment">//        Y   Î³      -------------&gt;         Î±  X</span></span><br><span class="line">	<span class="comment">//       / \                                    / \</span></span><br><span class="line">	<span class="comment">//      Î±  Î²                                 Î²  Î³</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// It should be note that during the rotating we do not change</span></span><br><span class="line">	<span class="comment">// the Nodes&#x27; color.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	y := x.Left</span><br><span class="line">	x.Left = y.Right</span><br><span class="line">	<span class="keyword">if</span> y.Right != t.NIL &#123;</span><br><span class="line">		y.Right.Parent = x</span><br><span class="line">	&#125;</span><br><span class="line">	y.Parent = x.Parent</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> x.Parent == t.NIL &#123;</span><br><span class="line">		t.root = y</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> x == x.Parent.Left &#123;</span><br><span class="line">		x.Parent.Left = y</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		x.Parent.Right = y</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	y.Right = x</span><br><span class="line">	x.Parent = y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> insert(z *Node) *Node &#123;</span><br><span class="line">	x := t.root</span><br><span class="line">	y := t.NIL</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x != t.NIL &#123;</span><br><span class="line">		y = x</span><br><span class="line">		<span class="keyword">if</span> less(z.Item, x.Item) &#123;</span><br><span class="line">			x = x.Left</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> less(x.Item, z.Item) &#123;</span><br><span class="line">			x = x.Right</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> x</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	z.Parent = y</span><br><span class="line">	<span class="keyword">if</span> y == t.NIL &#123;</span><br><span class="line">		t.root = z</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> less(z.Item, y.Item) &#123;</span><br><span class="line">		y.Left = z</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		y.Right = z</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	t.count++</span><br><span class="line">	t.insertFixup(z)</span><br><span class="line">	<span class="keyword">return</span> z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> insertFixup(z *Node) &#123;</span><br><span class="line">	<span class="keyword">for</span> z.Parent.Color == RED &#123;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		<span class="comment">// Howerver, we do not need the assertion of non-nil grandparent</span></span><br><span class="line">		<span class="comment">// because</span></span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		<span class="comment">//  2) The root is black</span></span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		<span class="comment">// Since the color of the parent is RED, so the parent is not root</span></span><br><span class="line">		<span class="comment">// and the grandparent must be exist.</span></span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		<span class="keyword">if</span> z.Parent == z.Parent.Parent.Left &#123;</span><br><span class="line">			<span class="comment">// Take y as the uncle, although it can be NIL, in that case</span></span><br><span class="line">			<span class="comment">// its color is BLACK</span></span><br><span class="line">			y := z.Parent.Parent.Right</span><br><span class="line">			<span class="keyword">if</span> y.Color == RED &#123;</span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">// Case 1:</span></span><br><span class="line">				<span class="comment">// Parent and uncle are both RED, the grandparent must be BLACK</span></span><br><span class="line">				<span class="comment">// due to</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">//  4) Both children of every red node are black</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">// Since the current node and its parent are all RED, we still</span></span><br><span class="line">				<span class="comment">// in violation of 4), So repaint both the parent and the uncle</span></span><br><span class="line">				<span class="comment">// to BLACK and grandparent to RED(to maintain 5)</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">//  5) Every simple path from root to leaves contains the same</span></span><br><span class="line">				<span class="comment">//     number of black nodes.</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				z.Parent.Color = BLACK</span><br><span class="line">				y.Color = BLACK</span><br><span class="line">				z.Parent.Parent.Color = RED</span><br><span class="line">				z = z.Parent.Parent</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> z == z.Parent.Right &#123;</span><br><span class="line">					<span class="comment">//</span></span><br><span class="line">					<span class="comment">// Case 2:</span></span><br><span class="line">					<span class="comment">// Parent is RED and uncle is BLACK and the current node</span></span><br><span class="line">					<span class="comment">// is right child</span></span><br><span class="line">					<span class="comment">//</span></span><br><span class="line">					<span class="comment">// A left rotation on the parent of the current node will</span></span><br><span class="line">					<span class="comment">// switch the roles of each other. This still leaves us in</span></span><br><span class="line">					<span class="comment">// violation of 4).</span></span><br><span class="line">					<span class="comment">// The continuation into Case 3 will fix that.</span></span><br><span class="line">					<span class="comment">//</span></span><br><span class="line">					z = z.Parent</span><br><span class="line">					t.leftRotate(z)</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">// Case 3:</span></span><br><span class="line">				<span class="comment">// Parent is RED and uncle is BLACK and the current node is</span></span><br><span class="line">				<span class="comment">// left child</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				<span class="comment">// At the very beginning of Case 3, current node and parent are</span></span><br><span class="line">				<span class="comment">// both RED, thus we violate 4).</span></span><br><span class="line">				<span class="comment">// Repaint parent to BLACK will fix it, but 5) does not allow</span></span><br><span class="line">				<span class="comment">// this because all paths that go through the parent will get</span></span><br><span class="line">				<span class="comment">// 1 more black node. Then repaint grandparent to RED (as we</span></span><br><span class="line">				<span class="comment">// discussed before, the grandparent is BLACK) and do a right</span></span><br><span class="line">				<span class="comment">// rotation will fix that.</span></span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				z.Parent.Color = BLACK</span><br><span class="line">				z.Parent.Parent.Color = RED</span><br><span class="line">				t.rightRotate(z.Parent.Parent)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// same as then clause with &quot;right&quot; and &quot;left&quot; exchanged</span></span><br><span class="line">			y := z.Parent.Parent.Left</span><br><span class="line">			<span class="keyword">if</span> y.Color == RED &#123;</span><br><span class="line">				z.Parent.Color = BLACK</span><br><span class="line">				y.Color = BLACK</span><br><span class="line">				z.Parent.Parent.Color = RED</span><br><span class="line">				z = z.Parent.Parent</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> z == z.Parent.Left &#123;</span><br><span class="line">					z = z.Parent</span><br><span class="line">					t.rightRotate(z)</span><br><span class="line">				&#125;</span><br><span class="line">				z.Parent.Color = BLACK</span><br><span class="line">				z.Parent.Parent.Color = RED</span><br><span class="line">				t.leftRotate(z.Parent.Parent)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	t.root.Color = BLACK</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Just traverse the node from root to left recursively until left is NIL.</span></span><br><span class="line"><span class="comment">// The node whose left is NIL is the node with minimum value.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> min(x *Node) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> t.NIL</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x.Left != t.NIL &#123;</span><br><span class="line">		x = x.Left</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Just traverse the node from root to right recursively until right is NIL.</span></span><br><span class="line"><span class="comment">// The node whose right is NIL is the node with maximum value.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> max(x *Node) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> t.NIL</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x.Right != t.NIL &#123;</span><br><span class="line">		x = x.Right</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> search(x *Node) *Node &#123;</span><br><span class="line">	p := t.root</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> p != t.NIL &#123;</span><br><span class="line">		<span class="keyword">if</span> less(p.Item, x.Item) &#123;</span><br><span class="line">			p = p.Right</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> less(x.Item, p.Item) &#123;</span><br><span class="line">			p = p.Left</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span> Need Document</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> successor(x *Node) *Node &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> t.NIL</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get the minimum from the right sub-tree if it existed.</span></span><br><span class="line">	<span class="keyword">if</span> x.Right != t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> t.min(x.Right)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	y := x.Parent</span><br><span class="line">	<span class="keyword">for</span> y != t.NIL &amp;&amp; x == y.Right &#123;</span><br><span class="line">		x = y</span><br><span class="line">		y = y.Parent</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span> Need Document</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> <span class="built_in">delete</span>(key *Node) *Node &#123;</span><br><span class="line">	z := t.search(key)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> z == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> t.NIL</span><br><span class="line">	&#125;</span><br><span class="line">	ret := &amp;Node&#123;t.NIL, t.NIL, t.NIL, z.Color, z.Item&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> y *Node</span><br><span class="line">	<span class="keyword">var</span> x *Node</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> z.Left == t.NIL || z.Right == t.NIL &#123;</span><br><span class="line">		y = z</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		y = t.successor(z)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> y.Left != t.NIL &#123;</span><br><span class="line">		x = y.Left</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		x = y.Right</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Even if x is NIL, we do the assign. In that case all the NIL nodes will</span></span><br><span class="line">	<span class="comment">// change from &#123;nil, nil, nil, BLACK, nil&#125; to &#123;nil, nil, ADDR, BLACK, nil&#125;,</span></span><br><span class="line">	<span class="comment">// but do not worry about that because it will not affect the compare</span></span><br><span class="line">	<span class="comment">// between Node-X with Node-NIL</span></span><br><span class="line">	x.Parent = y.Parent</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> y.Parent == t.NIL &#123;</span><br><span class="line">		t.root = x</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> y == y.Parent.Left &#123;</span><br><span class="line">		y.Parent.Left = x</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		y.Parent.Right = x</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> y != z &#123;</span><br><span class="line">		z.Item = y.Item</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> y.Color == BLACK &#123;</span><br><span class="line">		t.deleteFixup(x)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	t.count--</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> deleteFixup(x *Node) &#123;</span><br><span class="line">	<span class="keyword">for</span> x != t.root &amp;&amp; x.Color == BLACK &#123;</span><br><span class="line">		<span class="keyword">if</span> x == x.Parent.Left &#123;</span><br><span class="line">			w := x.Parent.Right</span><br><span class="line">			<span class="keyword">if</span> w.Color == RED &#123;</span><br><span class="line">				w.Color = BLACK</span><br><span class="line">				x.Parent.Color = RED</span><br><span class="line">				t.leftRotate(x.Parent)</span><br><span class="line">				w = x.Parent.Right</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> w.Left.Color == BLACK &amp;&amp; w.Right.Color == BLACK &#123;</span><br><span class="line">				w.Color = RED</span><br><span class="line">				x = x.Parent</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> w.Right.Color == BLACK &#123;</span><br><span class="line">					w.Left.Color = BLACK</span><br><span class="line">					w.Color = RED</span><br><span class="line">					t.rightRotate(w)</span><br><span class="line">					w = x.Parent.Right</span><br><span class="line">				&#125;</span><br><span class="line">				w.Color = x.Parent.Color</span><br><span class="line">				x.Parent.Color = BLACK</span><br><span class="line">				w.Right.Color = BLACK</span><br><span class="line">				t.leftRotate(x.Parent)</span><br><span class="line">				<span class="comment">// this is to exit while loop</span></span><br><span class="line">				x = t.root</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// the code below is has left and right switched from above</span></span><br><span class="line">			w := x.Parent.Left</span><br><span class="line">			<span class="keyword">if</span> w.Color == RED &#123;</span><br><span class="line">				w.Color = BLACK</span><br><span class="line">				x.Parent.Color = RED</span><br><span class="line">				t.rightRotate(x.Parent)</span><br><span class="line">				w = x.Parent.Left</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> w.Left.Color == BLACK &amp;&amp; w.Right.Color == BLACK &#123;</span><br><span class="line">				w.Color = RED</span><br><span class="line">				x = x.Parent</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> w.Left.Color == BLACK &#123;</span><br><span class="line">					w.Right.Color = BLACK</span><br><span class="line">					w.Color = RED</span><br><span class="line">					t.leftRotate(w)</span><br><span class="line">					w = x.Parent.Left</span><br><span class="line">				&#125;</span><br><span class="line">				w.Color = x.Parent.Color</span><br><span class="line">				x.Parent.Color = BLACK</span><br><span class="line">				w.Left.Color = BLACK</span><br><span class="line">				t.rightRotate(x.Parent)</span><br><span class="line">				x = t.root</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	x.Color = BLACK</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This file contains most of the methods that can be used</span></span><br><span class="line"><span class="comment">// by the user. Anyone who wants to look for some API about</span></span><br><span class="line"><span class="comment">// the rbtree, this is the right place.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Number of nodes in the tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Len() <span class="type">uint</span> &#123; <span class="keyword">return</span> t.count &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Insert(item Item) &#123;</span><br><span class="line">	<span class="keyword">if</span> item == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Always insert a RED node</span></span><br><span class="line">	t.insert(&amp;Node&#123;t.NIL, t.NIL, t.NIL, RED, item&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//InsertOrGet inserts or retrieves the item in the tree. If the</span></span><br><span class="line"><span class="comment">//item is already in the tree then the return value will be that.</span></span><br><span class="line"><span class="comment">//If the item is not in the tree the return value will be the item</span></span><br><span class="line"><span class="comment">//you put in.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> InsertOrGet(item Item) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> item == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.insert(&amp;Node&#123;t.NIL, t.NIL, t.NIL, RED, item&#125;).Item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Delete(item Item) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> item == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The `color` field here is nobody</span></span><br><span class="line">	<span class="keyword">return</span> t.<span class="built_in">delete</span>(&amp;Node&#123;t.NIL, t.NIL, t.NIL, RED, item&#125;).Item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Get(item Item) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> item == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The `color` field here is nobody</span></span><br><span class="line">	ret := t.search(&amp;Node&#123;t.NIL, t.NIL, t.NIL, RED, item&#125;)</span><br><span class="line">	<span class="keyword">if</span> ret == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret.Item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//<span class="doctag">TODO:</span> This is for debug, delete it in the future</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Search(item Item) *Node &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.search(&amp;Node&#123;t.NIL, t.NIL, t.NIL, RED, item&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Min() Item &#123;</span><br><span class="line">	x := t.min(t.root)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x.Item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Max() Item &#123;</span><br><span class="line">	x := t.max(t.root)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x.Item</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Iterator <span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Ascend will call iterator once for each element greater or equal than pivot</span></span><br><span class="line"><span class="comment">// in ascending order. It will stop whenever the iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Ascend(pivot Item, iterator Iterator) &#123;</span><br><span class="line">	t.ascend(t.root, pivot, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> ascend(x *Node, pivot Item, iterator Iterator) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !less(x.Item, pivot) &#123;</span><br><span class="line">		<span class="keyword">if</span> !t.ascend(x.Left, pivot, iterator) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !iterator(x.Item) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.ascend(x.Right, pivot, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Descend will call iterator once for each element less or equal than pivot</span></span><br><span class="line"><span class="comment">// in descending order. It will stop whenever the iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> Descend(pivot Item, iterator Iterator) &#123;</span><br><span class="line">	t.descend(t.root, pivot, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> descend(x *Node, pivot Item, iterator Iterator) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !less(pivot, x.Item) &#123;</span><br><span class="line">		<span class="keyword">if</span> !t.descend(x.Right, pivot, iterator) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !iterator(x.Item) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.descend(x.Left, pivot, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AscendRange will call iterator once for elements greater or equal than @ge</span></span><br><span class="line"><span class="comment">// and less than @lt, which means the range would be [ge, lt).</span></span><br><span class="line"><span class="comment">// It will stop whenever the iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> AscendRange(ge, lt Item, iterator Iterator) &#123;</span><br><span class="line">	t.ascendRange(t.root, ge, lt, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Rbtree)</span></span> ascendRange(x *Node, inf, sup Item, iterator Iterator) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> x == t.NIL &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !less(x.Item, sup) &#123;</span><br><span class="line">		<span class="keyword">return</span> t.ascendRange(x.Left, inf, sup, iterator)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> less(x.Item, inf) &#123;</span><br><span class="line">		<span class="keyword">return</span> t.ascendRange(x.Right, inf, sup, iterator)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !t.ascendRange(x.Left, inf, sup, iterator) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !iterator(x.Item) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t.ascendRange(x.Right, inf, sup, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> testStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">	id   <span class="type">int</span></span><br><span class="line">	text <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ts *testStruct)</span></span> Less(than Item) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> ts.id &lt; than.(*testStruct).id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Int implements the Item interface for integers.</span></span><br><span class="line"><span class="keyword">type</span> Int <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Less returns true if int(a) &lt; int(b).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a Int)</span></span> Less(b Item) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a &lt; b.(Int)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rbTree := New()</span><br><span class="line">	items := []*testStruct&#123;</span><br><span class="line">		&#123;<span class="number">1</span>, <span class="string">&quot;this&quot;</span>&#125;,</span><br><span class="line">		&#123;<span class="number">2</span>, <span class="string">&quot;is&quot;</span>&#125;,</span><br><span class="line">		&#123;<span class="number">3</span>, <span class="string">&quot;a&quot;</span>&#125;,</span><br><span class="line">		&#123;<span class="number">4</span>, <span class="string">&quot;test&quot;</span>&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> items &#123;</span><br><span class="line">		rbTree.Insert(items[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	rbTree.Descend(items[<span class="number">2</span>], <span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	newItem := &amp;testStruct&#123;items[<span class="number">0</span>].id, <span class="string">&quot;not&quot;</span>&#125;</span><br><span class="line">	newItem = rbTree.InsertOrGet(newItem).(*testStruct)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> newItem.text != items[<span class="number">0</span>].text &#123;</span><br><span class="line">		fmt.Println(fmt.Errorf(<span class="string">&quot;tree.InsertOrGet = &#123;id: %d, text: %s&#125;, expect &#123;id %d, text %s&#125;&quot;</span>, newItem.id, newItem.text, items[<span class="number">0</span>].id, items[<span class="number">0</span>].text))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	newItem = &amp;testStruct&#123;<span class="number">5</span>, <span class="string">&quot;new&quot;</span>&#125;</span><br><span class="line">	newItem = rbTree.InsertOrGet(newItem).(*testStruct)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> newItem.text != <span class="string">&quot;new&quot;</span> &#123;</span><br><span class="line">		fmt.Println(fmt.Errorf(<span class="string">&quot;tree.InsertOrGet = &#123;id: %d, text: %s&#125;, expect &#123;id %d, text %s&#125;&quot;</span>, newItem.id, newItem.text, <span class="number">5</span>, <span class="string">&quot;new&quot;</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="9-4-Trieå­—å…¸æ ‘"><a href="#9-4-Trieå­—å…¸æ ‘" class="headerlink" title="9.4 Trieå­—å…¸æ ‘"></a>9.4 Trieå­—å…¸æ ‘</h2><p>å­—å…¸æ ‘ï¼ˆTrieï¼‰æ˜¯ä¸€ç§å¾ˆç‰¹åˆ«çš„æ ‘çŠ¶ä¿¡æ¯æ£€ç´¢æ•°æ®ç»“æ„ï¼Œå¦‚åŒå…¶åï¼Œå®ƒçš„æ„æˆå°±åƒä¸€æœ¬å­—å…¸ï¼Œå¯ä»¥è®©ä½ å¿«é€Ÿçš„è¿›è¡Œå­—ç¬¦æ’å…¥ã€å­—ç¬¦ä¸²æœç´¢ç­‰ã€‚ </p>
<p>å­—å…¸æ ‘è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œæ‰€ä»¥æ•°æ®ç»“æ„æœ¬èº«æ¯”è¾ƒæ¶ˆè€—ç©ºé—´ã€‚ä½†å®ƒåˆ©ç”¨äº†å­—ç¬¦ä¸²çš„<strong>å…±åŒå‰ç¼€ï¼ˆCommon Prefixï¼‰</strong>ä½œä¸ºå­˜å‚¨ä¾æ®ï¼Œä»¥æ­¤æ¥èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå¹¶åŠ é€Ÿæœç´¢æ—¶é—´ã€‚Trie çš„å­—ç¬¦ä¸²æœç´¢æ—¶é—´å¤æ‚åº¦ä¸º **O(m)**ï¼Œm ä¸ºæœ€é•¿çš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå…¶æŸ¥è¯¢æ€§èƒ½ä¸é›†åˆä¸­çš„å­—ç¬¦ä¸²çš„æ•°é‡æ— å…³ã€‚å…¶åœ¨æœç´¢å­—ç¬¦ä¸²æ—¶è¡¨ç°å‡ºçš„é«˜æ•ˆï¼Œä½¿å¾—ç‰¹åˆ«é€‚ç”¨äºæ„å»ºæ–‡æœ¬æœç´¢å’Œè¯é¢‘ç»Ÿè®¡ç­‰åº”ç”¨ã€‚ </p>
<p><strong>mapå®ç°</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—å…¸æ ‘(å‰ç¼€æ ‘)</span></span><br><span class="line"><span class="keyword">type</span> trieNode <span class="keyword">struct</span> &#123;</span><br><span class="line">	isWord <span class="type">bool</span>  <span class="comment">// æ˜¯å¦æ˜¯å•è¯ç»“å°¾</span></span><br><span class="line">	next   <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*trieNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> trie <span class="keyword">struct</span> &#123;</span><br><span class="line">	size <span class="type">int</span>  <span class="comment">// èŠ‚ç‚¹æ•°é‡</span></span><br><span class="line">	root *trieNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewTrie</span><span class="params">()</span></span> *trie &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;trie&#123;</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		&amp;trieNode&#123;<span class="literal">false</span>, <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*trieNode)&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *trie)</span></span> GetSize() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> this.size</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éé€’å½’ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *trie)</span></span> Add(word <span class="type">string</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cur := this.root</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> word &#123;</span><br><span class="line">		_, ok := cur.next[v] <span class="comment">// åœ¨NewTrieä¸­å·²ç»åˆå§‹åŒ–ï¼Œèƒ½ç›´æ¥ç”¨</span></span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			cur.next[v] = &amp;trieNode&#123;<span class="literal">false</span>, <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*trieNode&#123;&#125;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cur = cur.next[v]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// åˆ¤æ–­è¯¥å•è¯ä¹‹å‰æ˜¯å¦å·²ç»æ·»åŠ åˆ°treeä¸­äº†</span></span><br><span class="line">	<span class="keyword">if</span> !cur.isWord &#123;</span><br><span class="line">		cur.isWord = <span class="literal">true</span></span><br><span class="line">		this.size++</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *trie)</span></span> Add2(word <span class="type">string</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	cur := this.root</span><br><span class="line">	this.size = this.size + cur.insert(word)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©å®Œæˆé€’å½’å‡½æ•°:åœ¨nodeèŠ‚ç‚¹ä¸­æ’å…¥word,å¦‚æœæ˜¯å·²ç»å­˜åœ¨çš„å•è¯,è¿”å›0,å¦‚æœä¸å­˜åœ¨è¿”å›1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(node *trieNode)</span></span> insert(word <span class="type">string</span>) <span class="type">int</span> &#123;</span><br><span class="line">	_, ok := node.next[<span class="type">rune</span>(word[<span class="number">0</span>])]</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		node.next[<span class="type">rune</span>(word[<span class="number">0</span>])] = &amp;trieNode&#123;<span class="literal">false</span>,</span><br><span class="line">			<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*trieNode&#123;&#125;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	node = node.next[<span class="type">rune</span>(word[<span class="number">0</span>])]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> !node.isWord &#123;</span><br><span class="line">			node.isWord = <span class="literal">true</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> node.insert(word[<span class="number">1</span>:])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢æ˜¯å¦åŒ…å«æŸä¸ªå•è¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *trie)</span></span> Contains(word <span class="type">string</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cur := this.root</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> word &#123;</span><br><span class="line">		t1, ok := cur.next[v]</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		cur = t1</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> cur.isWord</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰ç¼€æ˜¯å¦æœ‰ä»¥prefixä¸ºå‰ç¼€çš„å•è¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *trie)</span></span> IsPrefix(word <span class="type">string</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cur := this.root</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> word &#123;</span><br><span class="line">		t1, ok := cur.next[v]</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		cur = t1</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	trie := NewTrie()</span><br><span class="line">	trie.Add(<span class="string">&quot;aå‚²æ…¢&quot;</span>)</span><br><span class="line">	trie.Add(<span class="string">&quot;å‚²æ…¢&quot;</span>)</span><br><span class="line">	trie.Add2(<span class="string">&quot;ff&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;ä¸€å…±&quot;</span>,trie.GetSize(),<span class="string">&quot;ä¸ªå•è¯&quot;</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(trie.Contains(<span class="string">&quot;aå‚²æ…¢&quot;</span>))</span><br><span class="line">	fmt.Println(trie.Contains(<span class="string">&quot;å‚²æ…¢&quot;</span>))</span><br><span class="line">	fmt.Println(trie.Contains(<span class="string">&quot;ff&quot;</span>))</span><br><span class="line"></span><br><span class="line">	fmt.Println(trie.IsPrefix(<span class="string">&quot;å‚²&quot;</span>))</span><br><span class="line">	fmt.Println(trie.IsPrefix(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">	fmt.Println(trie.IsPrefix(<span class="string">&quot;f&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="9-5-çº¿æ®µæ ‘"><a href="#9-5-çº¿æ®µæ ‘" class="headerlink" title="9.5 çº¿æ®µæ ‘"></a>9.5 çº¿æ®µæ ‘</h2><p><strong>çº¿æ®µæ ‘ï¼ˆsegment treeï¼‰</strong>ï¼Œé¡¾åæ€ä¹‰ï¼Œ æ˜¯ç”¨æ¥å­˜æ”¾ç»™å®šåŒºé—´ï¼ˆsegment, or intervalï¼‰å†…å¯¹åº”ä¿¡æ¯çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ä¸æ ‘çŠ¶æ•°ç»„ï¼ˆbinary indexed treeï¼‰ç›¸ä¼¼ï¼Œçº¿æ®µæ ‘ä¹Ÿç”¨æ¥å¤„ç†æ•°ç»„ç›¸åº”çš„<strong>åŒºé—´æŸ¥è¯¢ï¼ˆrange queryï¼‰</strong>å’Œ<strong>å…ƒç´ æ›´æ–°ï¼ˆupdateï¼‰</strong>æ“ä½œã€‚ä¸æ ‘çŠ¶æ•°ç»„ä¸åŒçš„æ˜¯ï¼Œçº¿æ®µæ ‘ä¸æ­¢å¯ä»¥é€‚ç”¨äºåŒºé—´æ±‚å’Œçš„æŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ<strong>åŒºé—´æœ€å¤§å€¼ï¼ŒåŒºé—´æœ€å°å€¼ï¼ˆRange Minimum&#x2F;Maximum Query problemï¼‰æˆ–è€…åŒºé—´å¼‚æˆ–å€¼</strong>çš„æŸ¥è¯¢ã€‚</p>
<p>å¯¹åº”äºæ ‘çŠ¶æ•°ç»„ï¼Œçº¿æ®µæ ‘è¿›è¡Œæ›´æ–°ï¼ˆupdateï¼‰çš„æ“ä½œä¸ºO(logn)ï¼Œè¿›è¡ŒåŒºé—´æŸ¥è¯¢ï¼ˆrange queryï¼‰çš„æ“ä½œä¹Ÿä¸ºO(logn)ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>çº¿æ®µæ ‘ä¸æ˜¯å®Œå…¨äºŒå‰æ ‘</li>
<li>çº¿æ®µæ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘</li>
<li>å †ï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼‰ä¹Ÿæ˜¯å¹³è¡¡äºŒå‰æ ‘</li>
<li>äºŒåˆ†æœç´¢æ ‘ä¸ä¸€å®šæ˜¯å¹³è¡¡äºŒå‰æ ‘</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sort&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	<span class="comment">// Inf is defined as the max value of an integer, used as +âˆ</span></span><br><span class="line">	Inf = <span class="type">int</span>(^<span class="type">uint</span>(<span class="number">0</span>) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">	<span class="comment">// NegInf is defined as the min value of an integer, used as -âˆ</span></span><br><span class="line">	NegInf = -Inf - <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> interval <span class="keyword">struct</span> &#123;</span><br><span class="line">	segment</span><br><span class="line">	element <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> segment <span class="keyword">struct</span> &#123;</span><br><span class="line">	from <span class="type">int</span></span><br><span class="line">	to   <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> node <span class="keyword">struct</span> &#123;</span><br><span class="line">	segment     segment</span><br><span class="line">	left, right *node</span><br><span class="line">	intervals   []*interval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Tree <span class="keyword">struct</span> &#123;</span><br><span class="line">	base     []interval</span><br><span class="line">	elements <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="keyword">struct</span>&#123;&#125;</span><br><span class="line">	root     *node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Push pushes an interval to the interval stack</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> Push(from, to <span class="type">int</span>, element <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	<span class="keyword">if</span> to &lt; from &#123;</span><br><span class="line">		from, to = to, from</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> t.elements == <span class="literal">nil</span> &#123;</span><br><span class="line">		t.elements = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	t.elements[element] = <span class="keyword">struct</span>&#123;&#125;&#123;&#125;</span><br><span class="line">	t.base = <span class="built_in">append</span>(t.base, interval&#123;segment&#123;from, to&#125;, element&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Clear clears the interval stack</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> Clear() &#123;</span><br><span class="line">	t.root = <span class="literal">nil</span></span><br><span class="line">	t.base = <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuildTree builds the segment tree from the interval stack</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> BuildTree() <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(t.base) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;No intervals in stack. Push intervals on the stack of the tree first.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	leaves := elementaryIntervals(t.endpoints())</span><br><span class="line">	t.root = t.insertNodes(leaves)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> t.base &#123;</span><br><span class="line">		t.root.insertInterval(&amp;t.base[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Print prints a binary tree recursively to sdout</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> Print() &#123;</span><br><span class="line">	endpoints := <span class="built_in">len</span>(t.base)*<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">	leaves := endpoints*<span class="number">2</span> - <span class="number">3</span></span><br><span class="line">	height := <span class="number">1</span> + log2(leaves)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;Height:&quot;</span>, height, <span class="string">&quot;, leaves:&quot;</span>, leaves)</span><br><span class="line">	levels := <span class="built_in">make</span>([][]*node, height+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	traverse(t.root, <span class="number">0</span>, <span class="function"><span class="keyword">func</span><span class="params">(n *node, depth <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		levels[depth] = <span class="built_in">append</span>(levels[depth], n)</span><br><span class="line">	&#125;, <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, level := <span class="keyword">range</span> levels &#123;</span><br><span class="line">		<span class="keyword">for</span> j, n := <span class="keyword">range</span> level &#123;</span><br><span class="line">			space(<span class="number">12</span> * (<span class="built_in">len</span>(levels) - <span class="number">1</span> - i))</span><br><span class="line">			n.<span class="built_in">print</span>()</span><br><span class="line">			space(<span class="number">1</span> * (height - i))</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> j<span class="number">-1</span>%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">				space(<span class="number">2</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Removes duplicate entries from a sorted slice</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removedups</span><span class="params">(sorted []<span class="type">int</span>)</span></span> (unique []<span class="type">int</span>) &#123;</span><br><span class="line">	unique = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, <span class="built_in">len</span>(sorted))</span><br><span class="line">	unique = <span class="built_in">append</span>(unique, sorted[<span class="number">0</span>])</span><br><span class="line">	prev := sorted[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _, val := <span class="keyword">range</span> sorted[<span class="number">1</span>:] &#123;</span><br><span class="line">		<span class="keyword">if</span> val != prev &#123;</span><br><span class="line">			unique = <span class="built_in">append</span>(unique, val)</span><br><span class="line">			prev = val</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a sorted slice of unique endpoints from a tree&#x27;s base</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> endpoints() []<span class="type">int</span> &#123;</span><br><span class="line">	baseLen := <span class="built_in">len</span>(t.base)</span><br><span class="line">	endpoints := <span class="built_in">make</span>([]<span class="type">int</span>, baseLen*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// When there are a lot of intervals, there is a big chance of big overlaps</span></span><br><span class="line">	<span class="comment">// Try to have the endpoints sorted as much as possible when putting them</span></span><br><span class="line">	<span class="comment">// in the slice to reduce the final sort time.</span></span><br><span class="line">	<span class="comment">// endpoints[0] = NegInf</span></span><br><span class="line">	<span class="keyword">for</span> i, interval := <span class="keyword">range</span> t.base &#123;</span><br><span class="line">		endpoints[i] = interval.from</span><br><span class="line">		endpoints[i+baseLen] = interval.to</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// endpoints[baseLen*2+1] = Inf</span></span><br><span class="line"></span><br><span class="line">	sort.Sort(sort.IntSlice(endpoints))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> removedups(endpoints)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a slice of elementary intervals from a slice of (sorted) endpoints</span></span><br><span class="line"><span class="comment">// Input: [p1, p2, ..., pn]</span></span><br><span class="line"><span class="comment">// Output: [&#123;p1 : p1&#125;, &#123;p1 : p2&#125;, &#123;p2 : p2&#125;,... , &#123;pn : pn&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">elementaryIntervals</span><span class="params">(endpoints []<span class="type">int</span>)</span></span> []segment &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(endpoints) == <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> []segment&#123;segment&#123;endpoints[<span class="number">0</span>], endpoints[<span class="number">0</span>]&#125;&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	intervals := <span class="built_in">make</span>([]segment, <span class="built_in">len</span>(endpoints)*<span class="number">2</span><span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(endpoints); i++ &#123;</span><br><span class="line">		intervals[i*<span class="number">2</span>] = segment&#123;endpoints[i], endpoints[i]&#125;</span><br><span class="line">		<span class="keyword">if</span> i &lt; <span class="built_in">len</span>(endpoints)<span class="number">-1</span> &#123;</span><br><span class="line">			intervals[i*<span class="number">2</span>+<span class="number">1</span>] = segment&#123;endpoints[i], endpoints[i+<span class="number">1</span>]&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> intervals</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// insertNodes builds the tree structure from the elementary intervals</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> insertNodes(leaves []segment) *node &#123;</span><br><span class="line">	<span class="keyword">var</span> n *node</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(leaves) == <span class="number">1</span> &#123;</span><br><span class="line">		n = &amp;node&#123;segment: leaves[<span class="number">0</span>]&#125;</span><br><span class="line">		n.left = <span class="literal">nil</span></span><br><span class="line">		n.right = <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		n = &amp;node&#123;segment: segment&#123;leaves[<span class="number">0</span>].from, leaves[<span class="built_in">len</span>(leaves)<span class="number">-1</span>].to&#125;&#125;</span><br><span class="line">		center := <span class="built_in">len</span>(leaves) / <span class="number">2</span></span><br><span class="line">		n.left = t.insertNodes(leaves[:center])</span><br><span class="line">		n.right = t.insertNodes(leaves[center:])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *segment)</span></span> subsetOf(other *segment) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> other.from &lt;= s.from &amp;&amp; other.to &gt;= s.to</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *segment)</span></span> intersectsWith(other *segment) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> other.from &lt;= s.to &amp;&amp; s.from &lt;= other.to ||</span><br><span class="line">		s.from &lt;= other.to &amp;&amp; other.from &lt;= s.to</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inserts interval into given tree structure</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> insertInterval(i *interval) &#123;</span><br><span class="line">	<span class="keyword">if</span> n.segment.subsetOf(&amp;i.segment) &#123;</span><br><span class="line">		<span class="keyword">if</span> n.intervals == <span class="literal">nil</span> &#123;</span><br><span class="line">			n.intervals = <span class="built_in">make</span>([]*interval, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		n.intervals = <span class="built_in">append</span>(n.intervals, i)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> n.left != <span class="literal">nil</span> &amp;&amp; n.left.segment.intersectsWith(&amp;i.segment) &#123;</span><br><span class="line">			n.left.insertInterval(i)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> n.right != <span class="literal">nil</span> &amp;&amp; n.right.segment.intersectsWith(&amp;i.segment) &#123;</span><br><span class="line">			n.right.insertInterval(i)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> <span class="built_in">print</span>() &#123;</span><br><span class="line">	from := fmt.Sprintf(<span class="string">&quot;%d&quot;</span>, n.segment.from)</span><br><span class="line">	<span class="keyword">switch</span> n.segment.from &#123;</span><br><span class="line">	<span class="keyword">case</span> Inf:</span><br><span class="line">		from = <span class="string">&quot;+âˆ&quot;</span></span><br><span class="line">	<span class="keyword">case</span> NegInf:</span><br><span class="line">		from = <span class="string">&quot;-âˆ&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">	to := fmt.Sprintf(<span class="string">&quot;%d&quot;</span>, n.segment.to)</span><br><span class="line">	<span class="keyword">switch</span> n.segment.to &#123;</span><br><span class="line">	<span class="keyword">case</span> Inf:</span><br><span class="line">		to = <span class="string">&quot;Inf&quot;</span></span><br><span class="line">	<span class="keyword">case</span> NegInf:</span><br><span class="line">		to = <span class="string">&quot;NegInf&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;(%s,%s)&quot;</span>, from, to)</span><br><span class="line">	<span class="keyword">if</span> n.intervals != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Print(<span class="string">&quot;-&gt;[&quot;</span>)</span><br><span class="line">		<span class="keyword">for</span> _, intrvl := <span class="keyword">range</span> n.intervals &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;(%v,%v)=[%v]&quot;</span>, intrvl.from, intrvl.to, intrvl.element)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Print(<span class="string">&quot;]&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// QueryIndex looks for all segments in the interval tree that contain</span></span><br><span class="line"><span class="comment">// a given index. The elements associated with the segments will be sent</span></span><br><span class="line"><span class="comment">// on the returned channel. No element will be sent twice.</span></span><br><span class="line"><span class="comment">// The elements will not be sent in any specific order.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Tree)</span></span> QueryIndex(index <span class="type">int</span>) (&lt;-<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;Tree is empty. Build the tree first&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	intervals := <span class="built_in">make</span>(<span class="keyword">chan</span> *interval)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(t *Tree, index <span class="type">int</span>, intervals <span class="keyword">chan</span> *interval)</span></span> &#123;</span><br><span class="line">		query(t.root, index, intervals)</span><br><span class="line">		<span class="built_in">close</span>(intervals)</span><br><span class="line">	&#125;(t, index, intervals)</span><br><span class="line"></span><br><span class="line">	elements := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(intervals <span class="keyword">chan</span> *interval, elements <span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">		<span class="keyword">defer</span> <span class="built_in">close</span>(elements)</span><br><span class="line">		results := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line">		<span class="keyword">for</span> interval := <span class="keyword">range</span> intervals &#123;</span><br><span class="line">			_, alreadyFound := results[interval.element]</span><br><span class="line">			<span class="keyword">if</span> !alreadyFound &#123;</span><br><span class="line">				<span class="comment">// Store an empty struct in the map to minimize memory footprint</span></span><br><span class="line">				results[interval.element] = <span class="keyword">struct</span>&#123;&#125;&#123;&#125;</span><br><span class="line">				elements &lt;- interval.element</span><br><span class="line">				<span class="keyword">if</span> <span class="built_in">len</span>(results) &gt;= <span class="built_in">len</span>(t.elements) &#123;</span><br><span class="line">					<span class="comment">// found all elements that can be found</span></span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;(intervals, elements)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> elements, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s segment)</span></span> contains(index <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> s.from &lt;= index &amp;&amp; index &lt;= s.to</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">query</span><span class="params">(node *node, index <span class="type">int</span>, results <span class="keyword">chan</span>&lt;- *interval)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> node.segment.contains(index) &#123;</span><br><span class="line">		<span class="keyword">for</span> _, interval := <span class="keyword">range</span> node.intervals &#123;</span><br><span class="line">			results &lt;- interval</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> node.left != <span class="literal">nil</span> &#123;</span><br><span class="line">			query(node.left, index, results)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> node.right != <span class="literal">nil</span> &#123;</span><br><span class="line">			query(node.right, index, results)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Traverse tree recursively call enter when entering node, resp. leave</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">traverse</span><span class="params">(node *node, depth <span class="type">int</span>, enter, leave <span class="keyword">func</span>(*node, <span class="type">int</span>)</span></span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> enter != <span class="literal">nil</span> &#123;</span><br><span class="line">		enter(node, depth)</span><br><span class="line">	&#125;</span><br><span class="line">	traverse(node.left, depth+<span class="number">1</span>, enter, leave)</span><br><span class="line">	traverse(node.right, depth+<span class="number">1</span>, enter, leave)</span><br><span class="line">	<span class="keyword">if</span> leave != <span class="literal">nil</span> &#123;</span><br><span class="line">		leave(node, depth)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Returs log with base 2 of an int.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">log2</span><span class="params">(num <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> num == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> NegInf</span><br><span class="line">	&#125;</span><br><span class="line">	i := <span class="number">-1</span></span><br><span class="line">	<span class="keyword">for</span> num &gt; <span class="number">0</span> &#123;</span><br><span class="line">		num = num &gt;&gt; <span class="number">1</span></span><br><span class="line">		i++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">space</span><span class="params">(n <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		fmt.Print(<span class="string">&quot; &quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">10</span>, <span class="string">&quot;hello, world&quot;</span>)</span><br><span class="line">	tree.Push(<span class="number">5</span>, <span class="number">6</span>, <span class="string">&quot;how are you today?&quot;</span>)</span><br><span class="line">	tree.Push(<span class="number">6</span>, <span class="number">45</span>, <span class="string">&quot;test&quot;</span>)</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	results,err := tree.QueryIndex(<span class="number">6</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	result := &lt;-results</span><br><span class="line">	fmt.Println(result)</span><br><span class="line"></span><br><span class="line">	tree.Print()</span><br><span class="line"></span><br><span class="line">	FindingSingleElement()</span><br><span class="line">	FindingElementSizeZeroRange()</span><br><span class="line">	FindingElementPseudoEndlessRange()</span><br><span class="line">	FindingMultipleElements()</span><br><span class="line">	FindingOverlappingElements()</span><br><span class="line">	OutOfRangeNotFound()</span><br><span class="line">	AddingReverseDirection()</span><br><span class="line">	FindingSameElementTwice()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingSingleElement</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">10</span>, test)</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">4</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result != test &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,test)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingElementSizeZeroRange</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">1</span>, test)</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result != test &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,test)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingElementPseudoEndlessRange</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">	tree.Push(<span class="number">1</span>, Inf, test)</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">9999</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result != test &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,test)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">find</span><span class="params">(element <span class="keyword">interface</span>&#123;&#125;, elements []<span class="keyword">interface</span>&#123;&#125;)</span></span> (<span class="type">bool</span>, <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">for</span> i, e := <span class="keyword">range</span> elements &#123;</span><br><span class="line">		<span class="keyword">if</span> element == e &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>, i</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>, <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingMultipleElements</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	tests := <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, <span class="number">5</span>)</span><br><span class="line">	tests[<span class="number">0</span>] = <span class="string">&quot;one&quot;</span></span><br><span class="line">	tests[<span class="number">1</span>] = <span class="string">&quot;two&quot;</span></span><br><span class="line">	tests[<span class="number">2</span>] = <span class="number">3.14</span></span><br><span class="line">	tests[<span class="number">3</span>] = <span class="number">4</span></span><br><span class="line">	tests[<span class="number">4</span>] = <span class="string">&quot;stuff&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, test := <span class="keyword">range</span> tests &#123;</span><br><span class="line">		tree.Push(<span class="number">10</span>+i, <span class="number">100</span>+i, test)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tree.BuildTree()</span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> result := <span class="keyword">range</span> results &#123;</span><br><span class="line">		found, index := find(result, tests)</span><br><span class="line">		<span class="keyword">if</span> !found &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;receivedUnexpected&quot;</span>,result)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Remove element from tests</span></span><br><span class="line">		tests[index], tests = tests[<span class="built_in">len</span>(tests)<span class="number">-1</span>], tests[:<span class="built_in">len</span>(tests)<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(tests) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> _, test := <span class="keyword">range</span> tests &#123;</span><br><span class="line">			fmt.Println(fmt.Errorf(<span class="string">&quot;Did not find %v\n&quot;</span>, test))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingOverlappingElements</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	tests := <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, <span class="number">2</span>)</span><br><span class="line">	tests[<span class="number">0</span>] = <span class="string">&quot;one&quot;</span></span><br><span class="line">	tests[<span class="number">1</span>] = <span class="string">&quot;two&quot;</span></span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">10</span>, tests[<span class="number">0</span>])</span><br><span class="line">	tree.Push(<span class="number">5</span>, <span class="number">15</span>, tests[<span class="number">1</span>])</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Index only in first range</span></span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">4</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line">	<span class="keyword">if</span> result != tests[<span class="number">0</span>] &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,tests[<span class="number">0</span>])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Index only in second range</span></span><br><span class="line">	results, err = tree.QueryIndex(<span class="number">11</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result = &lt;-results</span><br><span class="line">	<span class="keyword">if</span> result != tests[<span class="number">1</span>] &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,tests[<span class="number">1</span>])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Index in both ranges</span></span><br><span class="line">	results, err = tree.QueryIndex(<span class="number">6</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> result := <span class="keyword">range</span> results &#123;</span><br><span class="line">		found, index := find(result, tests)</span><br><span class="line">		<span class="keyword">if</span> !found &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;receivedUnexpected&quot;</span>,result)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Remove element from tests</span></span><br><span class="line">		tests[index], tests = tests[<span class="built_in">len</span>(tests)<span class="number">-1</span>], tests[:<span class="built_in">len</span>(tests)<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(tests) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> _, test := <span class="keyword">range</span> tests &#123;</span><br><span class="line">			fmt.Println(fmt.Errorf(<span class="string">&quot;Did not find %v\n&quot;</span>, test))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">OutOfRangeNotFound</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line"></span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">10</span>, test)</span><br><span class="line"></span><br><span class="line">	tree.BuildTree()</span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line"></span><br><span class="line">		fmt.Println(<span class="string">&quot;receivedUnexpected&quot;</span>,result)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddingReverseDirection</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">	tree.Push(<span class="number">10</span>, <span class="number">1</span>, test)</span><br><span class="line">	tree.BuildTree()</span><br><span class="line"></span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">4</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result != test &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,test)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindingSameElementTwice</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tree := <span class="built_in">new</span>(Tree)</span><br><span class="line">	test := <span class="string">&quot;hello, world&quot;</span></span><br><span class="line"></span><br><span class="line">	tree.Push(<span class="number">1</span>, <span class="number">10</span>, test)</span><br><span class="line">	tree.Push(<span class="number">5</span>, <span class="number">15</span>, test)</span><br><span class="line"></span><br><span class="line">	tree.BuildTree()</span><br><span class="line">	results, err := tree.QueryIndex(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;queryFailed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result := &lt;-results</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result != test &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;wrongElement&quot;</span>,result,test)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// `test` should only be sent once</span></span><br><span class="line">	<span class="keyword">if</span> _, ok := &lt;-results; ok != <span class="literal">false</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;toManyElements&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-6-å¹³è¡¡äºŒå‰æ ‘"><a href="#9-6-å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="9.6 å¹³è¡¡äºŒå‰æ ‘"></a>9.6 å¹³è¡¡äºŒå‰æ ‘</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AVL <span class="keyword">struct</span> &#123;</span><br><span class="line">	value <span class="type">int</span>      <span class="comment">//å€¼</span></span><br><span class="line">	height <span class="type">int</span>     <span class="comment">//æ·±åº¦</span></span><br><span class="line">	left *AVL      <span class="comment">//å·¦å­æ ‘</span></span><br><span class="line">	right *AVL     <span class="comment">//å³å­æ ‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> Search(value <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	compare := value - t.value</span><br><span class="line">	<span class="keyword">if</span> compare &lt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.left.Search(value)</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> compare &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.right.Search(value)</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> leftRotate() *AVL &#123;  <span class="comment">//å·¦æ—‹è½¬</span></span><br><span class="line">	headNode := t.right</span><br><span class="line">	t.right = headNode.left</span><br><span class="line">	headNode.left = t</span><br><span class="line">	<span class="comment">//æ›´æ–°ç»“ç‚¹é«˜åº¦</span></span><br><span class="line">	t.height = max(t.left.getHeight(),t.right.getHeight()) + <span class="number">1</span></span><br><span class="line">	headNode.height = max(headNode.left.getHeight(),headNode.right.getHeight()) + <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> headNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> rightRotate() *AVL &#123;  <span class="comment">//å³æ—‹è½¬</span></span><br><span class="line">	headNode := t.left</span><br><span class="line">	t.left = headNode.right</span><br><span class="line">	headNode.right = t</span><br><span class="line">	<span class="comment">//æ›´æ–°ç»“ç‚¹é«˜åº¦</span></span><br><span class="line">	t.height = max(t.left.getHeight(),t.right.getHeight()) +<span class="number">1</span></span><br><span class="line">	headNode.height = max(headNode.left.getHeight(),headNode.right.getHeight()) + <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> headNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> rightThenLeftRotate() *AVL &#123;  <span class="comment">//å³æ—‹è½¬,ä¹‹åå·¦æ—‹è½¬</span></span><br><span class="line">	<span class="comment">//ä»¥å¤±è¡¡ç‚¹å³ç»“ç‚¹å…ˆå³æ—‹è½¬</span></span><br><span class="line">	sonHeadNode := t.right.rightRotate()</span><br><span class="line">	t.right = sonHeadNode</span><br><span class="line">	<span class="comment">//å†ä»¥å¤±è¡¡ç‚¹å·¦æ—‹è½¬</span></span><br><span class="line">	<span class="keyword">return</span> t.leftRotate()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> LeftThenRightRotate() *AVL &#123;  <span class="comment">//å·¦æ—‹è½¬,ä¹‹åå³æ—‹è½¬</span></span><br><span class="line">	<span class="comment">//ä»¥å¤±è¡¡ç‚¹å·¦ç»“ç‚¹å…ˆå·¦æ—‹è½¬</span></span><br><span class="line">	sonHeadNode := t.left.leftRotate()</span><br><span class="line">	t.left = sonHeadNode</span><br><span class="line">	<span class="comment">//å†ä»¥å¤±è¡¡ç‚¹å·¦æ—‹è½¬</span></span><br><span class="line">	<span class="keyword">return</span> t.rightRotate()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> adjust() *AVL &#123;</span><br><span class="line">	<span class="keyword">if</span> t.right.getHeight() - t.left.getHeight() == <span class="number">2</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> t.right.right.getHeight() &gt; t.right.left.getHeight() &#123;</span><br><span class="line">			t = t.leftRotate()</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			t = t.rightThenLeftRotate()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> t.left.getHeight() - t.right.getHeight() == <span class="number">2</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> t.left.left.getHeight() &gt; t.left.right.getHeight() &#123;</span><br><span class="line">			t = t.rightRotate()</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			t = t.LeftThenRightRotate()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> Insert(value <span class="type">int</span>) *AVL &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		newNode := AVL&#123;value,<span class="number">1</span>,<span class="literal">nil</span>,<span class="literal">nil</span>&#125;</span><br><span class="line">		<span class="keyword">return</span> &amp;newNode</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> value &lt; t.value &#123;</span><br><span class="line">		t.left = t.left.Insert(value)</span><br><span class="line">		t = t.adjust()</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> value &gt; t.value&#123;</span><br><span class="line">		t.right = t.right.Insert(value)</span><br><span class="line">		t = t.adjust()</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;the node exit&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	t.height = max(t.left.getHeight(),t.right.getHeight()) + <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*åˆ é™¤å…ƒç´ </span></span><br><span class="line"><span class="comment">*1ã€å¦‚æœè¢«åˆ é™¤ç»“ç‚¹åªæœ‰ä¸€ä¸ªå­ç»“ç‚¹ï¼Œå°±ç›´æ¥å°†Açš„å­ç»“ç‚¹è¿è‡³Açš„çˆ¶ç»“ç‚¹ä¸Šï¼Œå¹¶å°†Aåˆ é™¤</span></span><br><span class="line"><span class="comment">*2ã€å¦‚æœè¢«åˆ é™¤ç»“ç‚¹æœ‰ä¸¤ä¸ªå­ç»“ç‚¹ï¼Œå°†è¯¥ç»“ç‚¹å³å­æ•°å†…çš„æœ€å°ç»“ç‚¹å–ä»£Aã€‚</span></span><br><span class="line"><span class="comment">*3ã€æŸ¥çœ‹æ˜¯å¦å¹³è¡¡,è¯¥è°ƒæ•´è°ƒæ•´</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> Delete(value <span class="type">int</span>) *AVL &#123;</span><br><span class="line">	<span class="keyword">if</span> t ==<span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t</span><br><span class="line">	&#125;</span><br><span class="line">	compare := value - t.value</span><br><span class="line">	<span class="keyword">if</span> compare &lt; <span class="number">0</span> &#123;</span><br><span class="line">		t.left = t.left.Delete(value)</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> compare &gt; <span class="number">0</span>&#123;</span><br><span class="line">		t.right = t.right.Delete(value)</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123; <span class="comment">//æ‰¾åˆ°ç»“ç‚¹,åˆ é™¤ç»“ç‚¹ï¼ˆï¼‰</span></span><br><span class="line">		<span class="keyword">if</span> t.left != <span class="literal">nil</span> &amp;&amp; t.right != <span class="literal">nil</span> &#123;</span><br><span class="line">			t.value = t.right.getMin()</span><br><span class="line">			t.right = t.right.Delete(t.value)</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> t.left !=<span class="literal">nil</span> &#123;</span><br><span class="line">			t = t.left</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;<span class="comment">//åªæœ‰ä¸€ä¸ªå³å­©å­æˆ–æ²¡å­©å­</span></span><br><span class="line">			t = t.right</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> t != <span class="literal">nil</span> &#123;</span><br><span class="line">		t.height = max(t.left.getHeight(),t.right.getHeight()) + <span class="number">1</span></span><br><span class="line">		t = t.adjust()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‰é¡ºåºè·å¾—æ ‘ä¸­å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getAll() []<span class="type">int</span> &#123;</span><br><span class="line">	values := []<span class="type">int</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">return</span> addValues(values,t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†ä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥åˆ‡ç‰‡ä¸­</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addValues</span><span class="params">(values []<span class="type">int</span>,t *AVL)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> t != <span class="literal">nil</span> &#123;</span><br><span class="line">		values = addValues(values,t.left)</span><br><span class="line">		values = <span class="built_in">append</span>(values,t.value)</span><br><span class="line">		fmt.Println(t.value,t.height)</span><br><span class="line">		values = addValues(values,t.right)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> values</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾å­æ ‘æœ€å°å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getMin() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> t.left == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.value</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.left.getMin()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾å­æ ‘æœ€å¤§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getMax() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> t.right == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.value</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.right.getMax()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾æœ€å°ç»“ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getMinNode() *AVL &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> t.left != <span class="literal">nil</span> &#123;</span><br><span class="line">			t = t.left</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾æœ€å¤§ç»“ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getMaxNode() *AVL &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> t.right != <span class="literal">nil</span> &#123;</span><br><span class="line">			t = t.right</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¾—åˆ°æ ‘é«˜</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *AVL)</span></span> getHeight() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a <span class="type">int</span>,b <span class="type">int</span>)</span></span> <span class="type">int</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">		<span class="keyword">return</span> a</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> b</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	bsTree := AVL&#123;<span class="number">100</span>,<span class="number">1</span>,<span class="literal">nil</span>,<span class="literal">nil</span>&#125;</span><br><span class="line">	newTree := bsTree.Insert(<span class="number">60</span>)</span><br><span class="line">	newTree = bsTree.Insert(<span class="number">120</span>)</span><br><span class="line">	newTree = bsTree.Insert(<span class="number">110</span>)</span><br><span class="line">	newTree = bsTree.Insert(<span class="number">130</span>)</span><br><span class="line">	newTree = bsTree.Insert(<span class="number">105</span>)</span><br><span class="line">	fmt.Println(newTree.getAll())</span><br><span class="line"></span><br><span class="line">	newTree.Delete(<span class="number">110</span>)</span><br><span class="line">	fmt.Println(newTree.getAll())</span><br><span class="line">	fmt.Println(newTree.Search(<span class="number">60</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-7-Bæ ‘-2-3-4æ ‘"><a href="#9-7-Bæ ‘-2-3-4æ ‘" class="headerlink" title="9.7 Bæ ‘(2-3-4æ ‘)"></a>9.7 Bæ ‘(2-3-4æ ‘)</h2><p>234æ ‘æ˜¯Bæ ‘çš„ç‰¹ä¾‹ã€‚Bæ ‘æ¯ä¸ªèŠ‚ç‚¹å«æœ‰å¾ˆå¤šä¸ªå­èŠ‚ç‚¹åŠæ•°æ®é¡¹ï¼Œæ¯ä¸ªæ•°æ®é¡¹æ”¾çš„æ˜¯ä¸€ä¸ªæ•°æ®å—ã€‚ 2-3-4æ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šåªèƒ½æœ‰4ä¸ªå­©å­ï¼Œé‚£å¦‚æœæ¯ä¸ªå­©å­æ•°å†å¤šä¸€äº›å‘¢ï¼Œè¿™å°±æ˜¯Bæ ‘ã€‚  </p>
<p>Bæ ‘åˆç§°B-æ ‘ï¼Œæ˜¯ä¸€ç§å¹³è¡¡çš„å¤šè·¯æŸ¥æ‰¾æ ‘ã€‚B-æ ‘çš„é˜¶æ˜¯æ‰€æœ‰ç»“ç‚¹çš„å­©å­ç»“ç‚¹æ ‘çš„æœ€å¤§å€¼ã€‚ä¸€æ£µmé˜¶B-æ ‘ï¼Œæˆ–ä¸ºç©ºæ ‘ï¼Œæˆ–ä¸ºæ»¡è¶³ä¸‹åˆ—ç‰¹æ€§çš„må‰æ ‘ï¼š </p>
<p><a target="_blank" rel="noopener" href="https://github.com/google/btree">https://github.com/google/btree</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;sort&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Item represents a single object in the tree.</span></span><br><span class="line"><span class="keyword">type</span> Item <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">// Less tests whether the current item is less than the given argument.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// This must provide a strict weak ordering.</span></span><br><span class="line">	<span class="comment">// If !a.Less(b) &amp;&amp; !b.Less(a), we treat this to mean a == b (i.e. we can only</span></span><br><span class="line">	<span class="comment">// hold one of either a or b in the tree).</span></span><br><span class="line">	Less(than Item) <span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	DefaultFreeListSize = <span class="number">32</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	nilItems    = <span class="built_in">make</span>(items, <span class="number">16</span>)</span><br><span class="line">	nilChildren = <span class="built_in">make</span>(children, <span class="number">16</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// FreeList represents a free list of btree nodes. By default each</span></span><br><span class="line"><span class="comment">// BTree has its own FreeList, but multiple BTrees can share the same</span></span><br><span class="line"><span class="comment">// FreeList.</span></span><br><span class="line"><span class="comment">// Two Btrees using the same freelist are safe for concurrent write access.</span></span><br><span class="line"><span class="keyword">type</span> FreeList <span class="keyword">struct</span> &#123;</span><br><span class="line">	mu       sync.Mutex</span><br><span class="line">	freelist []*node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewFreeList creates a new free list.</span></span><br><span class="line"><span class="comment">// size is the maximum size of the returned free list.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewFreeList</span><span class="params">(size <span class="type">int</span>)</span></span> *FreeList &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;FreeList&#123;freelist: <span class="built_in">make</span>([]*node, <span class="number">0</span>, size)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FreeList)</span></span> newNode() (n *node) &#123;</span><br><span class="line">	f.mu.Lock()</span><br><span class="line">	index := <span class="built_in">len</span>(f.freelist) - <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> index &lt; <span class="number">0</span> &#123;</span><br><span class="line">		f.mu.Unlock()</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">new</span>(node)</span><br><span class="line">	&#125;</span><br><span class="line">	n = f.freelist[index]</span><br><span class="line">	f.freelist[index] = <span class="literal">nil</span></span><br><span class="line">	f.freelist = f.freelist[:index]</span><br><span class="line">	f.mu.Unlock()</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// freeNode adds the given node to the list, returning true if it was added</span></span><br><span class="line"><span class="comment">// and false if it was discarded.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FreeList)</span></span> freeNode(n *node) (out <span class="type">bool</span>) &#123;</span><br><span class="line">	f.mu.Lock()</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(f.freelist) &lt; <span class="built_in">cap</span>(f.freelist) &#123;</span><br><span class="line">		f.freelist = <span class="built_in">append</span>(f.freelist, n)</span><br><span class="line">		out = <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	f.mu.Unlock()</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ItemIterator allows callers of Ascend* to iterate in-order over portions of</span></span><br><span class="line"><span class="comment">// the tree.  When this function returns false, iteration will stop and the</span></span><br><span class="line"><span class="comment">// associated Ascend* function will immediately return.</span></span><br><span class="line"><span class="keyword">type</span> ItemIterator <span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// New creates a new B-Tree with the given degree.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// New(2), for example, will create a 2-3-4 tree (each node contains 1-3 items</span></span><br><span class="line"><span class="comment">// and 2-4 children).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(degree <span class="type">int</span>)</span></span> *BTree &#123;</span><br><span class="line">	<span class="keyword">return</span> NewWithFreeList(degree, NewFreeList(DefaultFreeListSize))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewWithFreeList creates a new B-Tree that uses the given node free list.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewWithFreeList</span><span class="params">(degree <span class="type">int</span>, f *FreeList)</span></span> *BTree &#123;</span><br><span class="line">	<span class="keyword">if</span> degree &lt;= <span class="number">1</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;bad degree&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> &amp;BTree&#123;</span><br><span class="line">		degree: degree,</span><br><span class="line">		cow:    &amp;copyOnWriteContext&#123;freelist: f&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// items stores items in a node.</span></span><br><span class="line"><span class="keyword">type</span> items []Item</span><br><span class="line"></span><br><span class="line"><span class="comment">// insertAt inserts a value into the given index, pushing all subsequent values</span></span><br><span class="line"><span class="comment">// forward.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *items)</span></span> insertAt(index <span class="type">int</span>, item Item) &#123;</span><br><span class="line">	*s = <span class="built_in">append</span>(*s, <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">if</span> index &lt; <span class="built_in">len</span>(*s) &#123;</span><br><span class="line">		<span class="built_in">copy</span>((*s)[index+<span class="number">1</span>:], (*s)[index:])</span><br><span class="line">	&#125;</span><br><span class="line">	(*s)[index] = item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeAt removes a value at a given index, pulling all subsequent values</span></span><br><span class="line"><span class="comment">// back.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *items)</span></span> removeAt(index <span class="type">int</span>) Item &#123;</span><br><span class="line">	item := (*s)[index]</span><br><span class="line">	<span class="built_in">copy</span>((*s)[index:], (*s)[index+<span class="number">1</span>:])</span><br><span class="line">	(*s)[<span class="built_in">len</span>(*s)<span class="number">-1</span>] = <span class="literal">nil</span></span><br><span class="line">	*s = (*s)[:<span class="built_in">len</span>(*s)<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> item</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pop removes and returns the last element in the list.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *items)</span></span> pop() (out Item) &#123;</span><br><span class="line">	index := <span class="built_in">len</span>(*s) - <span class="number">1</span></span><br><span class="line">	out = (*s)[index]</span><br><span class="line">	(*s)[index] = <span class="literal">nil</span></span><br><span class="line">	*s = (*s)[:index]</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// truncate truncates this instance at index so that it contains only the</span></span><br><span class="line"><span class="comment">// first index items. index must be less than or equal to length.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *items)</span></span> truncate(index <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> toClear items</span><br><span class="line">	*s, toClear = (*s)[:index], (*s)[index:]</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(toClear) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		toClear = toClear[<span class="built_in">copy</span>(toClear, nilItems):]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// find returns the index where the given item should be inserted into this</span></span><br><span class="line"><span class="comment">// list.  &#x27;found&#x27; is true if the item already exists in the list at the given</span></span><br><span class="line"><span class="comment">// index.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s items)</span></span> find(item Item) (index <span class="type">int</span>, found <span class="type">bool</span>) &#123;</span><br><span class="line">	i := sort.Search(<span class="built_in">len</span>(s), <span class="function"><span class="keyword">func</span><span class="params">(i <span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> item.Less(s[i])</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> i &gt; <span class="number">0</span> &amp;&amp; !s[i<span class="number">-1</span>].Less(item) &#123;</span><br><span class="line">		<span class="keyword">return</span> i - <span class="number">1</span>, <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> i, <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// children stores child nodes in a node.</span></span><br><span class="line"><span class="keyword">type</span> children []*node</span><br><span class="line"></span><br><span class="line"><span class="comment">// insertAt inserts a value into the given index, pushing all subsequent values</span></span><br><span class="line"><span class="comment">// forward.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *children)</span></span> insertAt(index <span class="type">int</span>, n *node) &#123;</span><br><span class="line">	*s = <span class="built_in">append</span>(*s, <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">if</span> index &lt; <span class="built_in">len</span>(*s) &#123;</span><br><span class="line">		<span class="built_in">copy</span>((*s)[index+<span class="number">1</span>:], (*s)[index:])</span><br><span class="line">	&#125;</span><br><span class="line">	(*s)[index] = n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeAt removes a value at a given index, pulling all subsequent values</span></span><br><span class="line"><span class="comment">// back.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *children)</span></span> removeAt(index <span class="type">int</span>) *node &#123;</span><br><span class="line">	n := (*s)[index]</span><br><span class="line">	<span class="built_in">copy</span>((*s)[index:], (*s)[index+<span class="number">1</span>:])</span><br><span class="line">	(*s)[<span class="built_in">len</span>(*s)<span class="number">-1</span>] = <span class="literal">nil</span></span><br><span class="line">	*s = (*s)[:<span class="built_in">len</span>(*s)<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pop removes and returns the last element in the list.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *children)</span></span> pop() (out *node) &#123;</span><br><span class="line">	index := <span class="built_in">len</span>(*s) - <span class="number">1</span></span><br><span class="line">	out = (*s)[index]</span><br><span class="line">	(*s)[index] = <span class="literal">nil</span></span><br><span class="line">	*s = (*s)[:index]</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// truncate truncates this instance at index so that it contains only the</span></span><br><span class="line"><span class="comment">// first index children. index must be less than or equal to length.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *children)</span></span> truncate(index <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> toClear children</span><br><span class="line">	*s, toClear = (*s)[:index], (*s)[index:]</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(toClear) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		toClear = toClear[<span class="built_in">copy</span>(toClear, nilChildren):]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// node is an internal node in a tree.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// It must at all times maintain the invariant that either</span></span><br><span class="line"><span class="comment">//   * len(children) == 0, len(items) unconstrained</span></span><br><span class="line"><span class="comment">//   * len(children) == len(items) + 1</span></span><br><span class="line"><span class="keyword">type</span> node <span class="keyword">struct</span> &#123;</span><br><span class="line">	items    items</span><br><span class="line">	children children</span><br><span class="line">	cow      *copyOnWriteContext</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> mutableFor(cow *copyOnWriteContext) *node &#123;</span><br><span class="line">	<span class="keyword">if</span> n.cow == cow &#123;</span><br><span class="line">		<span class="keyword">return</span> n</span><br><span class="line">	&#125;</span><br><span class="line">	out := cow.newNode()</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">cap</span>(out.items) &gt;= <span class="built_in">len</span>(n.items) &#123;</span><br><span class="line">		out.items = out.items[:<span class="built_in">len</span>(n.items)]</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		out.items = <span class="built_in">make</span>(items, <span class="built_in">len</span>(n.items), <span class="built_in">cap</span>(n.items))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">copy</span>(out.items, n.items)</span><br><span class="line">	<span class="comment">// Copy children</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">cap</span>(out.children) &gt;= <span class="built_in">len</span>(n.children) &#123;</span><br><span class="line">		out.children = out.children[:<span class="built_in">len</span>(n.children)]</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		out.children = <span class="built_in">make</span>(children, <span class="built_in">len</span>(n.children), <span class="built_in">cap</span>(n.children))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">copy</span>(out.children, n.children)</span><br><span class="line">	<span class="keyword">return</span> out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> mutableChild(i <span class="type">int</span>) *node &#123;</span><br><span class="line">	c := n.children[i].mutableFor(n.cow)</span><br><span class="line">	n.children[i] = c</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// split splits the given node at the given index.  The current node shrinks,</span></span><br><span class="line"><span class="comment">// and this function returns the item that existed at that index and a new node</span></span><br><span class="line"><span class="comment">// containing all items/children after it.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> split(i <span class="type">int</span>) (Item, *node) &#123;</span><br><span class="line">	item := n.items[i]</span><br><span class="line">	next := n.cow.newNode()</span><br><span class="line">	next.items = <span class="built_in">append</span>(next.items, n.items[i+<span class="number">1</span>:]...)</span><br><span class="line">	n.items.truncate(i)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		next.children = <span class="built_in">append</span>(next.children, n.children[i+<span class="number">1</span>:]...)</span><br><span class="line">		n.children.truncate(i + <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> item, next</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// maybeSplitChild checks if a child should be split, and if so splits it.</span></span><br><span class="line"><span class="comment">// Returns whether or not a split occurred.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> maybeSplitChild(i, maxItems <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.children[i].items) &lt; maxItems &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	first := n.mutableChild(i)</span><br><span class="line">	item, second := first.split(maxItems / <span class="number">2</span>)</span><br><span class="line">	n.items.insertAt(i, item)</span><br><span class="line">	n.children.insertAt(i+<span class="number">1</span>, second)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// insert inserts an item into the subtree rooted at this node, making sure</span></span><br><span class="line"><span class="comment">// no nodes in the subtree exceed maxItems items.  Should an equivalent item be</span></span><br><span class="line"><span class="comment">// be found/replaced by insert, it will be returned.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> insert(item Item, maxItems <span class="type">int</span>) Item &#123;</span><br><span class="line">	i, found := n.items.find(item)</span><br><span class="line">	<span class="keyword">if</span> found &#123;</span><br><span class="line">		out := n.items[i]</span><br><span class="line">		n.items[i] = item</span><br><span class="line">		<span class="keyword">return</span> out</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.children) == <span class="number">0</span> &#123;</span><br><span class="line">		n.items.insertAt(i, item)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> n.maybeSplitChild(i, maxItems) &#123;</span><br><span class="line">		inTree := n.items[i]</span><br><span class="line">		<span class="keyword">switch</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> item.Less(inTree):</span><br><span class="line">			<span class="comment">// no change, we want first split node</span></span><br><span class="line">		<span class="keyword">case</span> inTree.Less(item):</span><br><span class="line">			i++ <span class="comment">// we want second split node</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			out := n.items[i]</span><br><span class="line">			n.items[i] = item</span><br><span class="line">			<span class="keyword">return</span> out</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n.mutableChild(i).insert(item, maxItems)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get finds the given key in the subtree and returns it.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> get(key Item) Item &#123;</span><br><span class="line">	i, found := n.items.find(key)</span><br><span class="line">	<span class="keyword">if</span> found &#123;</span><br><span class="line">		<span class="keyword">return</span> n.items[i]</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> n.children[i].get(key)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// min returns the first item in the subtree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(n *node)</span></span> Item &#123;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		n = n.children[<span class="number">0</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.items) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n.items[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// max returns the last item in the subtree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(n *node)</span></span> Item &#123;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		n = n.children[<span class="built_in">len</span>(n.children)<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.items) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n.items[<span class="built_in">len</span>(n.items)<span class="number">-1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// toRemove details what item to remove in a node.remove call.</span></span><br><span class="line"><span class="keyword">type</span> toRemove <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	removeItem toRemove = <span class="literal">iota</span> <span class="comment">// removes the given item</span></span><br><span class="line">	removeMin                  <span class="comment">// removes smallest item in the subtree</span></span><br><span class="line">	removeMax                  <span class="comment">// removes largest item in the subtree</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// remove removes an item from the subtree rooted at this node.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> remove(item Item, minItems <span class="type">int</span>, typ toRemove) Item &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> found <span class="type">bool</span></span><br><span class="line">	<span class="keyword">switch</span> typ &#123;</span><br><span class="line">	<span class="keyword">case</span> removeMax:</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(n.children) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> n.items.pop()</span><br><span class="line">		&#125;</span><br><span class="line">		i = <span class="built_in">len</span>(n.items)</span><br><span class="line">	<span class="keyword">case</span> removeMin:</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(n.children) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> n.items.removeAt(<span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">case</span> removeItem:</span><br><span class="line">		i, found = n.items.find(item)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(n.children) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> found &#123;</span><br><span class="line">				<span class="keyword">return</span> n.items.removeAt(i)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;invalid type&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// If we get to here, we have children.</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(n.children[i].items) &lt;= minItems &#123;</span><br><span class="line">		<span class="keyword">return</span> n.growChildAndRemove(i, item, minItems, typ)</span><br><span class="line">	&#125;</span><br><span class="line">	child := n.mutableChild(i)</span><br><span class="line">	<span class="comment">// Either we had enough items to begin with, or we&#x27;ve done some</span></span><br><span class="line">	<span class="comment">// merging/stealing, because we&#x27;ve got enough now and we&#x27;re ready to return</span></span><br><span class="line">	<span class="comment">// stuff.</span></span><br><span class="line">	<span class="keyword">if</span> found &#123;</span><br><span class="line">		<span class="comment">// The item exists at index &#x27;i&#x27;, and the child we&#x27;ve selected can give us a</span></span><br><span class="line">		<span class="comment">// predecessor, since if we&#x27;ve gotten here it&#x27;s got &gt; minItems items in it.</span></span><br><span class="line">		out := n.items[i]</span><br><span class="line">		<span class="comment">// We use our special-case &#x27;remove&#x27; call with typ=maxItem to pull the</span></span><br><span class="line">		<span class="comment">// predecessor of item i (the rightmost leaf of our immediate left child)</span></span><br><span class="line">		<span class="comment">// and set it into where we pulled the item from.</span></span><br><span class="line">		n.items[i] = child.remove(<span class="literal">nil</span>, minItems, removeMax)</span><br><span class="line">		<span class="keyword">return</span> out</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Final recursive call.  Once we&#x27;re here, we know that the item isn&#x27;t in this</span></span><br><span class="line">	<span class="comment">// node and that the child is big enough to remove from.</span></span><br><span class="line">	<span class="keyword">return</span> child.remove(item, minItems, typ)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// growChildAndRemove grows child &#x27;i&#x27; to make sure it&#x27;s possible to remove an</span></span><br><span class="line"><span class="comment">// item from it while keeping it at minItems, then calls remove to actually</span></span><br><span class="line"><span class="comment">// remove it.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Most documentation says we have to do two sets of special casing:</span></span><br><span class="line"><span class="comment">//   1) item is in this node</span></span><br><span class="line"><span class="comment">//   2) item is in child</span></span><br><span class="line"><span class="comment">// In both cases, we need to handle the two subcases:</span></span><br><span class="line"><span class="comment">//   A) node has enough values that it can spare one</span></span><br><span class="line"><span class="comment">//   B) node doesn&#x27;t have enough values</span></span><br><span class="line"><span class="comment">// For the latter, we have to check:</span></span><br><span class="line"><span class="comment">//   a) left sibling has node to spare</span></span><br><span class="line"><span class="comment">//   b) right sibling has node to spare</span></span><br><span class="line"><span class="comment">//   c) we must merge</span></span><br><span class="line"><span class="comment">// To simplify our code here, we handle cases #1 and #2 the same:</span></span><br><span class="line"><span class="comment">// If a node doesn&#x27;t have enough items, we make sure it does (using a,b,c).</span></span><br><span class="line"><span class="comment">// We then simply redo our remove call, and the second time (regardless of</span></span><br><span class="line"><span class="comment">// whether we&#x27;re in case 1 or 2), we&#x27;ll have enough items and can guarantee</span></span><br><span class="line"><span class="comment">// that we hit case A.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> growChildAndRemove(i <span class="type">int</span>, item Item, minItems <span class="type">int</span>, typ toRemove) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> i &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">len</span>(n.children[i<span class="number">-1</span>].items) &gt; minItems &#123;</span><br><span class="line">		<span class="comment">// Steal from left child</span></span><br><span class="line">		child := n.mutableChild(i)</span><br><span class="line">		stealFrom := n.mutableChild(i - <span class="number">1</span>)</span><br><span class="line">		stolenItem := stealFrom.items.pop()</span><br><span class="line">		child.items.insertAt(<span class="number">0</span>, n.items[i<span class="number">-1</span>])</span><br><span class="line">		n.items[i<span class="number">-1</span>] = stolenItem</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(stealFrom.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">			child.children.insertAt(<span class="number">0</span>, stealFrom.children.pop())</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(n.items) &amp;&amp; <span class="built_in">len</span>(n.children[i+<span class="number">1</span>].items) &gt; minItems &#123;</span><br><span class="line">		<span class="comment">// steal from right child</span></span><br><span class="line">		child := n.mutableChild(i)</span><br><span class="line">		stealFrom := n.mutableChild(i + <span class="number">1</span>)</span><br><span class="line">		stolenItem := stealFrom.items.removeAt(<span class="number">0</span>)</span><br><span class="line">		child.items = <span class="built_in">append</span>(child.items, n.items[i])</span><br><span class="line">		n.items[i] = stolenItem</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(stealFrom.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">			child.children = <span class="built_in">append</span>(child.children, stealFrom.children.removeAt(<span class="number">0</span>))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(n.items) &#123;</span><br><span class="line">			i--</span><br><span class="line">		&#125;</span><br><span class="line">		child := n.mutableChild(i)</span><br><span class="line">		<span class="comment">// merge with right child</span></span><br><span class="line">		mergeItem := n.items.removeAt(i)</span><br><span class="line">		mergeChild := n.children.removeAt(i + <span class="number">1</span>)</span><br><span class="line">		child.items = <span class="built_in">append</span>(child.items, mergeItem)</span><br><span class="line">		child.items = <span class="built_in">append</span>(child.items, mergeChild.items...)</span><br><span class="line">		child.children = <span class="built_in">append</span>(child.children, mergeChild.children...)</span><br><span class="line">		n.cow.freeNode(mergeChild)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n.remove(item, minItems, typ)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> direction <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	descend = direction(<span class="number">-1</span>)</span><br><span class="line">	ascend  = direction(+<span class="number">1</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// iterate provides a simple method for iterating over elements in the tree.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// When ascending, the &#x27;start&#x27; should be less than &#x27;stop&#x27; and when descending,</span></span><br><span class="line"><span class="comment">// the &#x27;start&#x27; should be greater than &#x27;stop&#x27;. Setting &#x27;includeStart&#x27; to true</span></span><br><span class="line"><span class="comment">// will force the iterator to include the first item when it equals &#x27;start&#x27;,</span></span><br><span class="line"><span class="comment">// thus creating a &quot;greaterOrEqual&quot; or &quot;lessThanEqual&quot; rather than just a</span></span><br><span class="line"><span class="comment">// &quot;greaterThan&quot; or &quot;lessThan&quot; queries.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> iterate(dir direction, start, stop Item, includeStart <span class="type">bool</span>, hit <span class="type">bool</span>, iter ItemIterator) (<span class="type">bool</span>, <span class="type">bool</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> ok, found <span class="type">bool</span></span><br><span class="line">	<span class="keyword">var</span> index <span class="type">int</span></span><br><span class="line">	<span class="keyword">switch</span> dir &#123;</span><br><span class="line">	<span class="keyword">case</span> ascend:</span><br><span class="line">		<span class="keyword">if</span> start != <span class="literal">nil</span> &#123;</span><br><span class="line">			index, _ = n.items.find(start)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> i := index; i &lt; <span class="built_in">len</span>(n.items); i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> hit, ok = n.children[i].iterate(dir, start, stop, includeStart, hit, iter); !ok &#123;</span><br><span class="line">					<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> !includeStart &amp;&amp; !hit &amp;&amp; start != <span class="literal">nil</span> &amp;&amp; !start.Less(n.items[i]) &#123;</span><br><span class="line">				hit = <span class="literal">true</span></span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			hit = <span class="literal">true</span></span><br><span class="line">			<span class="keyword">if</span> stop != <span class="literal">nil</span> &amp;&amp; !n.items[i].Less(stop) &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> !iter(n.items[i]) &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> hit, ok = n.children[<span class="built_in">len</span>(n.children)<span class="number">-1</span>].iterate(dir, start, stop, includeStart, hit, iter); !ok &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">case</span> descend:</span><br><span class="line">		<span class="keyword">if</span> start != <span class="literal">nil</span> &#123;</span><br><span class="line">			index, found = n.items.find(start)</span><br><span class="line">			<span class="keyword">if</span> !found &#123;</span><br><span class="line">				index = index - <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			index = <span class="built_in">len</span>(n.items) - <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> i := index; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">			<span class="keyword">if</span> start != <span class="literal">nil</span> &amp;&amp; !n.items[i].Less(start) &#123;</span><br><span class="line">				<span class="keyword">if</span> !includeStart || hit || start.Less(n.items[i]) &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> hit, ok = n.children[i+<span class="number">1</span>].iterate(dir, start, stop, includeStart, hit, iter); !ok &#123;</span><br><span class="line">					<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> stop != <span class="literal">nil</span> &amp;&amp; !stop.Less(n.items[i]) &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span> <span class="comment">//	continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			hit = <span class="literal">true</span></span><br><span class="line">			<span class="keyword">if</span> !iter(n.items[i]) &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(n.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> hit, ok = n.children[<span class="number">0</span>].iterate(dir, start, stop, includeStart, hit, iter); !ok &#123;</span><br><span class="line">				<span class="keyword">return</span> hit, <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> hit, <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Used for testing/debugging purposes.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> <span class="built_in">print</span>(w io.Writer, level <span class="type">int</span>) &#123;</span><br><span class="line">	fmt.Fprintf(w, <span class="string">&quot;%sNODE:%v\n&quot;</span>, strings.Repeat(<span class="string">&quot;  &quot;</span>, level), n.items)</span><br><span class="line">	<span class="keyword">for</span> _, c := <span class="keyword">range</span> n.children &#123;</span><br><span class="line">		c.<span class="built_in">print</span>(w, level+<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BTree is an implementation of a B-Tree.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// BTree stores Item instances in an ordered structure, allowing easy insertion,</span></span><br><span class="line"><span class="comment">// removal, and iteration.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Write operations are not safe for concurrent mutation by multiple</span></span><br><span class="line"><span class="comment">// goroutines, but Read operations are.</span></span><br><span class="line"><span class="keyword">type</span> BTree <span class="keyword">struct</span> &#123;</span><br><span class="line">	degree <span class="type">int</span></span><br><span class="line">	length <span class="type">int</span></span><br><span class="line">	root   *node</span><br><span class="line">	cow    *copyOnWriteContext</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// copyOnWriteContext pointers determine node ownership... a tree with a write</span></span><br><span class="line"><span class="comment">// context equivalent to a node&#x27;s write context is allowed to modify that node.</span></span><br><span class="line"><span class="comment">// A tree whose write context does not match a node&#x27;s is not allowed to modify</span></span><br><span class="line"><span class="comment">// it, and must create a new, writable copy (IE: it&#x27;s a Clone).</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// When doing any write operation, we maintain the invariant that the current</span></span><br><span class="line"><span class="comment">// node&#x27;s context is equal to the context of the tree that requested the write.</span></span><br><span class="line"><span class="comment">// We do this by, before we descend into any node, creating a copy with the</span></span><br><span class="line"><span class="comment">// correct context if the contexts don&#x27;t match.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Since the node we&#x27;re currently visiting on any write has the requesting</span></span><br><span class="line"><span class="comment">// tree&#x27;s context, that node is modifiable in place.  Children of that node may</span></span><br><span class="line"><span class="comment">// not share context, but before we descend into them, we&#x27;ll make a mutable</span></span><br><span class="line"><span class="comment">// copy.</span></span><br><span class="line"><span class="keyword">type</span> copyOnWriteContext <span class="keyword">struct</span> &#123;</span><br><span class="line">	freelist *FreeList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Clone clones the btree, lazily.  Clone should not be called concurrently,</span></span><br><span class="line"><span class="comment">// but the original tree (t) and the new tree (t2) can be used concurrently</span></span><br><span class="line"><span class="comment">// once the Clone call completes.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// The internal tree structure of b is marked read-only and shared between t and</span></span><br><span class="line"><span class="comment">// t2.  Writes to both t and t2 use copy-on-write logic, creating new nodes</span></span><br><span class="line"><span class="comment">// whenever one of b&#x27;s original nodes would have been modified.  Read operations</span></span><br><span class="line"><span class="comment">// should have no performance degredation.  Write operations for both t and t2</span></span><br><span class="line"><span class="comment">// will initially experience minor slow-downs caused by additional allocs and</span></span><br><span class="line"><span class="comment">// copies due to the aforementioned copy-on-write logic, but should converge to</span></span><br><span class="line"><span class="comment">// the original performance characteristics of the original tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Clone() (t2 *BTree) &#123;</span><br><span class="line">	<span class="comment">// Create two entirely new copy-on-write contexts.</span></span><br><span class="line">	<span class="comment">// This operation effectively creates three trees:</span></span><br><span class="line">	<span class="comment">//   the original, shared nodes (old b.cow)</span></span><br><span class="line">	<span class="comment">//   the new b.cow nodes</span></span><br><span class="line">	<span class="comment">//   the new out.cow nodes</span></span><br><span class="line">	cow1, cow2 := *t.cow, *t.cow</span><br><span class="line">	out := *t</span><br><span class="line">	t.cow = &amp;cow1</span><br><span class="line">	out.cow = &amp;cow2</span><br><span class="line">	<span class="keyword">return</span> &amp;out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// maxItems returns the max number of items to allow per node.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> maxItems() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> t.degree*<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// minItems returns the min number of items to allow per node (ignored for the</span></span><br><span class="line"><span class="comment">// root node).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> minItems() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> t.degree - <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *copyOnWriteContext)</span></span> newNode() (n *node) &#123;</span><br><span class="line">	n = c.freelist.newNode()</span><br><span class="line">	n.cow = c</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> freeType <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	ftFreelistFull freeType = <span class="literal">iota</span> <span class="comment">// node was freed (available for GC, not stored in freelist)</span></span><br><span class="line">	ftStored                       <span class="comment">// node was stored in the freelist for later use</span></span><br><span class="line">	ftNotOwned                     <span class="comment">// node was ignored by COW, since it&#x27;s owned by another one</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// freeNode frees a node within a given COW context, if it&#x27;s owned by that</span></span><br><span class="line"><span class="comment">// context.  It returns what happened to the node (see freeType const</span></span><br><span class="line"><span class="comment">// documentation).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *copyOnWriteContext)</span></span> freeNode(n *node) freeType &#123;</span><br><span class="line">	<span class="keyword">if</span> n.cow == c &#123;</span><br><span class="line">		<span class="comment">// clear to allow GC</span></span><br><span class="line">		n.items.truncate(<span class="number">0</span>)</span><br><span class="line">		n.children.truncate(<span class="number">0</span>)</span><br><span class="line">		n.cow = <span class="literal">nil</span></span><br><span class="line">		<span class="keyword">if</span> c.freelist.freeNode(n) &#123;</span><br><span class="line">			<span class="keyword">return</span> ftStored</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> ftFreelistFull</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> ftNotOwned</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReplaceOrInsert adds the given item to the tree.  If an item in the tree</span></span><br><span class="line"><span class="comment">// already equals the given one, it is removed from the tree and returned.</span></span><br><span class="line"><span class="comment">// Otherwise, nil is returned.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// nil cannot be added to the tree (will panic).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> ReplaceOrInsert(item Item) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> item == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;nil item being added to BTree&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		t.root = t.cow.newNode()</span><br><span class="line">		t.root.items = <span class="built_in">append</span>(t.root.items, item)</span><br><span class="line">		t.length++</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		t.root = t.root.mutableFor(t.cow)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(t.root.items) &gt;= t.maxItems() &#123;</span><br><span class="line">			item2, second := t.root.split(t.maxItems() / <span class="number">2</span>)</span><br><span class="line">			oldroot := t.root</span><br><span class="line">			t.root = t.cow.newNode()</span><br><span class="line">			t.root.items = <span class="built_in">append</span>(t.root.items, item2)</span><br><span class="line">			t.root.children = <span class="built_in">append</span>(t.root.children, oldroot, second)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	out := t.root.insert(item, t.maxItems())</span><br><span class="line">	<span class="keyword">if</span> out == <span class="literal">nil</span> &#123;</span><br><span class="line">		t.length++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Delete removes an item equal to the passed in item from the tree, returning</span></span><br><span class="line"><span class="comment">// it.  If no such item exists, returns nil.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Delete(item Item) Item &#123;</span><br><span class="line">	<span class="keyword">return</span> t.deleteItem(item, removeItem)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DeleteMin removes the smallest item in the tree and returns it.</span></span><br><span class="line"><span class="comment">// If no such item exists, returns nil.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> DeleteMin() Item &#123;</span><br><span class="line">	<span class="keyword">return</span> t.deleteItem(<span class="literal">nil</span>, removeMin)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DeleteMax removes the largest item in the tree and returns it.</span></span><br><span class="line"><span class="comment">// If no such item exists, returns nil.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> DeleteMax() Item &#123;</span><br><span class="line">	<span class="keyword">return</span> t.deleteItem(<span class="literal">nil</span>, removeMax)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> deleteItem(item Item, typ toRemove) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> || <span class="built_in">len</span>(t.root.items) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root = t.root.mutableFor(t.cow)</span><br><span class="line">	out := t.root.remove(item, t.minItems(), typ)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(t.root.items) == <span class="number">0</span> &amp;&amp; <span class="built_in">len</span>(t.root.children) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		oldroot := t.root</span><br><span class="line">		t.root = t.root.children[<span class="number">0</span>]</span><br><span class="line">		t.cow.freeNode(oldroot)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> out != <span class="literal">nil</span> &#123;</span><br><span class="line">		t.length--</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AscendRange calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [greaterOrEqual, lessThan), until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> AscendRange(greaterOrEqual, lessThan Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(ascend, greaterOrEqual, lessThan, <span class="literal">true</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AscendLessThan calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [first, pivot), until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> AscendLessThan(pivot Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(ascend, <span class="literal">nil</span>, pivot, <span class="literal">false</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AscendGreaterOrEqual calls the iterator for every value in the tree within</span></span><br><span class="line"><span class="comment">// the range [pivot, last], until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> AscendGreaterOrEqual(pivot Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(ascend, pivot, <span class="literal">nil</span>, <span class="literal">true</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ascend calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [first, last], until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Ascend(iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(ascend, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">false</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DescendRange calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [lessOrEqual, greaterThan), until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> DescendRange(lessOrEqual, greaterThan Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(descend, lessOrEqual, greaterThan, <span class="literal">true</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DescendLessOrEqual calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [pivot, first], until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> DescendLessOrEqual(pivot Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(descend, pivot, <span class="literal">nil</span>, <span class="literal">true</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DescendGreaterThan calls the iterator for every value in the tree within</span></span><br><span class="line"><span class="comment">// the range [last, pivot), until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> DescendGreaterThan(pivot Item, iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(descend, <span class="literal">nil</span>, pivot, <span class="literal">false</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Descend calls the iterator for every value in the tree within the range</span></span><br><span class="line"><span class="comment">// [last, first], until iterator returns false.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Descend(iterator ItemIterator) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.root.iterate(descend, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">false</span>, <span class="literal">false</span>, iterator)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get looks for the key item in the tree, returning it.  It returns nil if</span></span><br><span class="line"><span class="comment">// unable to find that item.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Get(key Item) Item &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t.root.get(key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Min returns the smallest item in the tree, or nil if the tree is empty.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Min() Item &#123;</span><br><span class="line">	<span class="keyword">return</span> min(t.root)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Max returns the largest item in the tree, or nil if the tree is empty.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Max() Item &#123;</span><br><span class="line">	<span class="keyword">return</span> max(t.root)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Has returns true if the given key is in the tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Has(key Item) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> t.Get(key) != <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Len returns the number of items currently in the tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Len() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> t.length</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Clear removes all items from the btree.  If addNodesToFreelist is true,</span></span><br><span class="line"><span class="comment">// t&#x27;s nodes are added to its freelist as part of this call, until the freelist</span></span><br><span class="line"><span class="comment">// is full.  Otherwise, the root node is simply dereferenced and the subtree</span></span><br><span class="line"><span class="comment">// left to Go&#x27;s normal GC processes.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This can be much faster</span></span><br><span class="line"><span class="comment">// than calling Delete on all elements, because that requires finding/removing</span></span><br><span class="line"><span class="comment">// each element in the tree and updating the tree accordingly.  It also is</span></span><br><span class="line"><span class="comment">// somewhat faster than creating a new tree to replace the old one, because</span></span><br><span class="line"><span class="comment">// nodes from the old tree are reclaimed into the freelist for use by the new</span></span><br><span class="line"><span class="comment">// one, instead of being lost to the garbage collector.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This call takes:</span></span><br><span class="line"><span class="comment">//   O(1): when addNodesToFreelist is false, this is a single operation.</span></span><br><span class="line"><span class="comment">//   O(1): when the freelist is already full, it breaks out immediately</span></span><br><span class="line"><span class="comment">//   O(freelist size):  when the freelist is empty and the nodes are all owned</span></span><br><span class="line"><span class="comment">//       by this tree, nodes are added to the freelist until full.</span></span><br><span class="line"><span class="comment">//   O(tree size):  when all nodes are owned by another tree, all nodes are</span></span><br><span class="line"><span class="comment">//       iterated over looking for nodes to add to the freelist, and due to</span></span><br><span class="line"><span class="comment">//       ownership, none are.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BTree)</span></span> Clear(addNodesToFreelist <span class="type">bool</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> t.root != <span class="literal">nil</span> &amp;&amp; addNodesToFreelist &#123;</span><br><span class="line">		t.root.reset(t.cow)</span><br><span class="line">	&#125;</span><br><span class="line">	t.root, t.length = <span class="literal">nil</span>, <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reset returns a subtree to the freelist.  It breaks out immediately if the</span></span><br><span class="line"><span class="comment">// freelist is full, since the only benefit of iterating is to fill that</span></span><br><span class="line"><span class="comment">// freelist up.  Returns true if parent reset call should continue.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> reset(c *copyOnWriteContext) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">for</span> _, child := <span class="keyword">range</span> n.children &#123;</span><br><span class="line">		<span class="keyword">if</span> !child.reset(c) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> c.freeNode(n) != ftFreelistFull</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Int implements the Item interface for integers.</span></span><br><span class="line"><span class="keyword">type</span> Int <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Less returns true if int(a) &lt; int(b).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a Int)</span></span> Less(b Item) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a &lt; b.(Int)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	seed := time.Now().Unix()</span><br><span class="line">	fmt.Println(seed)</span><br><span class="line">	rand.Seed(seed)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// perm returns a random permutation of n Int items in the range [0, n).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">perm</span><span class="params">(n <span class="type">int</span>)</span></span> (out []Item) &#123;</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> rand.Perm(n) &#123;</span><br><span class="line">		out = <span class="built_in">append</span>(out, Int(v))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rang returns an ordered list of Int items in the range [0, n).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rang</span><span class="params">(n <span class="type">int</span>)</span></span> (out []Item) &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		out = <span class="built_in">append</span>(out, Int(i))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// all extracts all items from a tree in order as a slice.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">all</span><span class="params">(t *BTree)</span></span> (out []Item) &#123;</span><br><span class="line">	t.Ascend(<span class="function"><span class="keyword">func</span><span class="params">(a Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		out = <span class="built_in">append</span>(out, a)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rangerev returns a reversed ordered list of Int items in the range [0, n).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rangrev</span><span class="params">(n <span class="type">int</span>)</span></span> (out []Item) &#123;</span><br><span class="line">	<span class="keyword">for</span> i := n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">		out = <span class="built_in">append</span>(out, Int(i))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// allrev extracts all items from a tree in reverse order as a slice.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">allrev</span><span class="params">(t *BTree)</span></span> (out []Item) &#123;</span><br><span class="line">	t.Descend(<span class="function"><span class="keyword">func</span><span class="params">(a Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		out = <span class="built_in">append</span>(out, a)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">	bTree := New(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _,item := <span class="keyword">range</span> perm(<span class="number">100</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> x := bTree.ReplaceOrInsert(item); x != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;insert didn&#x27;t find item&quot;</span>, item)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(bTree.Min())</span><br><span class="line">	fmt.Println(bTree.Max())</span><br><span class="line">	fmt.Println(bTree.Len())</span><br><span class="line"></span><br><span class="line">	fmt.Println(bTree.DeleteMin())</span><br><span class="line">	fmt.Println(bTree.DeleteMax())</span><br><span class="line">	fmt.Println(bTree.Len())</span><br><span class="line"></span><br><span class="line">	fmt.Println(bTree.Get(Int(<span class="number">55</span>)))</span><br><span class="line">	fmt.Println(bTree.Has(Int(<span class="number">111</span>)))</span><br><span class="line">	fmt.Println(bTree.Delete(Int(<span class="number">98</span>)))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å‡åºéå†</span></span><br><span class="line">	bTree.Ascend(<span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	bTree.AscendRange(Int(<span class="number">10</span>),Int(<span class="number">20</span>), <span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é™åºéå†</span></span><br><span class="line">	bTree.Descend(<span class="function"><span class="keyword">func</span><span class="params">(i Item)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h2 id="9-8-B-æ ‘"><a href="#9-8-B-æ ‘" class="headerlink" title="9.8 B+æ ‘"></a>9.8 B+æ ‘</h2><p><a target="_blank" rel="noopener" href="https://github.com/timtadh/fs2">https://github.com/timtadh/fs2</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	err <span class="type">error</span></span><br><span class="line"></span><br><span class="line">	defaultOrder = <span class="number">4</span></span><br><span class="line">	minOrder     = <span class="number">3</span></span><br><span class="line">	maxOrder     = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">	order          = defaultOrder</span><br><span class="line">	queue          *Node</span><br><span class="line">	verbose_output = <span class="literal">false</span></span><br><span class="line">	version        = <span class="number">0.1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> BPlusTree <span class="keyword">struct</span> &#123;</span><br><span class="line">	Root *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Record <span class="keyword">struct</span> &#123;</span><br><span class="line">	Value <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span> &#123;</span><br><span class="line">	Pointers []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	Keys     []<span class="type">int</span></span><br><span class="line">	Parent   *Node</span><br><span class="line">	IsLeaf   <span class="type">bool</span></span><br><span class="line">	NumKeys  <span class="type">int</span></span><br><span class="line">	Next     *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewBPlusTree</span><span class="params">()</span></span> *BPlusTree &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;BPlusTree&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> Insert(key <span class="type">int</span>, value <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> pointer *Record</span><br><span class="line">	<span class="keyword">var</span> leaf *Node</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, err := t.Find(key, <span class="literal">false</span>); err == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;key already exists&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	pointer, err := makeRecord(value)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> t.Root == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.startNewTree(key, pointer)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	leaf = t.findLeaf(key, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> leaf.NumKeys &lt; order<span class="number">-1</span> &#123;</span><br><span class="line">		insertIntoLeaf(leaf, key, pointer)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.insertIntoLeafAfterSplitting(leaf, key, pointer)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> Find(key <span class="type">int</span>, verbose <span class="type">bool</span>) (*Record, <span class="type">error</span>) &#123;</span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	c := t.findLeaf(key, verbose)</span><br><span class="line">	<span class="keyword">if</span> c == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;key not found&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; c.NumKeys; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> c.Keys[i] == key &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> i == c.NumKeys &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;key not found&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	r, _ := c.Pointers[i].(*Record)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> r, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> FindAndPrint(key <span class="type">int</span>, verbose <span class="type">bool</span>) &#123;</span><br><span class="line">	r, err := t.Find(key, verbose)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> || r == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Record not found under key %d.\n&quot;</span>, key)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Record at %d -- key %d, value %s.\n&quot;</span>, r, key, r.Value)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> FindAndPrintRange(keyStart, keyEnd <span class="type">int</span>, verbose <span class="type">bool</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	arraySize := keyEnd - keyStart + <span class="number">1</span></span><br><span class="line">	returnedKeys := <span class="built_in">make</span>([]<span class="type">int</span>, arraySize)</span><br><span class="line">	returnedPointers := <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, arraySize)</span><br><span class="line">	numFound := t.findRange(keyStart, keyEnd, verbose, returnedKeys, returnedPointers)</span><br><span class="line">	<span class="keyword">if</span> numFound == <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;None found,\n&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; numFound; i++ &#123;</span><br><span class="line">			c, _ := returnedPointers[i].(*Record)</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Key: %d  Location: %d  Value: %s\n&quot;</span>,</span><br><span class="line">				returnedKeys[i],</span><br><span class="line">				returnedPointers[i],</span><br><span class="line">				c.Value)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> PrintTree() &#123;</span><br><span class="line">	<span class="keyword">var</span> n *Node</span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	rank := <span class="number">0</span></span><br><span class="line">	newRank := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> t.Root == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Empty tree.\n&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	queue = <span class="literal">nil</span></span><br><span class="line">	enqueue(t.Root)</span><br><span class="line">	<span class="keyword">for</span> queue != <span class="literal">nil</span> &#123;</span><br><span class="line">		n = dequeue()</span><br><span class="line">		<span class="keyword">if</span> n != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> n.Parent != <span class="literal">nil</span> &amp;&amp; n == n.Parent.Pointers[<span class="number">0</span>] &#123;</span><br><span class="line">				newRank = t.pathToRoot(n)</span><br><span class="line">				<span class="keyword">if</span> newRank != rank &#123;</span><br><span class="line">					fmt.Printf(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> verbose_output &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;(%d)&quot;</span>, n)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; n.NumKeys; i++ &#123;</span><br><span class="line">				<span class="keyword">if</span> verbose_output &#123;</span><br><span class="line">					fmt.Printf(<span class="string">&quot;%d &quot;</span>, n.Pointers[i])</span><br><span class="line">				&#125;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;%d &quot;</span>, n.Keys[i])</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> !n.IsLeaf &#123;</span><br><span class="line">				<span class="keyword">for</span> i = <span class="number">0</span>; i &lt;= n.NumKeys; i++ &#123;</span><br><span class="line">					c, _ := n.Pointers[i].(*Node)</span><br><span class="line">					enqueue(c)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> verbose_output &#123;</span><br><span class="line">				<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">					fmt.Printf(<span class="string">&quot;%d &quot;</span>, n.Pointers[order<span class="number">-1</span>])</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					fmt.Printf(<span class="string">&quot;%d &quot;</span>, n.Pointers[n.NumKeys])</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Printf(<span class="string">&quot; | &quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> PrintLeaves() &#123;</span><br><span class="line">	<span class="keyword">if</span> t.Root == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Empty tree.\n&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	c := t.Root</span><br><span class="line">	<span class="keyword">for</span> !c.IsLeaf &#123;</span><br><span class="line">		c, _ = c.Pointers[<span class="number">0</span>].(*Node)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; c.NumKeys; i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> verbose_output &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;%d &quot;</span>, c.Pointers[i])</span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%d &quot;</span>, c.Keys[i])</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> verbose_output &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%d &quot;</span>, c.Pointers[order<span class="number">-1</span>])</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> c.Pointers[order<span class="number">-1</span>] != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot; | &quot;</span>)</span><br><span class="line">			c, _ = c.Pointers[order<span class="number">-1</span>].(*Node)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> Delete(key <span class="type">int</span>) <span class="type">error</span> &#123;</span><br><span class="line">	keyRecord, err := t.Find(key, <span class="literal">false</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	keyLeaf := t.findLeaf(key, <span class="literal">false</span>)</span><br><span class="line">	<span class="keyword">if</span> keyRecord != <span class="literal">nil</span> &amp;&amp; keyLeaf != <span class="literal">nil</span> &#123;</span><br><span class="line">		t.deleteEntry(keyLeaf, key, keyRecord)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Private Functions</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">enqueue</span><span class="params">(newNode *Node)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> c *Node</span><br><span class="line">	<span class="keyword">if</span> queue == <span class="literal">nil</span> &#123;</span><br><span class="line">		queue = newNode</span><br><span class="line">		queue.Next = <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		c = queue</span><br><span class="line">		<span class="keyword">for</span> c.Next != <span class="literal">nil</span> &#123;</span><br><span class="line">			c = c.Next</span><br><span class="line">		&#125;</span><br><span class="line">		c.Next = newNode</span><br><span class="line">		newNode.Next = <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">dequeue</span><span class="params">()</span></span> *Node &#123;</span><br><span class="line">	n := queue</span><br><span class="line">	queue = queue.Next</span><br><span class="line">	n.Next = <span class="literal">nil</span></span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> height() <span class="type">int</span> &#123;</span><br><span class="line">	h := <span class="number">0</span></span><br><span class="line">	c := t.Root</span><br><span class="line">	<span class="keyword">for</span> !c.IsLeaf &#123;</span><br><span class="line">		c, _ = c.Pointers[<span class="number">0</span>].(*Node)</span><br><span class="line">		h++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> h</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> pathToRoot(child *Node) <span class="type">int</span> &#123;</span><br><span class="line">	length := <span class="number">0</span></span><br><span class="line">	c := child</span><br><span class="line">	<span class="keyword">for</span> c != t.Root &#123;</span><br><span class="line">		c = c.Parent</span><br><span class="line">		length += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> length</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> findRange(keyStart, keyEnd <span class="type">int</span>, verbose <span class="type">bool</span>, returnedKeys []<span class="type">int</span>, returnedPointers []<span class="keyword">interface</span>&#123;&#125;) <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	numFound := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	n := t.findLeaf(keyStart, verbose)</span><br><span class="line">	<span class="keyword">if</span> n == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; n.NumKeys &amp;&amp; n.Keys[i] &lt; keyStart; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> i == n.NumKeys &#123; <span class="comment">// could be wrong</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> n != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i = i; i &lt; n.NumKeys &amp;&amp; n.Keys[i] &lt;= keyEnd; i++ &#123;</span><br><span class="line">			returnedKeys[numFound] = n.Keys[i]</span><br><span class="line">			returnedPointers[numFound] = n.Pointers[i]</span><br><span class="line">			numFound += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		n, _ = n.Pointers[order<span class="number">-1</span>].(*Node)</span><br><span class="line">		i = <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> numFound</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> findLeaf(key <span class="type">int</span>, verbose <span class="type">bool</span>) *Node &#123;</span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	c := t.Root</span><br><span class="line">	<span class="keyword">if</span> c == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> verbose &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Empty tree.\n&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> c</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> !c.IsLeaf &#123;</span><br><span class="line">		<span class="keyword">if</span> verbose &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;[&quot;</span>)</span><br><span class="line">			<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; c.NumKeys<span class="number">-1</span>; i++ &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;%d &quot;</span>, c.Keys[i])</span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%d]&quot;</span>, c.Keys[i])</span><br><span class="line">		&#125;</span><br><span class="line">		i = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> i &lt; c.NumKeys &#123;</span><br><span class="line">			<span class="keyword">if</span> key &gt;= c.Keys[i] &#123;</span><br><span class="line">				i += <span class="number">1</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> verbose &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%d -&gt;\n&quot;</span>, i)</span><br><span class="line">		&#125;</span><br><span class="line">		c, _ = c.Pointers[i].(*Node)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> verbose &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Leaf [&quot;</span>)</span><br><span class="line">		<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; c.NumKeys<span class="number">-1</span>; i++ &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%d &quot;</span>, c.Keys[i])</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%d] -&gt;\n&quot;</span>, c.Keys[i])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cut</span><span class="params">(length <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> length%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> length / <span class="number">2</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> length/<span class="number">2</span> + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//	INSERTION</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeRecord</span><span class="params">(value <span class="keyword">interface</span>&#123;&#125;)</span></span> (*Record, <span class="type">error</span>) &#123;</span><br><span class="line">	newRecord := <span class="built_in">new</span>(Record)</span><br><span class="line">	<span class="keyword">if</span> newRecord == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;Error: Record creation.&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		newRecord.Value = value</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> newRecord, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeNode</span><span class="params">()</span></span> (*Node, <span class="type">error</span>) &#123;</span><br><span class="line">	newNode := <span class="built_in">new</span>(Node)</span><br><span class="line">	<span class="keyword">if</span> newNode == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;Error: Node creation.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	newNode.Keys = <span class="built_in">make</span>([]<span class="type">int</span>, order<span class="number">-1</span>)</span><br><span class="line">	<span class="keyword">if</span> newNode.Keys == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;Error: New node keys array.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	newNode.Pointers = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, order)</span><br><span class="line">	<span class="keyword">if</span> newNode.Keys == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;Error: New node pointers array.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	newNode.IsLeaf = <span class="literal">false</span></span><br><span class="line">	newNode.NumKeys = <span class="number">0</span></span><br><span class="line">	newNode.Parent = <span class="literal">nil</span></span><br><span class="line">	newNode.Next = <span class="literal">nil</span></span><br><span class="line">	<span class="keyword">return</span> newNode, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeLeaf</span><span class="params">()</span></span> (*Node, <span class="type">error</span>) &#123;</span><br><span class="line">	leaf, err := makeNode()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	leaf.IsLeaf = <span class="literal">true</span></span><br><span class="line">	<span class="keyword">return</span> leaf, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLeftIndex</span><span class="params">(parent, left *Node)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	leftIndex := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> leftIndex &lt;= parent.NumKeys &amp;&amp; parent.Pointers[leftIndex] != left &#123;</span><br><span class="line">		leftIndex += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> leftIndex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertIntoLeaf</span><span class="params">(leaf *Node, key <span class="type">int</span>, pointer *Record)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i, insertionPoint <span class="type">int</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> insertionPoint &lt; leaf.NumKeys &amp;&amp; leaf.Keys[insertionPoint] &lt; key &#123;</span><br><span class="line">		insertionPoint += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = leaf.NumKeys; i &gt; insertionPoint; i-- &#123;</span><br><span class="line">		leaf.Keys[i] = leaf.Keys[i<span class="number">-1</span>]</span><br><span class="line">		leaf.Pointers[i] = leaf.Pointers[i<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	leaf.Keys[insertionPoint] = key</span><br><span class="line">	leaf.Pointers[insertionPoint] = pointer</span><br><span class="line">	leaf.NumKeys += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> insertIntoLeafAfterSplitting(leaf *Node, key <span class="type">int</span>, pointer *Record) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> newLeaf *Node</span><br><span class="line">	<span class="keyword">var</span> insertionIndex, split, newKey, i, j <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line"></span><br><span class="line">	newLeaf, err = makeLeaf()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tempKeys := <span class="built_in">make</span>([]<span class="type">int</span>, order)</span><br><span class="line">	<span class="keyword">if</span> tempKeys == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;Error: Temporary keys array.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tempPointers := <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, order)</span><br><span class="line">	<span class="keyword">if</span> tempPointers == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;Error: Temporary pointers array.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> insertionIndex &lt; order<span class="number">-1</span> &amp;&amp; leaf.Keys[insertionIndex] &lt; key &#123;</span><br><span class="line">		insertionIndex += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; leaf.NumKeys; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> j == insertionIndex &#123;</span><br><span class="line">			j += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		tempKeys[j] = leaf.Keys[i]</span><br><span class="line">		tempPointers[j] = leaf.Pointers[i]</span><br><span class="line">		j += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tempKeys[insertionIndex] = key</span><br><span class="line">	tempPointers[insertionIndex] = pointer</span><br><span class="line"></span><br><span class="line">	leaf.NumKeys = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	split = cut(order - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; split; i++ &#123;</span><br><span class="line">		leaf.Pointers[i] = tempPointers[i]</span><br><span class="line">		leaf.Keys[i] = tempKeys[i]</span><br><span class="line">		leaf.NumKeys += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	j = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i = split; i &lt; order; i++ &#123;</span><br><span class="line">		newLeaf.Pointers[j] = tempPointers[i]</span><br><span class="line">		newLeaf.Keys[j] = tempKeys[i]</span><br><span class="line">		newLeaf.NumKeys += <span class="number">1</span></span><br><span class="line">		j += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	newLeaf.Pointers[order<span class="number">-1</span>] = leaf.Pointers[order<span class="number">-1</span>]</span><br><span class="line">	leaf.Pointers[order<span class="number">-1</span>] = newLeaf</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = leaf.NumKeys; i &lt; order<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		leaf.Pointers[i] = <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i = newLeaf.NumKeys; i &lt; order<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		newLeaf.Pointers[i] = <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	newLeaf.Parent = leaf.Parent</span><br><span class="line">	newKey = newLeaf.Keys[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.insertIntoParent(leaf, newKey, newLeaf)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertIntoNode</span><span class="params">(n *Node, leftIndex, key <span class="type">int</span>, right *Node)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	<span class="keyword">for</span> i = n.NumKeys; i &gt; leftIndex; i-- &#123;</span><br><span class="line">		n.Pointers[i+<span class="number">1</span>] = n.Pointers[i]</span><br><span class="line">		n.Keys[i] = n.Keys[i<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	n.Pointers[leftIndex+<span class="number">1</span>] = right</span><br><span class="line">	n.Keys[leftIndex] = key</span><br><span class="line">	n.NumKeys += <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> insertIntoNodeAfterSplitting(oldNode *Node, leftIndex, key <span class="type">int</span>, right *Node) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i, j, split, kPrime <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> newNode, child *Node</span><br><span class="line">	<span class="keyword">var</span> tempKeys []<span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> tempPointers []<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line"></span><br><span class="line">	tempPointers = <span class="built_in">make</span>([]<span class="keyword">interface</span>&#123;&#125;, order+<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">if</span> tempPointers == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;Error: Temporary pointers array for splitting nodes.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tempKeys = <span class="built_in">make</span>([]<span class="type">int</span>, order)</span><br><span class="line">	<span class="keyword">if</span> tempKeys == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;Error: Temporary keys array for splitting nodes.&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; oldNode.NumKeys+<span class="number">1</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> j == leftIndex+<span class="number">1</span> &#123;</span><br><span class="line">			j += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		tempPointers[j] = oldNode.Pointers[i]</span><br><span class="line">		j += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	j = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; oldNode.NumKeys; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> j == leftIndex &#123;</span><br><span class="line">			j += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		tempKeys[j] = oldNode.Keys[i]</span><br><span class="line">		j += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tempPointers[leftIndex+<span class="number">1</span>] = right</span><br><span class="line">	tempKeys[leftIndex] = key</span><br><span class="line"></span><br><span class="line">	split = cut(order)</span><br><span class="line">	newNode, err = makeNode()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	oldNode.NumKeys = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; split<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		oldNode.Pointers[i] = tempPointers[i]</span><br><span class="line">		oldNode.Keys[i] = tempKeys[i]</span><br><span class="line">		oldNode.NumKeys += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	oldNode.Pointers[i] = tempPointers[i]</span><br><span class="line">	kPrime = tempKeys[split<span class="number">-1</span>]</span><br><span class="line">	j = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i += <span class="number">1</span>; i &lt; order; i++ &#123;</span><br><span class="line">		newNode.Pointers[j] = tempPointers[i]</span><br><span class="line">		newNode.Keys[j] = tempKeys[i]</span><br><span class="line">		newNode.NumKeys += <span class="number">1</span></span><br><span class="line">		j += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	newNode.Pointers[j] = tempPointers[i]</span><br><span class="line">	newNode.Parent = oldNode.Parent</span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt;= newNode.NumKeys; i++ &#123;</span><br><span class="line">		child, _ = newNode.Pointers[i].(*Node)</span><br><span class="line">		child.Parent = newNode</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.insertIntoParent(oldNode, kPrime, newNode)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> insertIntoParent(left *Node, key <span class="type">int</span>, right *Node) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> leftIndex <span class="type">int</span></span><br><span class="line">	parent := left.Parent</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> parent == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> t.insertIntoNewRoot(left, key, right)</span><br><span class="line">	&#125;</span><br><span class="line">	leftIndex = getLeftIndex(parent, left)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> parent.NumKeys &lt; order<span class="number">-1</span> &#123;</span><br><span class="line">		insertIntoNode(parent, leftIndex, key, right)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t.insertIntoNodeAfterSplitting(parent, leftIndex, key, right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> insertIntoNewRoot(left *Node, key <span class="type">int</span>, right *Node) <span class="type">error</span> &#123;</span><br><span class="line">	t.Root, err = makeNode()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	t.Root.Keys[<span class="number">0</span>] = key</span><br><span class="line">	t.Root.Pointers[<span class="number">0</span>] = left</span><br><span class="line">	t.Root.Pointers[<span class="number">1</span>] = right</span><br><span class="line">	t.Root.NumKeys += <span class="number">1</span></span><br><span class="line">	t.Root.Parent = <span class="literal">nil</span></span><br><span class="line">	left.Parent = t.Root</span><br><span class="line">	right.Parent = t.Root</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> startNewTree(key <span class="type">int</span>, pointer *Record) <span class="type">error</span> &#123;</span><br><span class="line">	t.Root, err = makeLeaf()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	t.Root.Keys[<span class="number">0</span>] = key</span><br><span class="line">	t.Root.Pointers[<span class="number">0</span>] = pointer</span><br><span class="line">	t.Root.Pointers[order<span class="number">-1</span>] = <span class="literal">nil</span></span><br><span class="line">	t.Root.Parent = <span class="literal">nil</span></span><br><span class="line">	t.Root.NumKeys += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getNeighbourIndex</span><span class="params">(n *Node)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i = <span class="number">0</span>; i &lt;= n.Parent.NumKeys; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> reflect.DeepEqual(n.Parent.Pointers[i], n) &#123;</span><br><span class="line">			<span class="keyword">return</span> i - <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeEntryFromNode</span><span class="params">(n *Node, key <span class="type">int</span>, pointer <span class="keyword">interface</span>&#123;&#125;)</span></span> *Node &#123;</span><br><span class="line">	<span class="keyword">var</span> i, numPointers <span class="type">int</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> n.Keys[i] != key &#123;</span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i += <span class="number">1</span>; i &lt; n.NumKeys; i++ &#123;</span><br><span class="line">		n.Keys[i<span class="number">-1</span>] = n.Keys[i]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">		numPointers = n.NumKeys</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		numPointers = n.NumKeys + <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> n.Pointers[i] != pointer &#123;</span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i += <span class="number">1</span>; i &lt; numPointers; i++ &#123;</span><br><span class="line">		n.Pointers[i<span class="number">-1</span>] = n.Pointers[i]</span><br><span class="line">	&#125;</span><br><span class="line">	n.NumKeys -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">		<span class="keyword">for</span> i = n.NumKeys; i &lt; order<span class="number">-1</span>; i++ &#123;</span><br><span class="line">			n.Pointers[i] = <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i = n.NumKeys + <span class="number">1</span>; i &lt; order; i++ &#123;</span><br><span class="line">			n.Pointers[i] = <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> adjustRoot() &#123;</span><br><span class="line">	<span class="keyword">var</span> newRoot *Node</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> t.Root.NumKeys &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !t.Root.IsLeaf &#123;</span><br><span class="line">		newRoot, _ = t.Root.Pointers[<span class="number">0</span>].(*Node)</span><br><span class="line">		newRoot.Parent = <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		newRoot = <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	t.Root = newRoot</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> coalesceNodes(n, neighbour *Node, neighbourIndex, kPrime <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> i, j, neighbourInsertionIndex, nEnd <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> tmp *Node</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> neighbourIndex == <span class="number">-1</span> &#123;</span><br><span class="line">		tmp = n</span><br><span class="line">		n = neighbour</span><br><span class="line">		neighbour = tmp</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	neighbourInsertionIndex = neighbour.NumKeys</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !n.IsLeaf &#123;</span><br><span class="line">		neighbour.Keys[neighbourInsertionIndex] = kPrime</span><br><span class="line">		neighbour.NumKeys += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">		nEnd = n.NumKeys</span><br><span class="line">		i = neighbourInsertionIndex + <span class="number">1</span></span><br><span class="line">		<span class="keyword">for</span> j = <span class="number">0</span>; j &lt; nEnd; j++ &#123;</span><br><span class="line">			neighbour.Keys[i] = n.Keys[j]</span><br><span class="line">			neighbour.Pointers[i] = n.Pointers[j]</span><br><span class="line">			neighbour.NumKeys += <span class="number">1</span></span><br><span class="line">			n.NumKeys -= <span class="number">1</span></span><br><span class="line">			i += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		neighbour.Pointers[i] = n.Pointers[j]</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; neighbour.NumKeys+<span class="number">1</span>; i++ &#123;</span><br><span class="line">			tmp, _ = neighbour.Pointers[i].(*Node)</span><br><span class="line">			tmp.Parent = neighbour</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		i = neighbourInsertionIndex</span><br><span class="line">		<span class="keyword">for</span> j = <span class="number">0</span>; j &lt; n.NumKeys; j++ &#123;</span><br><span class="line">			neighbour.Keys[i] = n.Keys[j]</span><br><span class="line">			n.Pointers[i] = n.Pointers[j]</span><br><span class="line">			neighbour.NumKeys += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		neighbour.Pointers[order<span class="number">-1</span>] = n.Pointers[order<span class="number">-1</span>]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	t.deleteEntry(n.Parent, kPrime, n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> redistributeNodes(n, neighbour *Node, neighbourIndex, kPrimeIndex, kPrime <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> tmp *Node</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> neighbourIndex != <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> !n.IsLeaf &#123;</span><br><span class="line">			n.Pointers[n.NumKeys+<span class="number">1</span>] = n.Pointers[n.NumKeys]</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> i = n.NumKeys; i &gt; <span class="number">0</span>; i-- &#123;</span><br><span class="line">			n.Keys[i] = n.Keys[i<span class="number">-1</span>]</span><br><span class="line">			n.Pointers[i] = n.Pointers[i<span class="number">-1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !n.IsLeaf &#123; <span class="comment">// why the second if !n.IsLeaf</span></span><br><span class="line">			n.Pointers[<span class="number">0</span>] = neighbour.Pointers[neighbour.NumKeys]</span><br><span class="line">			tmp, _ = n.Pointers[<span class="number">0</span>].(*Node)</span><br><span class="line">			tmp.Parent = n</span><br><span class="line">			neighbour.Pointers[neighbour.NumKeys] = <span class="literal">nil</span></span><br><span class="line">			n.Keys[<span class="number">0</span>] = kPrime</span><br><span class="line">			n.Parent.Keys[kPrimeIndex] = neighbour.Keys[neighbour.NumKeys<span class="number">-1</span>]</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			n.Pointers[<span class="number">0</span>] = neighbour.Pointers[neighbour.NumKeys<span class="number">-1</span>]</span><br><span class="line">			neighbour.Pointers[neighbour.NumKeys<span class="number">-1</span>] = <span class="literal">nil</span></span><br><span class="line">			n.Keys[<span class="number">0</span>] = neighbour.Keys[neighbour.NumKeys<span class="number">-1</span>]</span><br><span class="line">			n.Parent.Keys[kPrimeIndex] = n.Keys[<span class="number">0</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">			n.Keys[n.NumKeys] = neighbour.Keys[<span class="number">0</span>]</span><br><span class="line">			n.Pointers[n.NumKeys] = neighbour.Pointers[<span class="number">0</span>]</span><br><span class="line">			n.Parent.Keys[kPrimeIndex] = neighbour.Keys[<span class="number">1</span>]</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			n.Keys[n.NumKeys] = kPrime</span><br><span class="line">			n.Pointers[n.NumKeys+<span class="number">1</span>] = neighbour.Pointers[<span class="number">0</span>]</span><br><span class="line">			tmp, _ = n.Pointers[n.NumKeys+<span class="number">1</span>].(*Node)</span><br><span class="line">			tmp.Parent = n</span><br><span class="line">			n.Parent.Keys[kPrimeIndex] = neighbour.Keys[<span class="number">0</span>]</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> i = <span class="number">0</span>; i &lt; neighbour.NumKeys<span class="number">-1</span>; i++ &#123;</span><br><span class="line">			neighbour.Keys[i] = neighbour.Keys[i+<span class="number">1</span>]</span><br><span class="line">			neighbour.Pointers[i] = neighbour.Pointers[i+<span class="number">1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !n.IsLeaf &#123;</span><br><span class="line">			neighbour.Pointers[i] = neighbour.Pointers[i+<span class="number">1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	n.NumKeys += <span class="number">1</span></span><br><span class="line">	neighbour.NumKeys -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *BPlusTree)</span></span> deleteEntry(n *Node, key <span class="type">int</span>, pointer <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	<span class="keyword">var</span> minKeys, neighbourIndex, kPrimeIndex, kPrime, capacity <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> neighbour *Node</span><br><span class="line"></span><br><span class="line">	n = removeEntryFromNode(n, key, pointer)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n == t.Root &#123;</span><br><span class="line">		t.adjustRoot()</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">		minKeys = cut(order - <span class="number">1</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		minKeys = cut(order) - <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.NumKeys &gt;= minKeys &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	neighbourIndex = getNeighbourIndex(n)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> neighbourIndex == <span class="number">-1</span> &#123;</span><br><span class="line">		kPrimeIndex = <span class="number">0</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		kPrimeIndex = neighbourIndex</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	kPrime = n.Parent.Keys[kPrimeIndex]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> neighbourIndex == <span class="number">-1</span> &#123;</span><br><span class="line">		neighbour, _ = n.Parent.Pointers[<span class="number">1</span>].(*Node)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		neighbour, _ = n.Parent.Pointers[neighbourIndex].(*Node)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.IsLeaf &#123;</span><br><span class="line">		capacity = order</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		capacity = order - <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> neighbour.NumKeys+n.NumKeys &lt; capacity &#123;</span><br><span class="line">		t.coalesceNodes(n, neighbour, neighbourIndex, kPrime)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		t.redistributeNodes(n, neighbour, neighbourIndex, kPrimeIndex, kPrime)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">	tree := NewBPlusTree()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>;i &lt; <span class="number">100</span>;i++ &#123;</span><br><span class="line">		err := tree.Insert(i, fmt.Sprintf(<span class="string">&quot;test%d&quot;</span>,i))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>;i &lt; <span class="number">100</span>;i++ &#123;</span><br><span class="line">		r, err := tree.Find(i, <span class="literal">false</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(r.Value)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// tree</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;================tree================&quot;</span>)</span><br><span class="line">	tree.PrintTree()</span><br><span class="line">	<span class="comment">// leaves</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;================leaves================&quot;</span>)</span><br><span class="line">	tree.PrintLeaves()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="10-å›¾"><a href="#10-å›¾" class="headerlink" title="10.å›¾"></a>10.å›¾</h1><h2 id="10-1-ç½‘"><a href="#10-1-ç½‘" class="headerlink" title="10.1 ç½‘"></a>10.1 ç½‘</h2><p>å¸¦æƒçš„å›¾å°±æ˜¯ç½‘</p>
<h2 id="10-2-å›¾çš„å­˜å‚¨ç»“æ„"><a href="#10-2-å›¾çš„å­˜å‚¨ç»“æ„" class="headerlink" title="10.2 å›¾çš„å­˜å‚¨ç»“æ„"></a>10.2 å›¾çš„å­˜å‚¨ç»“æ„</h2><h3 id="10-2-1-é‚»æ¥çŸ©é˜µ-é¡ºåºå­˜å‚¨"><a href="#10-2-1-é‚»æ¥çŸ©é˜µ-é¡ºåºå­˜å‚¨" class="headerlink" title="10.2.1 é‚»æ¥çŸ©é˜µ(é¡ºåºå­˜å‚¨)"></a>10.2.1 é‚»æ¥çŸ©é˜µ(é¡ºåºå­˜å‚¨)</h3><ol>
<li>é¡¶ç‚¹æ•°ç»„ï¼šå­˜å‚¨é¡¶ç‚¹ä¿¡æ¯</li>
<li>è¾¹æ•°ç»„:å­˜å‚¨é¡¶ç‚¹æ•°ç»„ä¸­2ä¸ªé¡¶ç‚¹å…³ç³»å’Œæƒ</li>
<li>å›¾{é¡¶ç‚¹æ•°ç»„ï¼Œè¾¹æ•°ç»„ï¼Œé¡¶ç‚¹æ•°ï¼Œè¾¹æ•°ï¼Œå›¾ç±»å‹}</li>
</ol>
<p>ä¸é€‚åˆ:æŸ¥æ‰¾é¡¶ç‚¹çš„åº¦ï¼Œéœ€è¦æ‰«ææ•´å¼ è¾¹æ•°ç»„ï¼Œæ•ˆç‡ä½ï¼Œå¯¹é¡¶ç‚¹çš„ç›¸å…³æ“ä½œ é€‚åˆ:å¯¹è¾¹ä¾æ¬¡è¿›è¡Œå¤„ç†çš„æ“ä½œï¼Œ</p>
<h3 id="10-2-2-é‚»æ¥è¡¨-é“¾å¼å­˜å‚¨"><a href="#10-2-2-é‚»æ¥è¡¨-é“¾å¼å­˜å‚¨" class="headerlink" title="10.2.2 é‚»æ¥è¡¨(é“¾å¼å­˜å‚¨)"></a>10.2.2 é‚»æ¥è¡¨(é“¾å¼å­˜å‚¨)</h3><ol>
<li>è¡¨å¤´ç»“ç‚¹ï¼šå­˜å‚¨é¡¶ç‚¹ä¿¡æ¯(data)å’Œç¬¬ä¸€ä¸ªé‚»æ¥ç‚¹åœ°å€(firstarc)ï¼Œä¸€èˆ¬é¡ºåºå­˜å‚¨åœ¨<strong>ä¸€ä¸ªæ•°ç»„ä¸­</strong></li>
<li>è¡¨ä¸­ç»“ç‚¹ï¼šå­˜å‚¨è¡¨å¤´ç»“ç‚¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®å’Œä¸‹ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œå¯å­˜å‚¨æƒå€¼</li>
<li>å›¾{è¡¨å¤´ç»“ç‚¹æ•°ç»„ï¼Œé¡¶ç‚¹æ•°ï¼Œè¾¹æ•°ï¼Œå›¾ç±»å‹}</li>
</ol>
<p>ç‰¹ç‚¹:</p>
<ol>
<li>å‡ºåº¦ä¸ºå„è‡ªé“¾è¡¨ä¸­çš„ç»“ç‚¹æ•°ï¼Œå…¥åº¦éœ€è¦éå†æ•´ä¸ªè¡¨çš„ç»“ç‚¹ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ±‚å…¥åº¦ï¼Œå»ºç«‹ä¸€ä¸ªé€†é‚»æ¥è¡¨</li>
<li>ç¨€ç–å›¾å­˜å‚¨æ—¶ï¼Œæ¯”ä½¿ç”¨é‚»æ¥çŸ©é˜µèŠ‚çœç©ºé—´</li>
</ol>
<h3 id="10-2-3-åå­—é“¾è¡¨-é“¾å¼å­˜å‚¨"><a href="#10-2-3-åå­—é“¾è¡¨-é“¾å¼å­˜å‚¨" class="headerlink" title="10.2.3 åå­—é“¾è¡¨(é“¾å¼å­˜å‚¨)"></a>10.2.3 åå­—é“¾è¡¨(é“¾å¼å­˜å‚¨)</h3><ol>
<li>é¡¶ç‚¹ç»“ç‚¹:å­˜å‚¨é¡¶ç‚¹ä¿¡æ¯(data) ä¸€ä¸ªå¼§å¤´ç»“ç‚¹æŒ‡é’ˆ(firstin)  ä¸€ä¸ªå¼§å°¾ç»“ç‚¹æŒ‡é’ˆ(firstout)</li>
<li>å¼§ç»“ç‚¹:tailvex å’Œ headvex åˆ†åˆ«å­˜å‚¨çš„æ˜¯å¼§å°¾å’Œå¼§å¤´å¯¹åº”çš„é¡¶ç‚¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®ä¸‹æ ‡ï¼› hlink å’Œ tlink ä¸ºæŒ‡é’ˆåŸŸï¼Œåˆ†åˆ«æŒ‡å‘å¼§å¤´ç›¸åŒçš„ä¸‹ä¸€ä¸ªå¼§å’Œå¼§å°¾ç›¸åŒçš„ä¸‹ä¸€ä¸ªå¼§ï¼› info ä¸ºæŒ‡é’ˆåŸŸï¼Œå­˜å‚¨çš„æ˜¯è¯¥å¼§å…·æœ‰çš„ç›¸å…³ä¿¡æ¯ï¼Œä¾‹å¦‚æƒå€¼ç­‰</li>
<li>å›¾{é¡¶ç‚¹ç»“ç‚¹æ•°ç»„ï¼Œå¼§æ•°ï¼Œé¡¶ç‚¹æ•°}</li>
</ol>
<p>ç‰¹ç‚¹:</p>
<ol>
<li>å­˜å‚¨çš„æ˜¯æœ‰å‘å›¾æˆ–è€…æœ‰å‘ç½‘</li>
<li>æ±‚å…¥åº¦å‡ºåº¦æ–¹ä¾¿ï¼Œå…¥åº¦ä¸ºå¼§å¤´çš„æ•°é‡ï¼Œå‡ºåº¦ä¸ºå¼§å°¾çš„æ•°é‡</li>
<li>ç¨‹åºä¸­æ„å»ºé“¾è¡¨å¯¹äºæ¯ä¸ªæ–°åˆå§‹åŒ–çš„ç»“ç‚¹é‡‡ç”¨å¤´æ’æ³•è¿›è¡Œæ’å…¥</li>
</ol>
<h3 id="10-2-4-é‚»æ¥å¤šé‡è¡¨-é“¾å¼å­˜å‚¨"><a href="#10-2-4-é‚»æ¥å¤šé‡è¡¨-é“¾å¼å­˜å‚¨" class="headerlink" title="10.2.4 é‚»æ¥å¤šé‡è¡¨(é“¾å¼å­˜å‚¨)"></a>10.2.4 é‚»æ¥å¤šé‡è¡¨(é“¾å¼å­˜å‚¨)</h3><p>é‚»æ¥å¤šé‡è¡¨å¯ä»¥çœ‹åšæ˜¯é‚»æ¥è¡¨å’Œåå­—é“¾è¡¨çš„ç»“åˆä½“</p>
<p>ä½¿ç”¨é‚»æ¥è¡¨è§£å†³åœ¨æ— å‘å›¾ä¸­åˆ é™¤æŸä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„è¾¹çš„æ“ä½œæ—¶ï¼Œç”±äºè¡¨ç¤ºè¾¹çš„ç»“ç‚¹åˆ†åˆ«å¤„åœ¨ä¸¤ä¸ªé¡¶ç‚¹ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ä¸­ï¼Œæ‰€ä»¥éœ€è¦éƒ½æ‰¾åˆ°å¹¶åˆ é™¤ï¼Œæ“ä½œæ¯”è¾ƒéº»çƒ¦ã€‚å¤„ç†ç±»ä¼¼è¿™ç§æ“ä½œï¼Œä½¿ç”¨é‚»æ¥å¤šé‡è¡¨ä¼šæ›´åˆé€‚ã€‚</p>
<ol>
<li>è¡¨ç»“ç‚¹æ„æˆï¼š</li>
</ol>
<p>mark ä¸ºæ ‡å¿—åŸŸï¼Œä½œç”¨æ˜¯æ ‡è®°æŸç»“ç‚¹æ˜¯å¦å·²ç»è¢«æ“ä½œè¿‡ï¼Œä¾‹å¦‚åœ¨éå†å„ç»“ç‚¹æ—¶ï¼Œ mark åŸŸä¸º 0 è¡¨ç¤ºè¿˜æœªéå†ï¼›mark åŸŸä¸º 1 è¡¨ç¤ºè¯¥ç»“ç‚¹éå†è¿‡ï¼› ivex å’Œ jvex åˆ†åˆ«è¡¨ç¤ºè¯¥ç»“ç‚¹è¡¨ç¤ºçš„è¾¹ä¸¤ç«¯çš„é¡¶ç‚¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®ä¸‹æ ‡ï¼› ilink æŒ‡å‘ä¸‹ä¸€æ¡ä¸ ivex ç›¸å…³çš„è¾¹ï¼› jlink æŒ‡å‘ä¸‹ä¸€æ¡ä¸ jvex ç›¸å…³çš„è¾¹ï¼› info æŒ‡å‘ä¸è¯¥è¾¹ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<ol>
<li>é¡¶ç‚¹ç»“ç‚¹æ„æˆï¼š</li>
</ol>
<p>data ä¸ºè¯¥é¡¶ç‚¹çš„æ•°æ®åŸŸï¼› firstedge ä¸ºæŒ‡å‘ç¬¬ä¸€æ¡è·Ÿè¯¥é¡¶ç‚¹æœ‰å…³ç³»çš„è¾¹ã€‚</p>
<h3 id="10-2-5-æ€»ç»“"><a href="#10-2-5-æ€»ç»“" class="headerlink" title="10.2.5 æ€»ç»“"></a>10.2.5 æ€»ç»“</h3><ol>
<li>é‚»æ¥è¡¨é€‚ç”¨äºæ‰€æœ‰çš„å›¾ç»“æ„ï¼Œæ— è®ºæ˜¯æœ‰å‘å›¾ï¼ˆç½‘ï¼‰è¿˜æ˜¯æ— å‘å›¾ï¼ˆç½‘ï¼‰ï¼Œå­˜å‚¨ç»“æ„è¾ƒä¸ºç®€å•ï¼Œä½†æ˜¯åœ¨å­˜å‚¨ä¸€äº›é—®é¢˜æ—¶ï¼Œä¾‹å¦‚è®¡ç®—æŸé¡¶ç‚¹çš„åº¦ï¼Œéœ€è¦é€šè¿‡éå†çš„æ–¹å¼è‡ªå·±æ±‚å¾—</li>
<li>åå­—é“¾è¡¨é€‚ç”¨äºæœ‰å‘å›¾ï¼ˆç½‘ï¼‰çš„å­˜å‚¨ï¼Œä½¿ç”¨è¯¥æ–¹å¼å­˜å‚¨çš„æœ‰å‘å›¾ï¼Œå¯ä»¥å¾ˆå®¹æ˜“è®¡ç®—å‡ºé¡¶ç‚¹çš„å‡ºåº¦å’Œå…¥åº¦ï¼Œåªéœ€è¦çŸ¥é“å¯¹åº”é“¾è¡¨ä¸­çš„ç»“ç‚¹ä¸ªæ•°å³å¯</li>
<li>é‚»æ¥å¤šé‡è¡¨é€‚ç”¨äºæ— å‘å›¾ï¼ˆç½‘ï¼‰çš„å­˜å‚¨ï¼Œè¯¥æ–¹å¼é¿å…äº†ä½¿ç”¨é‚»æ¥è¡¨å­˜å‚¨æ— å‘å›¾æ—¶å‡ºç°çš„å­˜å‚¨ç©ºé—´æµªè´¹çš„ç°è±¡ï¼ŒåŒæ—¶ç›¸æ¯”é‚»æ¥è¡¨å­˜å‚¨æ— å‘å›¾ï¼Œæ›´æ–¹ä¾¿äº†æŸäº›è¾¹æ“ä½œï¼ˆéå†ã€åˆ é™¤ç­‰ï¼‰çš„å®ç°</li>
</ol>
<h2 id="10-3-æœ‰å‘æ— å‘å›¾"><a href="#10-3-æœ‰å‘æ— å‘å›¾" class="headerlink" title="10.3 æœ‰å‘æ— å‘å›¾"></a>10.3 æœ‰å‘æ— å‘å›¾</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Infinity <span class="type">int</span> = <span class="number">65535</span> <span class="comment">//æ— ç©·å¤§</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//éçº¿ç¨‹å®‰å…¨</span></span><br><span class="line"><span class="keyword">type</span> VertexId <span class="type">uint</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Vertices []VertexId</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Edge <span class="keyword">struct</span> &#123;</span><br><span class="line">	From VertexId</span><br><span class="line">	To   VertexId</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> graph <span class="keyword">struct</span> &#123;</span><br><span class="line">	edges      <span class="keyword">map</span>[VertexId]<span class="keyword">map</span>[VertexId]<span class="type">int</span></span><br><span class="line">	edgesCount <span class="type">int</span></span><br><span class="line">	isDirected <span class="type">bool</span> <span class="comment">//å®šå‘å›¾</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> EdgesIterable <span class="keyword">interface</span> &#123;</span><br><span class="line">	EdgesIter() &lt;-<span class="keyword">chan</span> Edge</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> VerticesIterable <span class="keyword">interface</span> &#123;</span><br><span class="line">	VerticesIter() &lt;-<span class="keyword">chan</span> VertexId</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> EdgesIter() &lt;-<span class="keyword">chan</span> Edge &#123;</span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> Edge)</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> from, connectedVertices := <span class="keyword">range</span> g.edges &#123;</span><br><span class="line">			<span class="keyword">for</span> to, _ := <span class="keyword">range</span> connectedVertices &#123;</span><br><span class="line">				<span class="keyword">if</span> g.isDirected &#123; <span class="comment">//æœ‰å‘è¾¹</span></span><br><span class="line">					ch &lt;- Edge&#123;from, to&#125;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">if</span> from &lt; to &#123; <span class="comment">//æ— å‘è¾¹ï¼Œåªè¾“å‡ºä¸€æ¬¡</span></span><br><span class="line">						ch &lt;- Edge&#123;from, to&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">close</span>(ch)</span><br><span class="line">	&#125;()</span><br><span class="line">	<span class="keyword">return</span> ch</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é¡¶ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> VerticesIter() &lt;-<span class="keyword">chan</span> VertexId &#123;</span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> VertexId)</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> vertex, _ := <span class="keyword">range</span> g.edges &#123;</span><br><span class="line">			ch &lt;- vertex</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">close</span>(ch)</span><br><span class="line">	&#125;()</span><br><span class="line">	<span class="keyword">return</span> ch</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€æŸ¥é¡¶ç‚¹æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> CheckVertex(vertex VertexId) <span class="type">bool</span> &#123;</span><br><span class="line">	_, exists := g.edges[vertex]</span><br><span class="line">	<span class="keyword">return</span> exists</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¢åŠ é¡¶ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> AddVertex(vertex VertexId) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckVertex(vertex) &#123;</span><br><span class="line">		g.edges[vertex] = <span class="built_in">make</span>(<span class="keyword">map</span>[VertexId]<span class="type">int</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;Vertex already exists&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤é¡¶ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> RemoveVertex(vertex VertexId) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckVertex(vertex) &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;unknow vertex&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å…ˆåˆ é™¤è¾¹</span></span><br><span class="line">	<span class="keyword">for</span> _to, _ := <span class="keyword">range</span> g.edges[vertex] &#123;</span><br><span class="line">		g.RemoveEdge(vertex, _to)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">delete</span>(g.edges, vertex)</span><br><span class="line">	<span class="keyword">for</span> _, connectedVertices := <span class="keyword">range</span> g.edges &#123;</span><br><span class="line">		<span class="built_in">delete</span>(connectedVertices, vertex)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»Ÿè®¡é¡¶ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> VerticesCount() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(g.edges)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­è¾¹æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> CheckEdge(from, to VertexId) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> _, ok := g.edges[from][to]; ok &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¢åŠ è¾¹,å­˜åœ¨å°±ä¿®æ”¹æƒ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> AddEdge(from, to VertexId, weight <span class="type">int</span>) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="comment">//è‡ªèº«å¾ªç¯</span></span><br><span class="line">	<span class="keyword">if</span> from == to &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;cannot add self loop&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ä¸å­˜åœ¨è¾¹</span></span><br><span class="line">	<span class="keyword">if</span> !g.CheckVertex(from) || !g.CheckVertex(to) &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;vertices not exist&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//åˆ¤æ–­è¾¹å­˜åœ¨ä¸</span></span><br><span class="line">	<span class="keyword">if</span> g.edges[from][to] &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;edge  exist&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	g.edges[from][to] = weight</span><br><span class="line">	<span class="keyword">if</span> !g.isDirected &#123;</span><br><span class="line">		g.edges[to][from] = weight</span><br><span class="line">	&#125;</span><br><span class="line">	g.edgesCount++</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤è¾¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> RemoveEdge(from, to VertexId) <span class="type">error</span> &#123;</span><br><span class="line">	<span class="comment">//åˆ¤æ–­è¾¹æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(from, to) &#123;</span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">&quot;edge not exist&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//åˆ é™¤</span></span><br><span class="line">	<span class="built_in">delete</span>(g.edges[from], to)</span><br><span class="line">	<span class="keyword">if</span> !g.isDirected &#123;</span><br><span class="line">		<span class="built_in">delete</span>(g.edges[to], from)</span><br><span class="line">	&#125;</span><br><span class="line">	g.edgesCount--</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»Ÿè®¡è¾¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> EdgesCount() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> g.edgesCount</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–è¾¹æƒ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> GetEdgeWeight(from, to VertexId) <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(from, to) &#123;</span><br><span class="line">		<span class="keyword">return</span> Infinity</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> g.edges[from][to]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–é‚»ç»“ç‚¹å’Œæƒ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> GetNeighbours(vertex VertexId) VerticesIterable &#123;</span><br><span class="line">	iterator := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &lt;-<span class="keyword">chan</span> VertexId &#123;</span><br><span class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> VertexId)</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> connected, ok := g.edges[vertex]; ok &#123;</span><br><span class="line">				<span class="keyword">for</span> vid, _ := <span class="keyword">range</span> connected &#123;</span><br><span class="line">					ch &lt;- vid</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">close</span>(ch)</span><br><span class="line">		&#125;()</span><br><span class="line">		<span class="keyword">return</span> ch</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> VerticesIterable(&amp;VerticesIterableHelp&#123;iter: iterator&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¸®åŠ©è·å–</span></span><br><span class="line"><span class="keyword">type</span> VerticesIterableHelp <span class="keyword">struct</span> &#123;</span><br><span class="line">	iter <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &lt;-<span class="keyword">chan</span> VertexId</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *VerticesIterableHelp)</span></span> VerticesIter() &lt;-<span class="keyword">chan</span> VertexId &#123;</span><br><span class="line">	<span class="keyword">return</span> v.iter()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> DirGraph <span class="keyword">struct</span> &#123;</span><br><span class="line">	graph</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//================æœ‰å‘å›¾=======================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewDirected</span><span class="params">()</span></span> *DirGraph &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;DirGraph&#123;</span><br><span class="line">		graph&#123;</span><br><span class="line">			edgesCount: <span class="number">0</span>,</span><br><span class="line">			edges:      <span class="built_in">make</span>(<span class="keyword">map</span>[VertexId]<span class="keyword">map</span>[VertexId]<span class="type">int</span>),</span><br><span class="line">			isDirected: <span class="literal">true</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…¥åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> GetPredecessors(vertex VertexId) VerticesIterable &#123;</span><br><span class="line">	iterator := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &lt;-<span class="keyword">chan</span> VertexId &#123;</span><br><span class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> VertexId)</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">for</span> VertexId, _ := <span class="keyword">range</span> g.edges &#123;</span><br><span class="line">				<span class="keyword">if</span> g.CheckEdge(VertexId, vertex) &#123;</span><br><span class="line">					ch &lt;- VertexId</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">close</span>(ch)</span><br><span class="line">		&#125;()</span><br><span class="line">		<span class="keyword">return</span> ch</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> VerticesIterable(&amp;VerticesIterableHelp&#123;iter: iterator&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡ºåº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> GetSuccessors(vertex VertexId) VerticesIterable &#123;</span><br><span class="line">	iterator := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &lt;-<span class="keyword">chan</span> VertexId &#123;</span><br><span class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> VertexId)</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> connected, ok := g.edges[vertex]; ok &#123;</span><br><span class="line">				<span class="keyword">for</span> VertexId, _ := <span class="keyword">range</span> connected &#123;</span><br><span class="line">					<span class="keyword">if</span> g.CheckEdge(vertex, VertexId) &#123;</span><br><span class="line">						ch &lt;- VertexId</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">close</span>(ch)</span><br><span class="line">		&#125;()</span><br><span class="line">		<span class="keyword">return</span> ch</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> VerticesIterable(&amp;VerticesIterableHelp&#123;iter: iterator&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *DirGraph)</span></span> Reverse() *DirGraph &#123;</span><br><span class="line">	r := NewDirected()</span><br><span class="line"></span><br><span class="line">	vertices := g.VerticesIter()</span><br><span class="line">	<span class="keyword">for</span> vertex := <span class="keyword">range</span> vertices &#123;</span><br><span class="line">		r.AddVertex(vertex)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	edges := g.EdgesIter()</span><br><span class="line">	<span class="keyword">for</span> edge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		r.AddEdge(edge.To, edge.From, <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//================æ— å‘å›¾=======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UnGraph <span class="keyword">struct</span> &#123;</span><br><span class="line">	graph</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewUndirected</span><span class="params">()</span></span> *UnGraph &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;UnGraph&#123;</span><br><span class="line">		graph&#123;</span><br><span class="line">			edgesCount: <span class="number">0</span>,</span><br><span class="line">			edges:      <span class="built_in">make</span>(<span class="keyword">map</span>[VertexId]<span class="keyword">map</span>[VertexId]<span class="type">int</span>),</span><br><span class="line">			isDirected: <span class="literal">false</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	TestNewUndirected()</span><br><span class="line">	TestNewDirected()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestNewUndirected</span><span class="params">()</span></span> &#123;</span><br><span class="line">	g := NewUndirected()</span><br><span class="line">	<span class="comment">//å¢åŠ é¡¶ç‚¹</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		g.AddVertex(VertexId(i))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> g.VerticesCount() != <span class="number">10</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;count err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å¢åŠ è¾¹</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		_ = g.AddEdge(VertexId(i), VertexId(i%<span class="number">2</span>), <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(<span class="number">2</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">2</span>, <span class="number">1</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.GetEdgeWeight(<span class="number">2</span>, <span class="number">0</span>) != <span class="number">1</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆ é™¤é¡¶ç‚¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.RemoveVertex(VertexId(<span class="number">2</span>));err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckVertex(VertexId(<span class="number">2</span>)) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">2</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//å¢åŠ è¾¹ï¼Œå­˜åœ¨ä¿®æ”¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.AddEdge(<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>);err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(<span class="number">3</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆ é™¤è¾¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.RemoveEdge(<span class="number">3</span>, <span class="number">0</span>);err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">3</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ç»Ÿè®¡è¾¹</span></span><br><span class="line">	c := g.EdgesIter()</span><br><span class="line">	countEdge := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _ = <span class="keyword">range</span> c &#123;</span><br><span class="line">		countEdge++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> g.EdgesCount() != countEdge &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestNewDirected</span><span class="params">()</span></span> &#123;</span><br><span class="line">	g := NewDirected()</span><br><span class="line">	<span class="comment">//å¢åŠ é¡¶ç‚¹</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		g.AddVertex(VertexId(i))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.VerticesCount() != <span class="number">10</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;count err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å¢åŠ è¾¹</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		g.AddEdge(VertexId(i), VertexId(i%<span class="number">2</span>), <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(<span class="number">2</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">2</span>, <span class="number">1</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.GetEdgeWeight(<span class="number">2</span>, <span class="number">0</span>) != <span class="number">1</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//åˆ é™¤é¡¶ç‚¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.RemoveVertex(VertexId(<span class="number">2</span>));err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckVertex(VertexId(<span class="number">2</span>)) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">2</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å¢åŠ è¾¹ï¼Œå­˜åœ¨ä¿®æ”¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.AddEdge(<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>);err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !g.CheckEdge(<span class="number">3</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//åˆ é™¤è¾¹</span></span><br><span class="line">	<span class="keyword">if</span> err := g.RemoveEdge(<span class="number">3</span>, <span class="number">0</span>);err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> g.CheckEdge(<span class="number">3</span>, <span class="number">0</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ç»Ÿè®¡è¾¹</span></span><br><span class="line">	c := g.EdgesIter()</span><br><span class="line">	countEdge := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _ = <span class="keyword">range</span> c &#123;</span><br><span class="line">		countEdge++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> g.EdgesCount() != countEdge &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æŸ¥çœ‹</span></span><br><span class="line">	<span class="comment">//for p := range g.EdgesIter() &#123;</span></span><br><span class="line">	<span class="comment">//	t.Log(p)</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//å…¥åº¦</span></span><br><span class="line">	gp := g.GetPredecessors(VertexId(<span class="number">1</span>)).VerticesIter()</span><br><span class="line">	<span class="keyword">for</span> p := <span class="keyword">range</span> gp &#123;</span><br><span class="line">		<span class="keyword">if</span> p != <span class="number">3</span> &amp;&amp; p != <span class="number">5</span> &amp;&amp; p != <span class="number">7</span> &amp;&amp; p != <span class="number">9</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> p := <span class="keyword">range</span> g.GetSuccessors(VertexId(<span class="number">4</span>)).VerticesIter() &#123;</span><br><span class="line">		<span class="keyword">if</span> p != VertexId(<span class="number">0</span>) &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;err&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="11-æœ€çŸ­è·¯å¾„"><a href="#11-æœ€çŸ­è·¯å¾„" class="headerlink" title="11.æœ€çŸ­è·¯å¾„"></a>11.æœ€çŸ­è·¯å¾„</h1><h2 id="11-1-Dijkstra"><a href="#11-1-Dijkstra" class="headerlink" title="11.1 Dijkstra"></a>11.1 Dijkstra</h2><p> Dijkstraç®—æ³•é€‚ç”¨äºè¾¹æƒä¸ºæ­£çš„æ— å‘å’Œæœ‰å‘å›¾,ä¸é€‚ç”¨äºæœ‰è´Ÿè¾¹æƒçš„å›¾ </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	hp <span class="string">&quot;container/heap&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> edge <span class="keyword">struct</span> &#123;</span><br><span class="line">	node   <span class="type">string</span></span><br><span class="line">	weight <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> graph <span class="keyword">struct</span> &#123;</span><br><span class="line">	nodes <span class="keyword">map</span>[<span class="type">string</span>][]edge</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newGraph</span><span class="params">()</span></span> *graph &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;graph&#123;nodes: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>][]edge)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> addEdge(origin, destiny <span class="type">string</span>, weight <span class="type">int</span>) &#123;</span><br><span class="line">	g.nodes[origin] = <span class="built_in">append</span>(g.nodes[origin], edge&#123;node: destiny, weight: weight&#125;)</span><br><span class="line">	g.nodes[destiny] = <span class="built_in">append</span>(g.nodes[destiny], edge&#123;node: origin, weight: weight&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> getEdges(node <span class="type">string</span>) []edge &#123;</span><br><span class="line">	<span class="keyword">return</span> g.nodes[node]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graph)</span></span> Dijkstra(origin, destiny <span class="type">string</span>) (<span class="type">int</span>, []<span class="type">string</span>) &#123;</span><br><span class="line">	h := newHeap()</span><br><span class="line">	h.push(path&#123;value: <span class="number">0</span>, nodes: []<span class="type">string</span>&#123;origin&#125;&#125;)</span><br><span class="line">	visited := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(*h.values) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// Find the nearest yet to visit node</span></span><br><span class="line">		p := h.pop()</span><br><span class="line">		node := p.nodes[<span class="built_in">len</span>(p.nodes)<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> visited[node] &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> node == destiny &#123;</span><br><span class="line">			<span class="keyword">return</span> p.value, p.nodes</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> _, e := <span class="keyword">range</span> g.getEdges(node) &#123;</span><br><span class="line">			<span class="keyword">if</span> !visited[e.node] &#123;</span><br><span class="line">				<span class="comment">// We calculate the total spent so far plus the cost and the path of getting here</span></span><br><span class="line">				h.push(path&#123;value: p.value + e.weight, nodes: <span class="built_in">append</span>([]<span class="type">string</span>&#123;&#125;, <span class="built_in">append</span>(p.nodes, e.node)...)&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		visited[node] = <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> path <span class="keyword">struct</span> &#123;</span><br><span class="line">	value <span class="type">int</span></span><br><span class="line">	nodes []<span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> minPath []path</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h minPath)</span></span> Len() <span class="type">int</span>           &#123; <span class="keyword">return</span> <span class="built_in">len</span>(h) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h minPath)</span></span> Less(i, j <span class="type">int</span>) <span class="type">bool</span> &#123; <span class="keyword">return</span> h[i].value &lt; h[j].value &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h minPath)</span></span> Swap(i, j <span class="type">int</span>)      &#123; h[i], h[j] = h[j], h[i] &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *minPath)</span></span> Push(x <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	*h = <span class="built_in">append</span>(*h, x.(path))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *minPath)</span></span> Pop() <span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	old := *h</span><br><span class="line">	n := <span class="built_in">len</span>(old)</span><br><span class="line">	x := old[n<span class="number">-1</span>]</span><br><span class="line">	*h = old[<span class="number">0</span> : n<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> heap <span class="keyword">struct</span> &#123;</span><br><span class="line">	values *minPath</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newHeap</span><span class="params">()</span></span> *heap &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;heap&#123;values: &amp;minPath&#123;&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *heap)</span></span> push(p path) &#123;</span><br><span class="line">	hp.Push(h.values, p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *heap)</span></span> pop() path &#123;</span><br><span class="line">	i := hp.Pop(h.values)</span><br><span class="line">	<span class="keyword">return</span> i.(path)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Dijkstra&quot;</span>)</span><br><span class="line">	<span class="comment">// Example</span></span><br><span class="line">	graph := newGraph()</span><br><span class="line">	graph.addEdge(<span class="string">&quot;S&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="number">4</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;S&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="number">2</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="number">1</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">5</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;C&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">10</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">2</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="number">6</span>)</span><br><span class="line">	graph.addEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="number">2</span>)</span><br><span class="line">	fmt.Println(graph.Dijkstra(<span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="11-2-Prim"><a href="#11-2-Prim" class="headerlink" title="11.2 Prim"></a>11.2 Prim</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="comment">//&quot;github.com/davecgh/go-spew/spew&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> node <span class="keyword">struct</span> &#123;</span><br><span class="line">	id <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Edge <span class="keyword">struct</span> &#123;</span><br><span class="line">	src    Node</span><br><span class="line">	dst    Node</span><br><span class="line">	weight <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Graph <span class="keyword">struct</span> &#123;</span><br><span class="line">	sync.RWMutex</span><br><span class="line">	edge    <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">float64</span></span><br><span class="line">	nodeMap <span class="keyword">map</span>[<span class="type">string</span>]Node <span class="comment">// record all the node in a graph</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">interface</span> &#123;</span><br><span class="line">	NodeID() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewNode</span><span class="params">(id <span class="type">string</span>)</span></span> Node &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;node&#123;id: id&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> NodeID() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n.id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewEdge</span><span class="params">(src Node, dst Node, w <span class="type">float64</span>)</span></span> *Edge &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Edge&#123;src: src, dst: dst, weight: w&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewGraph</span><span class="params">()</span></span> *Graph &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Graph&#123;</span><br><span class="line">		edge:    <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">float64</span>),</span><br><span class="line">		nodeMap: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]Node),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Graph)</span></span> AddEdge(nodeID1 <span class="type">string</span>, nodeID2 <span class="type">string</span>, w <span class="type">float64</span>) &#123;</span><br><span class="line">	g.Lock()</span><br><span class="line">	<span class="keyword">defer</span> g.Unlock()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> nodeID1 == nodeID2 &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;can&#x27;t add same vertex in one edge&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> w == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;weight can&#x27;t use 0&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// record each vertex</span></span><br><span class="line">	g.nodeMap[nodeID1] = NewNode(nodeID1)</span><br><span class="line">	g.nodeMap[nodeID2] = NewNode(nodeID2)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> _, ok := g.edge[nodeID1]; ok &#123;</span><br><span class="line">		g.edge[nodeID1][nodeID2] = w</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		tempMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">float64</span>)</span><br><span class="line">		tempMap[nodeID2] = w</span><br><span class="line">		g.edge[nodeID1] = tempMap</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	g := NewGraph()</span><br><span class="line">	g.AddEdge(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="number">7</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">5</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="number">7</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">9</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;B&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">7</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;C&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;C&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">5</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="number">5</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="number">9</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="number">6</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">15</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="number">6</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="number">7</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="number">5</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">15</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="number">9</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;F&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">6</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;F&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="number">11</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;G&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="number">9</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;G&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(g)</span><br><span class="line">	g.Prim(<span class="string">&quot;D&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Graph)</span></span> Prim(src <span class="type">string</span>) &#123;</span><br><span class="line">	knowNode := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">string</span>)</span><br><span class="line">	unknowNode := g.nodeMap</span><br><span class="line">	tempEdgeMap := g.edge</span><br><span class="line">	edgeMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]*Edge)</span><br><span class="line">	totalWeight := <span class="type">float64</span>(<span class="number">0</span>)</span><br><span class="line">	key := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	knowNode[key] = src</span><br><span class="line">	<span class="built_in">delete</span>(unknowNode, knowNode[key])</span><br><span class="line">	key++</span><br><span class="line">	<span class="keyword">var</span> temp <span class="type">string</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ‰¾åˆ°ä¸knowNodeMapé‡ŒèŠ‚ç‚¹æƒå€¼æœ€å°çš„èŠ‚ç‚¹ï¼Œå¹¶å°†è¯¥èŠ‚ç‚¹åŠ å…¥nodeMap</span></span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">len</span>(unknowNode) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		min := <span class="type">float64</span>(<span class="number">1000000</span>)</span><br><span class="line">		<span class="keyword">for</span> nodeID := <span class="keyword">range</span> unknowNode &#123;</span><br><span class="line">			<span class="keyword">for</span> _, v := <span class="keyword">range</span> knowNode &#123;</span><br><span class="line">				<span class="keyword">if</span> tempEdgeMap[nodeID][v] &lt; min &amp;&amp; tempEdgeMap[nodeID][v] != <span class="number">0</span> &#123;</span><br><span class="line">					min = tempEdgeMap[nodeID][v]</span><br><span class="line">					knowNode[key] = nodeID</span><br><span class="line">					temp = v</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		n1 := NewNode(temp)</span><br><span class="line">		n2 := NewNode(knowNode[key])</span><br><span class="line">		edge := NewEdge(n1, n2, min)</span><br><span class="line">		edgeMap[key<span class="number">-1</span>] = edge</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ä»æœªçŸ¥èŠ‚ç‚¹mapåˆ é™¤å·²ç»æ‰¾åˆ°çš„å½“å‰æƒå€¼æœ€å°çš„èŠ‚ç‚¹</span></span><br><span class="line">		<span class="built_in">delete</span>(unknowNode, knowNode[key])</span><br><span class="line">		totalWeight += min</span><br><span class="line">		key++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(totalWeight)</span><br><span class="line">	fmt.Println(knowNode)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="11-3-Kruskal"><a href="#11-3-Kruskal" class="headerlink" title="11.3 Kruskal"></a>11.3 Kruskal</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;container/heap&quot;</span></span><br><span class="line">	<span class="string">&quot;container/list&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;sort&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Edge is a connection bitween two vertecies. Every edge has a weight between the vertecies.</span></span><br><span class="line"><span class="keyword">type</span> Edge <span class="keyword">struct</span> &#123;</span><br><span class="line">	source <span class="type">string</span></span><br><span class="line">	sink   <span class="type">string</span></span><br><span class="line">	weight <span class="type">float32</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> edgeSlice []Edge</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e edgeSlice)</span></span> Len() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e edgeSlice)</span></span> Less(i, j <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> e[i].weight &lt; e[j].weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e edgeSlice)</span></span> Swap(i, j <span class="type">int</span>) &#123;</span><br><span class="line">	e[i], e[j] = e[j], e[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sortEdges</span><span class="params">(edges []Edge)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> readyToSort edgeSlice = edges</span><br><span class="line">	sort.Sort(readyToSort)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Graph is a complete graph with vertecies and edges between them.</span></span><br><span class="line"><span class="keyword">type</span> Graph <span class="keyword">struct</span> &#123;</span><br><span class="line">	vertecies <span class="keyword">map</span>[<span class="type">string</span>][]Edge</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AddVertex adds a vertex to the graph</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Graph)</span></span> AddVertex(vertex <span class="type">string</span>) &#123;</span><br><span class="line">	g.vertecies[vertex] = <span class="built_in">make</span>([]Edge, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AddEdge adds an edge to the graph</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Graph)</span></span> AddEdge(source <span class="type">string</span>, sink <span class="type">string</span>, weight <span class="type">float32</span>) &#123;</span><br><span class="line">	edge := Edge&#123;source, sink, weight&#125;</span><br><span class="line">	g.vertecies[source] = <span class="built_in">append</span>(g.vertecies[source], edge)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Graph)</span></span> getVertecies() []<span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> edges = <span class="built_in">make</span>([]<span class="type">string</span>, <span class="built_in">len</span>(g.vertecies))</span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> g.vertecies &#123;</span><br><span class="line">		edges[i] = k</span><br><span class="line">		i++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> edges</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g Graph)</span></span> getEdges(vertex <span class="type">string</span>) ([]Edge, <span class="type">bool</span>) &#123;</span><br><span class="line">	edges, ok := g.vertecies[vertex]</span><br><span class="line">	<span class="keyword">return</span> edges, ok</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> vertexQueue []<span class="type">string</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(vq vertexQueue)</span></span> Len() <span class="type">int</span>            &#123; <span class="keyword">return</span> <span class="built_in">len</span>(vq) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(vq vertexQueue)</span></span> Less(i, j <span class="type">int</span>) <span class="type">bool</span>  &#123; <span class="keyword">return</span> vq[i] &lt; vq[j] &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(vq vertexQueue)</span></span> Swap(i, j <span class="type">int</span>)       &#123; vq[i], vq[j] = vq[j], vq[i] &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(vq *vertexQueue)</span></span> Push(x <span class="keyword">interface</span>&#123;&#125;) &#123; *vq = <span class="built_in">append</span>(*vq, x.(<span class="type">string</span>)) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(vq *vertexQueue)</span></span> Pop() <span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">	items := *vq</span><br><span class="line">	n := <span class="built_in">len</span>(*vq)</span><br><span class="line">	x := items[n<span class="number">-1</span>]</span><br><span class="line">	*vq = items[<span class="number">0</span> : n<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">graphContainsNoCycles</span><span class="params">(g traverseGraph, from, to <span class="type">string</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> depthFirstSearch(g, from, to) == <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">depthFirstSearch</span><span class="params">(g traverseGraph, from, to <span class="type">string</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	verteciesNext := <span class="built_in">make</span>(vertexQueue, <span class="number">0</span>)</span><br><span class="line">	heap.Init(&amp;verteciesNext)</span><br><span class="line">	heap.Push(&amp;verteciesNext, from)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> verteciesNext.Len() &gt; <span class="number">0</span> &#123;</span><br><span class="line">		vertex := heap.Pop(&amp;verteciesNext).(<span class="type">string</span>)</span><br><span class="line">		edges, hasVertex := g.vertecies[vertex]</span><br><span class="line">		<span class="keyword">if</span> hasVertex &#123;</span><br><span class="line">			<span class="keyword">for</span> e := edges.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">				edge := e.Value.(Edge)</span><br><span class="line">				<span class="keyword">if</span> edge.sink == to &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				heap.Push(&amp;verteciesNext, edge.sink)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addUndirectedEdge</span><span class="params">(tg *traverseGraph, edge Edge)</span></span> &#123;</span><br><span class="line">	addEdge(tg, edge)</span><br><span class="line">	reverseEdge := Edge&#123;edge.sink, edge.source, edge.weight&#125;</span><br><span class="line">	addEdge(tg, reverseEdge)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addEdge</span><span class="params">(tg *traverseGraph, x Edge)</span></span> &#123;</span><br><span class="line">	edgesForVertex, hasVertex := tg.vertecies[x.source]</span><br><span class="line">	<span class="keyword">if</span> !hasVertex &#123;</span><br><span class="line">		edgesForVertex = list.New()</span><br><span class="line">		tg.vertecies[x.source] = edgesForVertex</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	edgesForVertex.PushBack(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getUniqueEdges</span><span class="params">(g *Graph, vertecies []<span class="type">string</span>)</span></span> []Edge &#123;</span><br><span class="line">	edges := <span class="built_in">make</span>([]Edge, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> _, vertex := <span class="keyword">range</span> vertecies &#123;</span><br><span class="line">		edgeInVertex, hasVertex := g.getEdges(vertex)</span><br><span class="line">		<span class="keyword">if</span> hasVertex &#123;</span><br><span class="line">			<span class="keyword">for</span> _, edge := <span class="keyword">range</span> edgeInVertex &#123;</span><br><span class="line">				has := <span class="literal">false</span></span><br><span class="line">				<span class="keyword">for</span> _, e := <span class="keyword">range</span> edges &#123;</span><br><span class="line">					has = has || e == edge</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> has == <span class="literal">false</span> &#123;</span><br><span class="line">					edges = <span class="built_in">append</span>(edges, edge)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> edges</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Kruskals performs kruskal&#x27;s algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Kruskals</span><span class="params">(g *Graph)</span></span> []Edge &#123;</span><br><span class="line">	vertecies := g.getVertecies()</span><br><span class="line">	numVertecies := <span class="built_in">len</span>(vertecies)</span><br><span class="line"></span><br><span class="line">	edges := getUniqueEdges(g, vertecies)</span><br><span class="line">	sortEdges(edges)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> gCopy = createEmptyGraphWithVertecies(*g)</span><br><span class="line"></span><br><span class="line">	traversedVertecies := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>)</span><br><span class="line">	a := <span class="built_in">make</span>([]Edge, numVertecies<span class="number">-1</span>) <span class="comment">// resulting set</span></span><br><span class="line">	it := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, currentEdge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		_, hasSource := traversedVertecies[currentEdge.source]</span><br><span class="line">		_, hasSink := traversedVertecies[currentEdge.sink]</span><br><span class="line">		<span class="keyword">if</span> hasSource &amp;&amp; hasSink &#123;</span><br><span class="line">			<span class="keyword">if</span> graphContainsNoCycles(gCopy, currentEdge.source, currentEdge.sink) &#123;</span><br><span class="line">				a[it] = currentEdge</span><br><span class="line">				traversedVertecies[currentEdge.source] = <span class="literal">true</span></span><br><span class="line">				traversedVertecies[currentEdge.sink] = <span class="literal">true</span></span><br><span class="line">				addUndirectedEdge(&amp;gCopy, currentEdge)</span><br><span class="line">				it++</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				log.Printf(<span class="string">&quot;Dropped %v -&gt; %v&quot;</span>, currentEdge.source, currentEdge.sink)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			a[it] = currentEdge</span><br><span class="line">			traversedVertecies[currentEdge.source] = <span class="literal">true</span></span><br><span class="line">			traversedVertecies[currentEdge.sink] = <span class="literal">true</span></span><br><span class="line">			addUndirectedEdge(&amp;gCopy, currentEdge)</span><br><span class="line">			it++</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> it == numVertecies<span class="number">-1</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// New creates a new graph and assigns its values</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">()</span></span> Graph &#123;</span><br><span class="line">	vertecies := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>][]Edge)</span><br><span class="line">	g := Graph&#123;vertecies&#125;</span><br><span class="line">	<span class="keyword">return</span> g</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> traverseGraph <span class="keyword">struct</span> &#123;</span><br><span class="line">	vertecies <span class="keyword">map</span>[<span class="type">string</span>]*list.List</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createEmptyGraphWithVertecies</span><span class="params">(g Graph)</span></span> traverseGraph &#123;</span><br><span class="line">	vertecies := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]*list.List)</span><br><span class="line">	<span class="keyword">var</span> gCopy = traverseGraph&#123;vertecies&#125;</span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> g.vertecies &#123;</span><br><span class="line">		traverseEdges := list.New()</span><br><span class="line">		gCopy.vertecies[k] = traverseEdges</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gCopy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">buildExampleGraph</span><span class="params">()</span></span> Graph &#123;</span><br><span class="line">	<span class="keyword">var</span> g = New()</span><br><span class="line">	<span class="keyword">var</span> vertecies = []<span class="type">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>&#125;</span><br><span class="line">	<span class="keyword">for</span> _, vertex := <span class="keyword">range</span> vertecies &#123;</span><br><span class="line">		g.AddVertex(vertex)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	g.AddEdge(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">1</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="number">2</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;c&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="number">2</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="number">8</span>)</span><br><span class="line">	g.AddEdge(<span class="string">&quot;d&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> g</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	g := buildExampleGraph()</span><br><span class="line">	edges := Kruskals(&amp;g)</span><br><span class="line">	<span class="keyword">for</span> _, edge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		log.Printf(<span class="string">&quot;Edge from %s to %s with cost %v&quot;</span>, edge.source, edge.sink, edge.weight)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="12-LRU"><a href="#12-LRU" class="headerlink" title="12.LRU"></a>12.LRU</h1><p>LRUï¼ˆLeast Recently Usedï¼‰æ˜¯ä¸€ç§å¸¸è§çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼Œåœ¨è®¡ç®—ä¸­ï¼Œæ‰€æœ‰çš„æ–‡ä»¶æ“ä½œéƒ½è¦æ”¾åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œç„¶è€Œè®¡ç®—æœºå†…å­˜å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¯èƒ½æŠŠæ‰€æœ‰çš„æ–‡ä»¶éƒ½åŠ è½½åˆ°å†…å­˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ¶å®šä¸€ç§ç­–ç•¥å¯¹åŠ å…¥åˆ°å†…å­˜ä¸­çš„æ–‡ä»¶è¿›é¡¹é€‰æ‹©ã€‚</p>
<p>å¸¸è§çš„é¡µé¢ç½®æ¢ç®—æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>LRU æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨</li>
<li>FIFO å…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³• ç±»ä¼¼é˜Ÿåˆ—</li>
<li>OPT æœ€ä½³ç½®æ¢ç®—æ³• ï¼ˆç†æƒ³ä¸­å­˜åœ¨çš„ï¼‰</li>
<li>NRU Clockç½®æ¢ç®—æ³•</li>
<li>LFU æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•</li>
<li>PBA é¡µé¢ç¼“å†²ç®—æ³•</li>
</ul>
<p>LRUåŸç†</p>
<p>LRUçš„è®¾è®¡åŸç†å°±æ˜¯ï¼Œå½“æ•°æ®åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´ç»å¸¸è¢«è®¿é—®ï¼Œé‚£ä¹ˆå®ƒåœ¨ä»¥åä¹Ÿä¼šç»å¸¸è¢«è®¿é—®ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœç»å¸¸è®¿é—®çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ç„¶å…¶èƒ½å¤Ÿå¿«é€Ÿå‘½ä¸­ï¼Œè€Œä¸å¸¸è®¿é—®çš„æ•°æ®ï¼Œæˆ‘ä»¬åœ¨å®¹é‡è¶…å‡ºé™åˆ¶å†…ï¼Œè¦å°†å…¶æ·˜æ±°ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io">Blank</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io/posts/54673f66/">https://wangyyovo.github.io/posts/54673f66/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://wangyyovo.github.io" target="_blank">Blank</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/algorithm/38b729ad735ef910dc048dd9c1a11743.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/ShareJS/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/ShareJS/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/dc3f7967/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/frontend/4b1cba54d3f6cd545f94bc3ef927e4f0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">å‰ç«¯å¸¸ç”¨åº“æ”¶é›†</div></div></a></div><div class="next-post pull-right"><a href="/posts/d35e7d1d/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/a91a19eff20b2bb042a7ea0c92dbfc4b.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">goçŸ¥è¯†å›¾è°±</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontents.com/wangyyovo/CDN/master/theme/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Blank</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">356</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">54</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wangyyovo" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%8E%92%E5%BA%8F"><span class="toc-text">1.æ’åº</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F"><span class="toc-text">1.1 å†’æ³¡æ’åº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E4%BC%98%E5%8C%96%E7%89%88"><span class="toc-text">1.1.1 å†’æ³¡æ’åºä¼˜åŒ–ç‰ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-%E5%8F%8C%E5%90%91%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F-%E9%B8%A1%E5%B0%BE%E9%85%92%E6%8E%92%E5%BA%8F"><span class="toc-text">1.1.2 åŒå‘å†’æ³¡æ’åº(é¸¡å°¾é…’æ’åº)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F"><span class="toc-text">1.2 é€‰æ‹©æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="toc-text">1.3 æ’å…¥æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F"><span class="toc-text">1.4 å¸Œå°”æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F"><span class="toc-text">1.5 å¿«é€Ÿæ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F"><span class="toc-text">1.6 å½’å¹¶æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E5%A0%86%E6%8E%92%E5%BA%8F"><span class="toc-text">1.7 å †æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F"><span class="toc-text">1.8 è®¡æ•°æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F"><span class="toc-text">1.9 åŸºæ•°æ’åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-10-%E6%A1%B6%E6%8E%92%E5%BA%8F"><span class="toc-text">1.10 æ¡¶æ’åº</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%9F%A5%E6%89%BE"><span class="toc-text">2.æŸ¥æ‰¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E9%A1%BA%E5%BA%8F%E6%9F%A5%E6%89%BE"><span class="toc-text">2.1 é¡ºåºæŸ¥æ‰¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E6%8F%92%E5%80%BC%E6%9F%A5%E6%89%BE"><span class="toc-text">2.2 æ’å€¼æŸ¥æ‰¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE"><span class="toc-text">2.3 äºŒåˆ†æŸ¥æ‰¾</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E9%93%BE%E8%A1%A8"><span class="toc-text">3.é“¾è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%8D%95%E9%93%BE%E8%A1%A8"><span class="toc-text">3.1 å•é“¾è¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%8F%8C%E9%93%BE%E8%A1%A8"><span class="toc-text">3.2 åŒé“¾è¡¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E9%98%9F%E5%88%97"><span class="toc-text">4.é˜Ÿåˆ—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E9%93%BE%E5%BC%8F%E9%98%9F%E5%88%97"><span class="toc-text">4.1 é“¾å¼é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E6%95%B0%E7%BB%84%E9%98%9F%E5%88%97"><span class="toc-text">4.2 æ•°ç»„é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97"><span class="toc-text">4.3 ä¼˜å…ˆé˜Ÿåˆ—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%A0%88"><span class="toc-text">5.æ ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E6%95%B0%E7%BB%84%E6%A0%88"><span class="toc-text">5.1 æ•°ç»„æ ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E9%93%BE%E5%BC%8F%E6%A0%88"><span class="toc-text">5.2 é“¾å¼æ ˆ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%A0%86"><span class="toc-text">6.å †</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E4%BA%8C%E5%8F%89%E5%A0%86"><span class="toc-text">6.1 äºŒå‰å †</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E9%9B%86%E5%90%88"><span class="toc-text">7.é›†åˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%88%97%E8%A1%A8"><span class="toc-text">8.åˆ—è¡¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%93%88%E5%B8%8C%E8%A1%A8"><span class="toc-text">9.å“ˆå¸Œè¡¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E6%A0%91"><span class="toc-text">9.æ ‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="toc-text">9.1 äºŒå‰æ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2%E6%A0%91"><span class="toc-text">9.2 äºŒåˆ†æœç´¢æ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E7%BA%A2%E9%BB%91%E6%A0%91"><span class="toc-text">9.3 çº¢é»‘æ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-Trie%E5%AD%97%E5%85%B8%E6%A0%91"><span class="toc-text">9.4 Trieå­—å…¸æ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="toc-text">9.5 çº¿æ®µæ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="toc-text">9.6 å¹³è¡¡äºŒå‰æ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-B%E6%A0%91-2-3-4%E6%A0%91"><span class="toc-text">9.7 Bæ ‘(2-3-4æ ‘)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-8-B-%E6%A0%91"><span class="toc-text">9.8 B+æ ‘</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E5%9B%BE"><span class="toc-text">10.å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E7%BD%91"><span class="toc-text">10.1 ç½‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E5%9B%BE%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="toc-text">10.2 å›¾çš„å­˜å‚¨ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-1-%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5-%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8"><span class="toc-text">10.2.1 é‚»æ¥çŸ©é˜µ(é¡ºåºå­˜å‚¨)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-2-%E9%82%BB%E6%8E%A5%E8%A1%A8-%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8"><span class="toc-text">10.2.2 é‚»æ¥è¡¨(é“¾å¼å­˜å‚¨)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-3-%E5%8D%81%E5%AD%97%E9%93%BE%E8%A1%A8-%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8"><span class="toc-text">10.2.3 åå­—é“¾è¡¨(é“¾å¼å­˜å‚¨)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-4-%E9%82%BB%E6%8E%A5%E5%A4%9A%E9%87%8D%E8%A1%A8-%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8"><span class="toc-text">10.2.4 é‚»æ¥å¤šé‡è¡¨(é“¾å¼å­˜å‚¨)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-5-%E6%80%BB%E7%BB%93"><span class="toc-text">10.2.5 æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-%E6%9C%89%E5%90%91%E6%97%A0%E5%90%91%E5%9B%BE"><span class="toc-text">10.3 æœ‰å‘æ— å‘å›¾</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-text">11.æœ€çŸ­è·¯å¾„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-Dijkstra"><span class="toc-text">11.1 Dijkstra</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-Prim"><span class="toc-text">11.2 Prim</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-Kruskal"><span class="toc-text">11.3 Kruskal</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-LRU"><span class="toc-text">12.LRU</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d14168d/" title="è™šæ‹Ÿæœºé—®é¢˜åˆé›†"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="è™šæ‹Ÿæœºé—®é¢˜åˆé›†"/></a><div class="content"><a class="title" href="/posts/d14168d/" title="è™šæ‹Ÿæœºé—®é¢˜åˆé›†">è™šæ‹Ÿæœºé—®é¢˜åˆé›†</a><time datetime="2022-07-16T13:30:36.000Z" title="å‘è¡¨äº 2022-07-16 21:30:36">2022-07-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f540045f/" title="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/941ed1ec2925719a0c92e76f4f786b6a.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘"/></a><div class="content"><a class="title" href="/posts/f540045f/" title="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘">ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘</a><time datetime="2022-07-04T12:14:21.000Z" title="å‘è¡¨äº 2022-07-04 20:14:21">2022-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5faac006/" title="åœ¨çº¿ç¼–ç¨‹IDE"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="åœ¨çº¿ç¼–ç¨‹IDE"/></a><div class="content"><a class="title" href="/posts/5faac006/" title="åœ¨çº¿ç¼–ç¨‹IDE">åœ¨çº¿ç¼–ç¨‹IDE</a><time datetime="2022-06-12T13:30:36.000Z" title="å‘è¡¨äº 2022-06-12 21:30:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7594185d/" title="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/3bfb3279740bc9a5b5ef436fa887ef07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope"/></a><div class="content"><a class="title" href="/posts/7594185d/" title="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope">å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope</a><time datetime="2022-06-12T08:07:36.000Z" title="å‘è¡¨äº 2022-06-12 16:07:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/82a7aa7c/" title="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•"/></a><div class="content"><a class="title" href="/posts/82a7aa7c/" title="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•">golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•</a><time datetime="2022-06-12T03:00:36.000Z" title="å‘è¡¨äº 2022-06-12 11:00:36">2022-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Blank</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://wangyyovo.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5/instantpage.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '49gEIIGN7uRbL6vHhieSpBzM-MdYXbMMI',
      appKey: 'uqts0urLKwikYQ0fKmIkMHBE',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><div class="aplayer no-destroy" data-id="000PeZCQ1i4XVs" data-server="tencent" data-type="artist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/MetingJS/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>