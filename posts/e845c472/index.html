<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>NATS Streaming | Blank</title><meta name="author" content="Blank"><meta name="copyright" content="Blank"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="NATS StreamingNATS Streaming æ¦‚å¿µNATS Streamingæ˜¯ä¸€ä¸ªç”±NATSé©±åŠ¨çš„æ•°æ®æµç³»ç»Ÿï¼Œç”¨Goç¼–ç¨‹è¯­è¨€ç¼–å†™ã€‚ NATS StreamingæœåŠ¡å™¨çš„å¯æ‰§è¡Œæ–‡ä»¶åæ˜¯nats-streaming-serverã€‚ NATS Streamingä¸æ ¸å¿ƒNATSå¹³å°æ— ç¼åµŒå…¥ï¼Œæ‰©å±•å’Œäº’æ“ä½œã€‚ NATS StreamingæœåŠ¡å™¨ä½œä¸ºApache-2.0è®¸å¯ä¸‹çš„å¼€æºè½¯ä»¶æä¾›ã€‚ S">
<meta property="og:type" content="article">
<meta property="og:title" content="NATS Streaming">
<meta property="og:url" content="https://wangyyovo.github.io/posts/e845c472/">
<meta property="og:site_name" content="Blank">
<meta property="og:description" content="NATS StreamingNATS Streaming æ¦‚å¿µNATS Streamingæ˜¯ä¸€ä¸ªç”±NATSé©±åŠ¨çš„æ•°æ®æµç³»ç»Ÿï¼Œç”¨Goç¼–ç¨‹è¯­è¨€ç¼–å†™ã€‚ NATS StreamingæœåŠ¡å™¨çš„å¯æ‰§è¡Œæ–‡ä»¶åæ˜¯nats-streaming-serverã€‚ NATS Streamingä¸æ ¸å¿ƒNATSå¹³å°æ— ç¼åµŒå…¥ï¼Œæ‰©å±•å’Œäº’æ“ä½œã€‚ NATS StreamingæœåŠ¡å™¨ä½œä¸ºApache-2.0è®¸å¯ä¸‹çš„å¼€æºè½¯ä»¶æä¾›ã€‚ S">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/95994a9aea31be452e66c89e68ba4a27.jpg">
<meta property="article:published_time" content="2019-09-27T08:10:36.000Z">
<meta property="article:modified_time" content="2019-09-27T08:10:36.000Z">
<meta property="article:author" content="Blank">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/95994a9aea31be452e66c89e68ba4a27.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "NATS Streaming",
  "url": "https://wangyyovo.github.io/posts/e845c472/",
  "image": "https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/95994a9aea31be452e66c89e68ba4a27.jpg",
  "datePublished": "2019-09-27T08:10:36.000Z",
  "dateModified": "2019-09-27T08:10:36.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Blank",
      "url": "https://wangyyovo.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/favicon.ico"><link rel="canonical" href="https://wangyyovo.github.io/posts/e845c472/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: Blank","link":"é“¾æ¥: ","source":"æ¥æº: Blank","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NATS Streaming',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="alternate" href="/atom.xml" title="Blank" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">352</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">58</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> ç›¸å†Œ</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ•™ç¨‹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ æ¨™ç°½å¤–æŒ‚</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> è¯­è¨€</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> ä¸­æ–‡</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/95994a9aea31be452e66c89e68ba4a27.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Blank</span></a><a class="nav-page-title" href="/"><span class="site-name">NATS Streaming</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-image"></i><span> ç›¸å†Œ</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> æ•™ç¨‹</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ æ¨™ç°½å¤–æŒ‚</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> è¯­è¨€</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> ä¸­æ–‡</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">NATS Streaming</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2019-09-27T08:10:36.000Z" title="å‘è¡¨äº 2019-09-27 16:10:36">2019-09-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2019-09-27T08:10:36.000Z" title="æ›´æ–°äº 2019-09-27 16:10:36">2019-09-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/microservice/">microservice</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/microservice/nats/">nats</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">4.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>19åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><script src="\assets\js\APlayer.min.js"> </script><h1 id="NATS-Streaming"><a href="#NATS-Streaming" class="headerlink" title="NATS Streaming"></a>NATS Streaming</h1><h2 id="NATS-Streaming-æ¦‚å¿µ"><a href="#NATS-Streaming-æ¦‚å¿µ" class="headerlink" title="NATS Streaming æ¦‚å¿µ"></a>NATS Streaming æ¦‚å¿µ</h2><p>NATS Streamingæ˜¯ä¸€ä¸ªç”±NATSé©±åŠ¨çš„æ•°æ®æµç³»ç»Ÿï¼Œç”¨Goç¼–ç¨‹è¯­è¨€ç¼–å†™ã€‚ NATS StreamingæœåŠ¡å™¨çš„å¯æ‰§è¡Œæ–‡ä»¶åæ˜¯<a target="_blank" rel="noopener" href="https://github.com/nats-io/nats-streaming-server">nats-streaming-server</a>ã€‚ NATS Streamingä¸æ ¸å¿ƒNATSå¹³å°æ— ç¼åµŒå…¥ï¼Œæ‰©å±•å’Œäº’æ“ä½œã€‚ NATS StreamingæœåŠ¡å™¨ä½œä¸ºApache-2.0è®¸å¯ä¸‹çš„å¼€æºè½¯ä»¶æä¾›ã€‚ Synadiaç§¯æç»´æŠ¤å’Œæ”¯æŒNATS StreamingæœåŠ¡å™¨ã€‚</p>
<h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>é™¤äº†æ ¸å¿ƒNATSå¹³å°çš„åŠŸèƒ½å¤–ï¼ŒNATS Streamingè¿˜æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>å¢å¼ºçš„æ¶ˆæ¯åè®® - NATS Streamingä½¿ç”¨è°·æ­Œåè®®ç¼“å†²åŒºå®ç°è‡ªå·±çš„å¢å¼ºå‹æ¶ˆæ¯æ ¼å¼ã€‚è¿™äº›æ¶ˆæ¯é€šè¿‡äºŒè¿›åˆ¶æ•°æ®æµåœ¨NATSæ ¸å¿ƒå¹³å°è¿›è¡Œä¼ æ’­,å› æ­¤ä¸éœ€è¦æ”¹å˜NATSçš„åŸºæœ¬åè®®ã€‚NATS Streamingä¿¡æ¯åŒ…å«ä»¥ä¸‹å­—æ®µ:<ul>
<li>åºåˆ— - ä¸€ä¸ªå…¨å±€é¡ºåºåºåˆ—å·ä¸ºä¸»é¢˜çš„é€šé“<br>ã€€ã€€- ä¸»é¢˜ - æ˜¯NATS Streaming äº¤ä»˜å¯¹è±¡<br>ã€€ã€€- ç­”å¤å†…å®¹ - å¯¹åº”&quot;reply-to&quot;å¯¹åº”çš„å¯¹è±¡å†…å®¹<br>ã€€ã€€- æ•°æ® - çœŸæ˜¯æ•°æ®å†…å®¹<br>ã€€ã€€- æ—¶é—´æˆ³ - æ¥æ”¶çš„æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯çº³ç§’<br>ã€€ã€€- é‡å¤å‘é€ - æ ‡å¿—è¿™æ¡æ•°æ®æ˜¯å¦éœ€è¦æœåŠ¡å†æ¬¡å‘é€<br>ã€€ã€€- CRC32 - ä¸€ä¸ªå¾ªç¯å†—ä½™æ•°æ®æ ¡éªŒé€‰é¡¹ï¼Œåœ¨æ•°æ®å­˜å‚¨å’Œæ•°æ®é€šè®¯é¢†åŸŸé‡Œï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§æ‰€é‡‡ç”¨çš„æ£€é”™æ‰‹æ®µï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ IEEE CRC32 ç®—æ³•</li>
</ul>
</li>
<li>æ¶ˆæ¯&#x2F;äº‹ä»¶æŒä¹…æ€§ - NATS Streamingæä¾›äº†å¯é…ç½®çš„æ¶ˆæ¯æŒä¹…åŒ–ï¼ŒæŒä¹…ç›®çš„åœ°å¯ä»¥ä¸ºå†…å­˜æˆ–è€…æ–‡ä»¶ã€‚å¦å¤–ï¼Œå¯¹åº”çš„å­˜å‚¨å­ç³»ç»Ÿä½¿ç”¨äº†ä¸€ä¸ªå…¬å…±æ¥å£å…è®¸æˆ‘ä»¬å¼€å‘è‡ªå·±è‡ªå®šä¹‰å®ç°æ¥æŒä¹…åŒ–å¯¹åº”çš„æ¶ˆæ¯ã€‚</li>
<li>è‡³å°‘ä¸€æ¬¡ä¼ é€ - NATS Streamingæä¾›äº†å‘å¸ƒè€…å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ¶ˆæ¯ç¡®è®¤(å‘å¸ƒæ“ä½œ) å’Œè®¢é˜…è€…å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ¶ˆæ¯ç¡®è®¤(ç¡®è®¤æ¶ˆæ¯å‘é€)ã€‚å…¶ä¸­æ¶ˆæ¯è¢«ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯å†…å­˜æˆ–è€…è¾…åŠ©å­˜å‚¨(æˆ–å…¶ä»–å¤–éƒ¨å­˜å‚¨å™¨)ç”¨æ¥ä¸ºéœ€è¦é‡æ–°æ¥å—æ¶ˆæ¯çš„è®¢é˜…è€…è¿›è¡Œé‡å‘æ¶ˆæ¯ã€‚</li>
<li>å‘å¸ƒè€…å‘é€é€Ÿç‡é™å®š - NATS Streamingæä¾›äº†ä¸€ä¸ªè¿æ¥é€‰é¡¹å« MaxPubAcksInFlightï¼Œå®ƒèƒ½æœ‰æ•ˆçš„é™åˆ¶ä¸€ä¸ªå‘å¸ƒè€…å¯èƒ½éšæ„çš„åœ¨ä»»ä½•æ—¶å€™å‘é€çš„æœªè¢«ç¡®è®¤çš„æ¶ˆæ¯ã€‚å½“è¾¾åˆ°è¿™ä¸ªé…ç½®çš„æœ€å¤§æ•°é‡æ—¶ï¼Œå¼‚æ­¥å‘é€è°ƒç”¨æ¥å£å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœªç¡®è®¤æ¶ˆæ¯é™åˆ°æŒ‡å®šæ•°é‡ä¹‹ä¸‹ã€‚</li>
<li>æ¯ä¸ªè®¢æˆ·çš„é€Ÿç‡åŒ¹é…&#x2F;é™åˆ¶ - NATS Streamingè¿è¡ŒæŒ‡å®šçš„è®¢é˜…ä¸­è®¾ç½®ä¸€ä¸ªå‚æ•°ä¸º MaxInFlightï¼Œå®ƒç”¨æ¥æŒ‡å®šå·²ç¡®è®¤ä½†æœªæ¶ˆè´¹çš„æœ€å¤§æ•°æ®é‡ï¼Œå½“è¾¾åˆ°è¿™ä¸ªé™åˆ¶æ—¶ï¼ŒNATS Streaming å°†æš‚åœå‘é€æ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œç›´åˆ°æœªç¡®è®¤çš„æ•°æ®é‡å°äºè®¾å®šçš„é‡ä¸ºæ­¢ã€‚</li>
<li>ä»¥ä¸»é¢˜é‡å‘çš„å†å²æ•°æ® - æ–°è®¢é˜…çš„å¯ä»¥åœ¨å·²ç»å­˜å‚¨èµ·æ¥çš„è®¢é˜…çš„ä¸»é¢˜é¢‘é“æŒ‡å®šèµ·å§‹ä½ç½®æ¶ˆæ¯æµã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªé€‰é¡¹,æ¶ˆæ¯å°±å¯ä»¥å¼€å§‹å‘é€ä¼ é€’äº†:<ul>
<li>è®¢é˜…çš„ä¸»é¢˜å­˜å‚¨çš„æœ€æ—©çš„ä¿¡æ¯</li>
<li>ä¸å½“å‰è®¢é˜…ä¸»é¢˜ä¹‹å‰çš„æœ€è¿‘å­˜å‚¨çš„æ•°æ®ï¼Œè¿™é€šå¸¸è¢«è®¤ä¸ºæ˜¯ &quot;æœ€åçš„å€¼&quot; æˆ– &quot;åˆå€¼&quot; å¯¹åº”çš„ç¼“å­˜</li>
<li>ä¸€ä¸ªä»¥çº³ç§’ä¸ºåŸºå‡†çš„ æ—¥æœŸï¼æ—¶é—´</li>
<li>ä¸€ä¸ªå†å²çš„èµ·å§‹ä½ç½®ç›¸å¯¹å½“å‰æœåŠ¡çš„ æ—¥æœŸï¼æ—¶é—´ï¼Œä¾‹å¦‚ï¼šæœ€å30ç§’</li>
<li>ä¸€ä¸ªç‰¹å®šçš„æ¶ˆæ¯åºåˆ—å·</li>
</ul>
</li>
<li>æŒä¹…è®¢é˜… - è®¢é˜…ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªâ€œæŒä¹…åŒ–çš„åç§°â€å¯ä»¥åœ¨å®¢æˆ·ç«¯é‡å¯æ—¶ä¸å—å½±å“ã€‚æŒä¹…è®¢é˜…ä¼šä½¿å¾—å¯¹åº”æœåŠ¡è·Ÿè¸ªå®¢æˆ·ç«¯æœ€åç¡®è®¤æ¶ˆæ¯çš„åºåˆ—å·å’ŒæŒä¹…åç§°ã€‚å½“è¿™ä¸ªå®¢æˆ·ç«¯é‡å¯æˆ–è€…é‡æ–°è®¢é˜…çš„æ—¶å€™ï¼Œä½¿ç”¨ç›¸åŒçš„å®¢æˆ·ç«¯ID å’Œ æŒä¹…åŒ–çš„åç§°ï¼Œå¯¹åº”çš„æœåŠ¡å°†ä¼šä»æœ€æ—©çš„æœªè¢«ç¡®è®¤çš„æ¶ˆæ¯å¤„æ¢å¤ã€‚</li>
</ul>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>NATSä¸ºLinuxï¼ŒMacå’ŒWindowsæä¾›æœåŠ¡å™¨<a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-install/">äºŒè¿›åˆ¶æ–‡ä»¶</a>ã€‚æ‚¨å¯ä»¥åœ¨æ‚¨é€‰æ‹©çš„ä»»ä½•å¹³å°ä¸Šä»æºå®‰è£…æœåŠ¡å™¨ã€‚</p>
<h3 id="ç”¨æ³•ï¼Œé…ç½®å’Œç®¡ç†"><a href="#ç”¨æ³•ï¼Œé…ç½®å’Œç®¡ç†" class="headerlink" title="ç”¨æ³•ï¼Œé…ç½®å’Œç®¡ç†"></a>ç”¨æ³•ï¼Œé…ç½®å’Œç®¡ç†</h3><p>NATS Streamingæä¾›äº†ä¸€ç»„ä¸°å¯Œçš„å‘½ä»¤å’Œå‚æ•°æ¥é…ç½®æœåŠ¡å™¨çš„æ‰€æœ‰æ–¹é¢ã€‚æœ‰å…³ä½¿ç”¨ï¼Œé…ç½®å’Œç®¡ç†çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://github.com/nats-io/nats-streaming-server/">è‡ªè¿°æ–‡ä»¶</a>ã€‚</p>
<h2 id="å®‰è£…NATS-Streaming-Server"><a href="#å®‰è£…NATS-Streaming-Server" class="headerlink" title="å®‰è£…NATS Streaming Server"></a>å®‰è£…NATS Streaming Server</h2><h3 id="å®‰è£…å¹¶è¿è¡ŒNATS-Streaming-Server"><a href="#å®‰è£…å¹¶è¿è¡ŒNATS-Streaming-Server" class="headerlink" title="å®‰è£…å¹¶è¿è¡ŒNATS Streaming Server"></a>å®‰è£…å¹¶è¿è¡ŒNATS Streaming Server</h3><p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å®‰è£…å¹¶è¿è¡ŒNATS StreamingæœåŠ¡å™¨ï¼ˆnats-streaming-serverï¼‰ã€‚æ‚¨å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¿è¡ŒNATS StreamingæœåŠ¡å™¨æ—¶éµå¾ªç›¸åŒçš„è¿‡ç¨‹ã€‚</p>
<h4 id="å®‰è£…NATS-StreamingæœåŠ¡å™¨"><a href="#å®‰è£…NATS-StreamingæœåŠ¡å™¨" class="headerlink" title="å®‰è£…NATS StreamingæœåŠ¡å™¨"></a>å®‰è£…NATS StreamingæœåŠ¡å™¨</h4><p>æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®‰è£…NATS StreamingæœåŠ¡å™¨ã€‚<br><strong>GitHubå‘å¸ƒ</strong></p>
<p>GitHubç‰ˆæœ¬é¡µé¢ä¸Šå§‹ç»ˆæä¾›æœ€æ–°çš„å®˜æ–¹å‘è¡Œç‰ˆäºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å¹³å°ï¼š</p>
<ul>
<li>Linux (x86, x86_64, ARM)</li>
<li>Windows (x86, x86_64)</li>
<li>macOS</li>
</ul>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•å¯èƒ½æ— æ³•å®‰è£…æœ€æ–°å‘å¸ƒçš„ç‰ˆæœ¬ï¼š<br><strong>Go</strong></p>
<p>ç¡®ä¿è®¾ç½®äº†Goç¯å¢ƒ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go get github.com/nats-io/nats-streaming-server</span></span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•å¯èƒ½æ— æ³•å®‰è£…æœ€æ–°å‘å¸ƒçš„ç‰ˆæœ¬ã€‚<br><strong>Docker Hub</strong></p>
<p>Docker Hubä¸Šå§‹ç»ˆæä¾›æœ€æ–°çš„å®˜æ–¹<a target="_blank" rel="noopener" href="https://hub.docker.com/_/nats-streaming/">Dockeræ˜ åƒ</a>ã€‚</p>
<p><strong>Windows</strong></p>
<p>åœ¨Windowsä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡Chocolateyå®‰è£…NATS StreamingæœåŠ¡å™¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">choco install nats-streaming-server</span></span><br></pre></td></tr></table></figure>

<p><strong>macOS</strong></p>
<p>åœ¨macOSä¸Šï¼Œå¯ä»¥é€šè¿‡Homebrewå®‰è£…NATS StreamingæœåŠ¡å™¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">brew install nats-streaming-server</span></span><br></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨NATS StreamingæœåŠ¡å™¨</strong></p>
<p>æ‚¨å¯ä»¥è°ƒç”¨NATS StreamingæœåŠ¡å™¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ²¡æœ‰é€‰é¡¹ï¼Œä¹Ÿæ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œä»¥å¯åŠ¨å…·æœ‰å¯æ¥å—çš„ç‹¬ç«‹é»˜è®¤å€¼çš„æœåŠ¡å™¨ï¼ˆæ— èº«ä»½éªŒè¯ï¼Œæ— ç¾¤é›†ï¼‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nats-streaming-server</span></span><br></pre></td></tr></table></figure>

<p>å½“æœåŠ¡å™¨æˆåŠŸå¯åŠ¨æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°NATS StreamingæœåŠ¡å™¨åœ¨TCPç«¯å£4222ä¸Šä¾¦å¬å®¢æˆ·ç«¯è¿æ¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[18085] 2016/10/31 13:11:44.059012 [INF] Starting nats-streaming-server[test-cluster] version 0.3.1</span><br><span class="line">[18085] 2016/10/31 13:11:44.059830 [INF] Starting nats-server version 0.9.4</span><br><span class="line">[18085] 2016/10/31 13:11:44.061544 [INF] Listening for client connections on 0.0.0.0:4222</span><br><span class="line">[18085] 2016/10/31 13:11:44.061966 [INF] Server is ready</span><br><span class="line">[18085] 2016/10/31 13:11:44.396819 [INF] STAN: Message store is MEMORY</span><br><span class="line">[18085] 2016/10/31 13:11:44.396832 [INF] STAN: --------- Store Limits ---------</span><br><span class="line">[18085] 2016/10/31 13:11:44.396837 [INF] STAN: Channels:                  100 *</span><br><span class="line">[18085] 2016/10/31 13:11:44.396839 [INF] STAN: -------- channels limits -------</span><br><span class="line">[18085] 2016/10/31 13:11:44.396842 [INF] STAN:   Subscriptions:          1000 *</span><br><span class="line">[18085] 2016/10/31 13:11:44.396844 [INF] STAN:   Messages     :       1000000 *</span><br><span class="line">[18085] 2016/10/31 13:11:44.396855 [INF] STAN:   Bytes        :     976.56 MB *</span><br><span class="line">[18085] 2016/10/31 13:11:44.396858 [INF] STAN:   Age          :     unlimited *</span><br><span class="line">[18085] 2016/10/31 13:11:44.396859 [INF] STAN: --------------------------------</span><br></pre></td></tr></table></figure>



<p><strong>å¯ç”¨NATSç›‘æ§å¯åŠ¨NATSæµæœåŠ¡å™¨ï¼ˆå¯é€‰ï¼‰</strong></p>
<p>NATS StreamingæœåŠ¡å™¨åœ¨ç«¯å£8222ä¸Šå…¬å¼€å…¶åµŒå…¥å¼NATSæœåŠ¡å™¨ï¼ˆnats-serverï¼‰çš„ç›‘è§†æ¥å£ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nats-streaming-server -m 8222</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨å¯ç”¨ç›‘è§†çš„æƒ…å†µä¸‹è¿è¡ŒNATS StreamingæœåŠ¡å™¨ï¼Œåˆ™ä¼šçœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[18122] 2016/10/31 13:13:10.048663 [INF] Starting nats-streaming-server[test-cluster] version 0.3.1</span><br><span class="line">[18122] 2016/10/31 13:13:10.048843 [INF] Starting nats-server version 0.9.4</span><br><span class="line">[18122] 2016/10/31 13:13:10.048890 [INF] Starting http monitor on 0.0.0.0:8222</span><br><span class="line">[18122] 2016/10/31 13:13:10.048968 [INF] Listening for client connections on 0.0.0.0:4222</span><br><span class="line">[18122] 2016/10/31 13:13:10.048992 [INF] Server is ready</span><br><span class="line">[18122] 2016/10/31 13:13:10.388282 [INF] STAN: Message store is MEMORY</span><br><span class="line">[18122] 2016/10/31 13:13:10.388301 [INF] STAN: --------- Store Limits ---------</span><br><span class="line">[18122] 2016/10/31 13:13:10.388309 [INF] STAN: Channels:                  100 *</span><br><span class="line">[18122] 2016/10/31 13:13:10.388312 [INF] STAN: -------- channels limits -------</span><br><span class="line">[18122] 2016/10/31 13:13:10.388316 [INF] STAN:   Subscriptions:          1000 *</span><br><span class="line">[18122] 2016/10/31 13:13:10.388319 [INF] STAN:   Messages     :       1000000 *</span><br><span class="line">[18122] 2016/10/31 13:13:10.388333 [INF] STAN:   Bytes        :     976.56 MB *</span><br><span class="line">[18122] 2016/10/31 13:13:10.388338 [INF] STAN:   Age          :     unlimited *</span><br><span class="line">[18122] 2016/10/31 13:13:10.388341 [INF] STAN: --------------------------------</span><br></pre></td></tr></table></figure>

<h2 id="NATS-Streamingå…¥é—¨"><a href="#NATS-Streamingå…¥é—¨" class="headerlink" title="NATS Streamingå…¥é—¨"></a>NATS Streamingå…¥é—¨</h2><p>æœ¬æ•™ç¨‹ä½¿ç”¨ç¤ºä¾‹Go NATS Streamingå®¢æˆ·ç«¯æ¼”ç¤ºNATS Streamingã€‚</p>
<h3 id="å…ˆå†³æ¡ä»¶"><a href="#å…ˆå†³æ¡ä»¶" class="headerlink" title="å…ˆå†³æ¡ä»¶"></a>å…ˆå†³æ¡ä»¶</h3><ul>
<li><a target="_blank" rel="noopener" href="https://help.github.com/articles/set-up-git/">è®¾ç½®ä½ çš„Gitç¯å¢ƒ</a></li>
<li><a target="_blank" rel="noopener" href="https://golang.org/doc/install">è®¾ç½®Goç¯å¢ƒ</a></li>
</ul>
<h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>ä¸‹è½½å¹¶å®‰è£…<a target="_blank" rel="noopener" href="https://github.com/nats-io/nats-streaming-server/releases">NATS Streaming Server</a>ã€‚</p>
<p>å…‹éš†ä»¥ä¸‹å­˜å‚¨åº“ï¼š</p>
<ul>
<li>NATS Streaming Server: <code>git clone https://github.com/nats-io/nats-streaming-server.git</code></li>
<li>NATS Streaming Client: <code>git clone https://github.com/nats-io/go-nats-streaming.git</code></li>
</ul>
<h3 id="å¯åŠ¨NATS-Streaming-Server"><a href="#å¯åŠ¨NATS-Streaming-Server" class="headerlink" title="å¯åŠ¨NATS Streaming Server"></a>å¯åŠ¨NATS Streaming Server</h3><p>ä¸¤ç§é€‰æ‹©ï¼š</p>
<p>è¿è¡Œæ‚¨ä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š$ .&#x2F;nats-streaming-server</p>
<p>æˆ–è€…ï¼Œä»æºä»£ç è¿è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/nats-io/nats-streaming-server</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run nats-streaming-server.go</span></span><br></pre></td></tr></table></figure>

<p>æ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼Œè¡¨æ˜NATS Streaming Serveræ­£åœ¨è¿è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run nats-streaming-server.go</span></span><br><span class="line">[89999] 2016/06/25 08:54:35.399071 [INF] Starting nats-streaming-server[test-cluster] version 0.1.0</span><br><span class="line">[89999] 2016/06/25 08:54:35.399315 [INF] Starting nats-server version 0.9.0.beta</span><br><span class="line">[89999] 2016/06/25 08:54:35.399326 [INF] Listening for client connections on localhost:4222</span><br><span class="line">[89999] 2016/06/25 08:54:35.400721 [INF] Server is ready</span><br><span class="line">[89999] 2016/06/25 08:54:35.737589 [INF] STAN: Message store is MEMORY</span><br><span class="line">[89999] 2016/06/25 08:54:35.737610 [INF] STAN: Maximum of 1000000 will be stored</span><br></pre></td></tr></table></figure>

<h3 id="è¿è¡Œå‘å¸ƒè€…å®¢æˆ·ç«¯"><a href="#è¿è¡Œå‘å¸ƒè€…å®¢æˆ·ç«¯" class="headerlink" title="è¿è¡Œå‘å¸ƒè€…å®¢æˆ·ç«¯"></a>è¿è¡Œå‘å¸ƒè€…å®¢æˆ·ç«¯</h3><p>å‘å¸ƒå¤šæ¡æ¶ˆæ¯ã€‚å¯¹äºæ¯ä¸ªå‡ºç‰ˆç‰©ï¼Œæ‚¨åº”è¯¥å¾—åˆ°ä¸€ä¸ªç»“æœã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/nats-io/go-nats-streaming/examples/stan-pub</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run main.go foo <span class="string">&quot;msg one&quot;</span></span></span><br><span class="line">Published [foo] : &#x27;msg one&#x27;</span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run main.go foo <span class="string">&quot;msg two&quot;</span></span></span><br><span class="line">Published [foo] : &#x27;msg two&#x27;</span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run main.go foo <span class="string">&quot;msg three&quot;</span></span></span><br><span class="line">Published [foo] : &#x27;msg three&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="è¿è¡Œè®¢æˆ·å®¢æˆ·ç«¯"><a href="#è¿è¡Œè®¢æˆ·å®¢æˆ·ç«¯" class="headerlink" title="è¿è¡Œè®¢æˆ·å®¢æˆ·ç«¯"></a>è¿è¡Œè®¢æˆ·å®¢æˆ·ç«¯</h3><p>ä½¿ç”¨<code>--all</code>æ ‡å¿—æ¥æ”¶æ‰€æœ‰å·²å‘å¸ƒçš„æ¶ˆæ¯ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/nats-io/go-nats-streaming/examples/stan-sub</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">go run main.go --all -c test-cluster -<span class="built_in">id</span> myID foo</span></span><br><span class="line">Connected to nats://localhost:4222 clusterID: [test-cluster] clientID: [myID]</span><br><span class="line">subscribing with DeliverAllAvailable</span><br><span class="line">Listening on [foo], clientID=[myID], qgroup=[] durable=[]</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">1] Received on [foo]: <span class="string">&#x27;sequence:1 subject:&quot;foo&quot; data:&quot;msg one&quot; timestamp:1465962202884478817 &#x27;</span></span></span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">2] Received on [foo]: <span class="string">&#x27;sequence:2 subject:&quot;foo&quot; data:&quot;msg two&quot; timestamp:1465962208545003897 &#x27;</span></span></span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">3] Received on [foo]: <span class="string">&#x27;sequence:3 subject:&quot;foo&quot; data:&quot;msg three&quot; timestamp:1465962215567601196</span></span></span><br></pre></td></tr></table></figure>

<h3 id="æ¢ç´¢å…¶ä»–è®¢é˜…é€‰é¡¹"><a href="#æ¢ç´¢å…¶ä»–è®¢é˜…é€‰é¡¹" class="headerlink" title="æ¢ç´¢å…¶ä»–è®¢é˜…é€‰é¡¹"></a>æ¢ç´¢å…¶ä»–è®¢é˜…é€‰é¡¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">--seq &lt;seqno&gt;       Start at seqno</span><br><span class="line">--all               Deliver all available messages</span><br><span class="line">--last              Deliver starting with last published message</span><br><span class="line">--since &lt;duration&gt;  Deliver messages in last interval (e.g. 1s, 1hr, https://golang.org/pkg/time/#ParseDuration)</span><br><span class="line">--durable &lt;name&gt;    Durable subscriber name</span><br><span class="line">--unsubscribe       Unsubscribe the durable on exit</span><br></pre></td></tr></table></figure>

<h2 id="NATSæµåª’ä½“æœåŠ¡å™¨å®‰å…¨"><a href="#NATSæµåª’ä½“æœåŠ¡å™¨å®‰å…¨" class="headerlink" title="NATSæµåª’ä½“æœåŠ¡å™¨å®‰å…¨"></a>NATSæµåª’ä½“æœåŠ¡å™¨å®‰å…¨</h2><h3 id="éªŒè¯ç”¨æˆ·"><a href="#éªŒè¯ç”¨æˆ·" class="headerlink" title="éªŒè¯ç”¨æˆ·"></a>éªŒè¯ç”¨æˆ·</h3><p>è¦ä»å‘½ä»¤è¡Œå¯ç”¨ç”¨æˆ·èº«ä»½éªŒè¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸NATSæœåŠ¡å™¨ï¼ˆnats-serverï¼‰ç›¸åŒçš„æœºåˆ¶ã€‚æ‚¨ä¼ å…¥-user <user>å’Œ-pass <pass>å‘½ä»¤æˆ–--authå‚æ•°ï¼ŒNATSæµæœåŠ¡å™¨å°†è‡ªåŠ¨ä½¿ç”¨è¿™äº›å‡­æ®ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸å•ä¸ªç”¨æˆ·æˆ–ä»¤ç‰Œä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>ä½¿ç”¨å…·æœ‰å¤šç”¨æˆ·æˆæƒçš„é…ç½®æ–‡ä»¶æ—¶ï¼Œå¿…é¡»å°†-userå’Œ-passå‚æ•°ä¸NATSæµæœåŠ¡å™¨ä¸€èµ·ä½¿ç”¨ï¼Œä¸é…ç½®æ–‡ä»¶ä¸­çš„ç”¨æˆ·åŒ¹é…ï¼Œä»¥æŒ‡å®šNATSæµæœåŠ¡å™¨åº”å¯¹å…¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç”¨æˆ·ã€‚åµŒå…¥å¼NATSæœåŠ¡å™¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å‘NATSæµåª’ä½“æœåŠ¡å™¨ä¼ é€’åŒ…å«å¤šä¸ªç”¨æˆ·çš„æ–‡ä»¶ï¼Œåˆ™å¿…é¡»ä»¥é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„â€œJoeâ€ç­‰ç”¨æˆ·èº«ä»½è¿è¡ŒæµæœåŠ¡å™¨ã€‚</p>
<h3 id="ä½¿ç”¨TLS"><a href="#ä½¿ç”¨TLS" class="headerlink" title="ä½¿ç”¨TLS"></a>ä½¿ç”¨TLS</h3><p>è™½ç„¶NATS StreamingæœåŠ¡å™¨æœ‰å‡ ä¸ªä¸TLSç›¸å…³çš„å‚æ•°ï¼Œä½†ä¿æŠ¤æœåŠ¡å™¨çš„è¿æ¥éå¸¸ç®€å•ã€‚ä½†æ˜¯ï¼Œè¯·è®°ä½ï¼ŒNATS StreamingæœåŠ¡å™¨åµŒå…¥NATSæœåŠ¡å™¨ï¼Œä»è€Œäº§ç”Ÿå®¢æˆ·ç«¯ - æœåŠ¡å™¨å…³ç³»ï¼Œå…¶ä¸­NATS StreamingæœåŠ¡å™¨æ˜¯å…¶åµŒå…¥å¼NATSæœåŠ¡å™¨çš„å®¢æˆ·ç«¯ã€‚</p>
<p>è¿™æ„å‘³ç€å¿…é¡»ä½¿ç”¨ä¸¤ç»„TLSé…ç½®å‚æ•°ï¼šåµŒå…¥å¼NATSæœåŠ¡å™¨çš„TLSæœåŠ¡å™¨å‚æ•°ï¼Œä»¥åŠNATSæµæœåŠ¡å™¨æœ¬èº«çš„TLSå®¢æˆ·ç«¯å‚æ•°ã€‚</p>
<p>æµæœåŠ¡å™¨ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°æŒ‡å®šå®ƒçš„TLSå®¢æˆ·ç«¯è¯ä¹¦ï¼š</p>
<ul>
<li>-tls_client_keyæµæœåŠ¡å™¨çš„å®¢æˆ·ç«¯å¯†é’¥</li>
<li>-tls_client_certæµæœåŠ¡å™¨çš„å®¢æˆ·ç«¯è¯ä¹¦</li>
<li>-tls_client_cacertæµåª’ä½“æœåŠ¡å™¨çš„å®¢æˆ·ç«¯è¯ä¹¦CA.</li>
</ul>
<p>è¿™äº›å¯èƒ½ä¸æ‚¨çš„NATSæµåª’ä½“å®¢æˆ·ç«¯ä½¿ç”¨çš„è¯ä¹¦ç›¸åŒã€‚</p>
<p>åµŒå…¥å¼NATSæœåŠ¡å™¨ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‡å®šTLSæœåŠ¡å™¨è¯ä¹¦ï¼š</p>
<ul>
<li>--tlscert <file>æœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶</li>
<li>--tlskey <file>æœåŠ¡å™¨è¯ä¹¦çš„ç§é’¥</li>
<li>--tlscacert <file>ç”¨äºéªŒè¯çš„å®¢æˆ·ç«¯è¯ä¹¦CA.</li>
</ul>
<p>æœåŠ¡å™¨å‚æ•°çš„ä½¿ç”¨æ–¹æ³•ä¸å®‰å…¨å…¸å‹NATSæœåŠ¡å™¨çš„æ–¹å¼ç›¸åŒã€‚</p>
<p>æ­£ç¡®ä½¿ç”¨NATS Streaming Serveréœ€è¦ä½¿ç”¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‚æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nats-streaming-server -tls_client_cert client-cert.pem -tls_client_key client-key.pem -tls_client_cacert ca.pem -tlscert server-cert.pem -tlskey server-key.pem -tlscacert ca.pem</span></span><br></pre></td></tr></table></figure>

<p>è¿›ä¸€æ­¥çš„TLSç›¸å…³åŠŸèƒ½å¯ä»¥åœ¨Securing NATS&gt; TLSä¸­æ‰¾åˆ°ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœéœ€è¦æŒ‡å®šå¯†ç å¥—ä»¶ï¼Œåˆ™å¯ä»¥é€šè¿‡<code>-config</code>å‘½ä»¤è¡Œå‚æ•°ä¼ é€’åµŒå…¥å¼NATSæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ã€‚</p>
<h2 id="NATS-Streaming-Protocol"><a href="#NATS-Streaming-Protocol" class="headerlink" title="NATS Streaming Protocol"></a>NATS Streaming Protocol</h2><p>The NATS streaming protocol sits atop the core <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/internals/nats-protocol">NATS protocol</a> and uses <a target="_blank" rel="noopener" href="https://developers.google.com/protocol-buffers/">Googleâ€™s Protocol Buffers</a>.  Protocol buffer messages are marshaled into bytes and published as NATS  messages on specific subjects described below. In communicating with  the NATS Streaming Server, the NATS <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/writing_applications/concepts">request&#x2F;reply</a> pattern is used for all protocol messages that have a corresponding reply.</p>
<h3 id="NATS-streaming-protocol-conventions"><a href="#NATS-streaming-protocol-conventions" class="headerlink" title="NATS streaming protocol conventions"></a>NATS streaming protocol conventions</h3><p><strong>Subject names</strong>:  Subject names, including reply subject (INBOX) names, are  case-sensitive and must be non-empty alphanumeric strings with no  embedded whitespace, and optionally token-delimited using the dot  character (<code>.</code>), e.g.:</p>
<p><code>FOO</code>, <code>BAR</code>, <code>foo.bar</code>, <code>foo.BAR</code>, <code>FOO.BAR</code> and <code>FOO.BAR.BAZ</code> are all valid subject names</p>
<p><code>FOO. BAR</code>, <code>foo. .bar</code> and<code>foo..bar</code> are *not- valid subject names</p>
<p><strong>Wildcards</strong>: NATS streaming does *<em>not</em>- support wildcards in subject subscriptions</p>
<p><strong>Protocol definition</strong>: The fields of NATS streaming protocol messages are defined in the go-nats-streaming <a target="_blank" rel="noopener" href="https://github.com/nats-io/go-nats-streaming/blob/master/pb/protocol.proto">protocol file</a>.</p>
<h3 id="NATS-streaming-protocol-messages"><a href="#NATS-streaming-protocol-messages" class="headerlink" title="NATS streaming protocol messages"></a>NATS streaming protocol messages</h3><p>The following table briefly describes the NATS streaming protocol messages.</p>
<p>Click the name to see more detailed information, including usage:</p>
<table>
<thead>
<tr>
<th>Message Name</th>
<th>Sent By</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNREQ"><code>ConnectRequest</code></a></td>
<td>Client</td>
<td>Request to connect to the NATS Streaming Server</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNRESP"><code>ConnectResponse</code></a></td>
<td>Server</td>
<td>Result of a connection request</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#SUBREQ"><code>SubscriptionRequest</code></a></td>
<td>Client</td>
<td>Request sent to subscribe and retrieve data</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#SUBRESP"><code>SubscriptionResponse</code></a></td>
<td>Server</td>
<td>Result of a subscription request</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#UNSUBREQ"><code>UnsubscribeRequest</code></a></td>
<td>Client</td>
<td>Unsubscribe from a subject</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#PUBMSG"><code>PubMsg</code></a></td>
<td>Client</td>
<td>Publish a message to a subject, with optional reply subject</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#PUBACK"><code>PubAck</code></a></td>
<td>Server</td>
<td>An acknowledgement that a published message has been processed on the server</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#MSGPROTO"><code>MsgProto</code></a></td>
<td>Server</td>
<td>A message from the NATS Streaming Server to a subscribing client</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#ACK"><code>Ack</code></a></td>
<td>Client</td>
<td>Acknowledges that a message has been received</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CLOSEREQ"><code>CloseRequest</code></a></td>
<td>Client</td>
<td>Request sent to close the connection to the NATS Streaming Server</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CLOSERESP"><code>CloseResp</code></a></td>
<td>Server</td>
<td>Result of the close request</td>
</tr>
</tbody></table>
<p>The following sections explain each protocol message.</p>
<h3 id="ConnectRequest"><a href="#ConnectRequest" class="headerlink" title="ConnectRequest"></a>ConnectRequest</h3><p><strong>Description</strong></p>
<p>A  connection request is sent when a streaming client connects to the NATS  Streaming Server. The connection request contains a unique identifier  representing the client, and an inbox subject the client will listen on  for incoming heartbeats. The identifier *<em>must</em>- be unique; a  connection attempt with an identifier currently in use will fail. The  inbox subject is the subject where the client receives incoming  heartbeats, and responds by publishing an empty NATS message to the  reply subject, indicating it is alive. The NATS Streaming Server will  return a <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNRESP">ConnectResponse</a> message to the reply subject specified in the NATS request message.</p>
<p>This request is published to a subject comprised of the <code>&lt;discover-prefix&gt;.cluster-id</code>, for example, if a NATS Streaming Server was started with a cluster-id of <code>mycluster</code>, and the default prefix was used, the client publishes to <code>_STAN.discover.mycluster</code></p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>clientID</code>: A unique identifier for a client</li>
<li><code>heartbeatInbox</code>: An inbox to which the NATS Streaming Server will send heartbeats for the client to process</li>
</ul>
<h3 id="ConnectResponse"><a href="#ConnectResponse" class="headerlink" title="ConnectResponse"></a>ConnectResponse</h3><p><strong>Description</strong></p>
<p>After a <code>ConnectRequest</code>  is published, the NATS Streaming Server responds with this message on  the reply subject of the underlying NATS request. The NATS Streaming  Server requires the client to make requests and publish messages on  certain subjects (described above), and when a connection is successful,  the client saves the information returned to be used in sending other  NATS streaming protocol messages. In the event the connection was not  successful, an error is returned in the <code>error</code> field.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>pubPrefix</code>: Prefix to use when publishing</li>
<li><code>subRequests</code>: Subject used for subscription requests</li>
<li><code>unsubRequests</code>: Subject used for unsubscribe requests</li>
<li><code>closeRequests</code>: Subject for closing a connection</li>
<li><code>error</code>: An error string, which will be empty&#x2F;omitted upon success</li>
<li><code>publicKey</code>: Reserved for future use</li>
</ul>
<h3 id="SubscriptionRequest"><a href="#SubscriptionRequest" class="headerlink" title="SubscriptionRequest"></a>SubscriptionRequest</h3><p><strong>Description</strong></p>
<p>A <code>SubscriptionRequest</code> is published on the subject returned in the <code>subRequests</code> field of a <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNRESP"><code>ConnectResponse</code></a>, and creates a subscription to a subject on the NATS Streaming Server. This will return a <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#SUBRESP">SubscriptionResponse</a> message to the reply subject specified in the NATS protocol request message.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>clientID</code>: Client ID originally provided in the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNREQ">ConnectRequest</a></li>
<li><code>subject</code>: Formal subject to subscribe to, e.g. foo.bar</li>
<li><code>qGroup</code>: Optional queue group</li>
<li><code>inbox</code>: Inbox subject to deliver messages on</li>
<li><code>maxInFlight</code>: Maximum inflight messages without an acknowledgement allowed</li>
<li><code>ackWaitInSecs</code>: Timeout for receiving an acknowledgement from the client</li>
<li><code>durableName</code>: Optional durable name which survives client restarts</li>
<li><code>startPosition</code>: An enumerated type specifying the point in history to start replaying data</li>
<li><code>startSequence</code>: Optional start sequence number</li>
<li><code>startTimeDelta</code>: Optional start time</li>
</ul>
<p><strong>StartPosition enumeration</strong></p>
<ul>
<li><code>NewOnly</code>: Send only new messages</li>
<li><code>LastReceived</code>: Send only the last received message</li>
<li><code>TimeDeltaStart</code>: Send messages from duration specified in the <code>startTimeDelta</code> field.</li>
<li><code>SequenceStart</code>: Send messages starting from the sequence in the <code>startSequence</code> field.</li>
<li><code>First</code>: Send all available messages</li>
</ul>
<h3 id="SubscriptionResponse"><a href="#SubscriptionResponse" class="headerlink" title="SubscriptionResponse"></a>SubscriptionResponse</h3><p><strong>Description</strong></p>
<p>The <code>SubscriptionResponse</code> message is the response from the <code>SubscriptionRequest</code>. After a client has processed an incoming <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#MSGPROTO">MsgProto</a> message, it must send an acknowledgement to the <code>ackInbox</code> subject provided here.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>ackInbox</code>: subject the client sends message acknowledgements to the NATS Streaming Server</li>
<li><code>error</code>: error string, empty&#x2F;omitted if no error</li>
</ul>
<h3 id="UnsubscribeRequest"><a href="#UnsubscribeRequest" class="headerlink" title="UnsubscribeRequest"></a>UnsubscribeRequest</h3><p><strong>Description</strong></p>
<p>The <code>UnsubscribeRequest</code> unsubcribes the connection from the specified subject. The inbox specified is the <code>inbox</code> returned from the NATS Streaming Server in the <code>SubscriptionResponse</code>.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>clientID</code>: Client ID originally provided in the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNREQ">ConnectRequest</a></li>
<li><code>subject</code>: Subject for the subscription</li>
<li><code>inbox</code>: Inbox subject to identify subscription</li>
<li><code>durableName</code>: Optional durable name which survives client restarts</li>
</ul>
<h3 id="PubMsg"><a href="#PubMsg" class="headerlink" title="PubMsg"></a>PubMsg</h3><p><strong>Description</strong></p>
<p>The <code>PubMsg</code> protocol message is published from a client to the NATS Streaming Server. The GUID must be unique, and is returned in the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#PUBACK">PubAck</a> message to correlate the success or failure of storing this particular message.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>clientID</code>: Client ID originally provided in the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNREQ">ConnectRequest</a></li>
<li><code>guid</code>: a guid generated for this particular message</li>
<li><code>subject</code>: subject</li>
<li><code>reply</code>: optional reply subject</li>
<li><code>data</code>: payload</li>
<li><code>sha256</code>: optional sha256 of payload data</li>
</ul>
<h3 id="PubAck"><a href="#PubAck" class="headerlink" title="PubAck"></a>PubAck</h3><p><strong>Description</strong></p>
<p>The <code>PubAck</code>  message is an acknowledgement from the NATS Streaming Server that a  message has been processed. The message arrives on the subject specified  on the reply subject of the NATS message the <code>PubMsg</code> was published on. The GUID is the same GUID used in the <code>PubMsg</code>  being acknowledged. If an error string is present, the message was not  persisted by the NATS Streaming Server and no guarantees regarding  persistence are honored. <code>PubAck</code> messages may be handled asynchronously from their corresponding <code>PubMsg</code> in the client.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>guid</code>: GUID of the message being acknowledged by the NATS Streaming Server</li>
<li><code>error</code>: An error string, empty&#x2F;omitted if no error</li>
</ul>
<h3 id="MsgProto"><a href="#MsgProto" class="headerlink" title="MsgProto"></a>MsgProto</h3><p><strong>Description</strong></p>
<p>The <code>MsgProto</code> message is received by client from the NATS Streaming Server, containing the payload of messages sent by a publisher. A <code>MsgProto</code> message that is not acknowledged with an <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#ACK">Ack</a> message within the duration specified by the <code>ackWaitInSecs</code> field of the subscription request will be redelivered.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>sequence</code>: Globally ordered sequence number for the subjectâ€™s channel</li>
<li><code>subject</code>: Subject</li>
<li><code>reply</code>: Optional reply</li>
<li><code>data</code>: Payload</li>
<li><code>timestamp</code>: Time the message was stored in the server.</li>
<li><code>redelivered</code>: Flag specifying if the message is being redelivered</li>
<li><code>CRC32</code>: Optional IEEE CRC32</li>
</ul>
<h3 id="Ack"><a href="#Ack" class="headerlink" title="Ack"></a>Ack</h3><p><strong>Description</strong></p>
<p>An <code>Ack</code> message is an acknowledgement from the client that a <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#MSGPROTO">MsgProto</a> message has been considered received. It is published to the <code>ackInbox</code> field of the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#SUBRESP"><code>SubscriptionResponse</code></a>.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>subject</code>: Subject of the message being acknowledged</li>
<li><code>sequence</code>: Sequence of the message being acknowledged</li>
</ul>
<h3 id="CloseRequest"><a href="#CloseRequest" class="headerlink" title="CloseRequest"></a>CloseRequest</h3><p><strong>Description</strong></p>
<p>A <code>CloseRequest</code> message is published on the <code>closeRequests</code> subject from the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNRESP"><code>ConnectResponse</code></a>,  and notifies the NATS Streaming Server that the client connection is  closing, allowing the server to free up resources. This message should *<em>always</em>- be sent when a client is finished using a connection.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>clientID</code>: Client ID originally provided in the <a target="_blank" rel="noopener" href="https://www.nats.io/documentation/streaming/nats-streaming-protocol/#CONNREQ">ConnectRequest</a></li>
</ul>
<h3 id="CloseResponse"><a href="#CloseResponse" class="headerlink" title="CloseResponse"></a>CloseResponse</h3><p><strong>Description</strong></p>
<p>The <code>CloseResponse</code> is sent by the NATS Streaming Server on the reply subject of the <code>CloseRequest</code> NATS message. This response contains any error that may have occurred with the corresponding close call.</p>
<p><strong>Message Structure</strong></p>
<ul>
<li><code>error</code>: error string, empty&#x2F;omitted if no error</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io">Blank</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://wangyyovo.github.io/posts/e845c472/">https://wangyyovo.github.io/posts/e845c472/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://wangyyovo.github.io" target="_blank">Blank</a>ï¼</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/95994a9aea31be452e66c89e68ba4a27.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/cd0e56c9/" title="NATSå’ŒNATS Streaming"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/939916bec37ea8f169680b4d133f4a86.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">NATSå’ŒNATS Streaming</div></div><div class="info-2"><div class="info-item-1"> NATSå’ŒNATS StreamingNATSæºç å®‰è£… 12345# Go clientgo get github.com/nats-io/nats.go/# Servergo get github.com/nats-io/nats-server  äºŒè¿›åˆ¶ï¼šhttps://nats.io/download/nats-io/gnatsd/ When using or transitioning to Go modules support: 123456789# Go client latest or explicit versiongo get github.com/nats-io/nats.go/@latestgo get github.com/nats-io/nats.go/@v1.9.1# For latest NATS Server, add /v2 at the endgo get github.com/nats-io/nats-server/v2# NATS Server v1 is installed otherwise# go get github.com/nat...</div></div></div></a><a class="pagination-related" href="/posts/7f2c8890/" title="Natsç®¡ç†æœåŠ¡å™¨"><img class="cover" src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/nats/285494672816019cfb027039031cb3ca.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">Natsç®¡ç†æœåŠ¡å™¨</div></div><div class="info-2"><div class="info-item-1"> Natsç®¡ç†æœåŠ¡å™¨å®‰è£…NATSæœåŠ¡å™¨æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®‰è£…NATSæœåŠ¡å™¨ã€‚ ä»äºŒè¿›åˆ¶å®‰è£…GitHubç‰ˆæœ¬é¡µé¢ä¸Šå§‹ç»ˆæä¾›æœ€æ–°çš„å®˜æ–¹å‘è¡Œç‰ˆäºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å¹³å°ï¼š  Linux (x86, x86_64, ARM) Windows (x86, x86_64) macOS  å¹³å°ç‰¹å®šæ–¹æ³• ä»¥ä¸‹æ–¹æ³•å¯èƒ½å¹¶éå…¨éƒ¨å®‰è£…æœ€æ–°å‘å¸ƒçš„ç‰ˆæœ¬  GO ç¡®ä¿è®¾ç½®äº†Goç¯å¢ƒï¼Œç„¶åä½¿ç”¨go getè¿›è¡Œå®‰è£…ã€‚ 1go get github.com/nats-io/nats-server  Docker Hub Docker Hubä¸Šæä¾›äº†æœ€æ–°çš„å®˜æ–¹Dockeré•œåƒã€‚Windows åœ¨Windowsä¸Šï¼Œå¯ä»¥é€šè¿‡Chocolateyå®‰è£…NATSæœåŠ¡å™¨ï¼š 1choco install nats-server  macOS åœ¨macOSä¸Šï¼Œå¯ä»¥é€šè¿‡Homebrewå®‰è£…NATSæœåŠ¡å™¨ï¼š 1brew install nats-server  æµ‹è¯•æ‚¨çš„å®‰è£…è¦æµ‹è¯•æ‚¨çš„å®‰è£…ï¼Œæ‚¨å¯ä»¥è°ƒç”¨NATSæœåŠ¡å™¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ²¡æœ‰é€‰é¡¹ï¼Œä¹Ÿæ²¡æœ‰é…ç½®æ–‡ä»¶ï¼ˆæ²¡æœ‰èº«ä»½éªŒè¯ï¼Œæ²¡æœ‰ç¾¤é›†ï¼‰ã€‚ 1nats-server  å½“æœåŠ¡å™¨æˆåŠŸå¯åŠ¨æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°NA...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/theme/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Blank</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">352</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">58</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>ä¸»é¢˜ GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NATS-Streaming"><span class="toc-number">1.</span> <span class="toc-text">NATS Streaming</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NATS-Streaming-%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">NATS Streaming æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">1.1.1.</span> <span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.2.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%B3%95%EF%BC%8C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.3.</span> <span class="toc-text">ç”¨æ³•ï¼Œé…ç½®å’Œç®¡ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85NATS-Streaming-Server"><span class="toc-number">1.2.</span> <span class="toc-text">å®‰è£…NATS Streaming Server</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B9%B6%E8%BF%90%E8%A1%8CNATS-Streaming-Server"><span class="toc-number">1.2.1.</span> <span class="toc-text">å®‰è£…å¹¶è¿è¡ŒNATS Streaming Server</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85NATS-Streaming%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">å®‰è£…NATS StreamingæœåŠ¡å™¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NATS-Streaming%E5%85%A5%E9%97%A8"><span class="toc-number">1.3.</span> <span class="toc-text">NATS Streamingå…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E5%86%B3%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">å…ˆå†³æ¡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-1"><span class="toc-number">1.3.2.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8NATS-Streaming-Server"><span class="toc-number">1.3.3.</span> <span class="toc-text">å¯åŠ¨NATS Streaming Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%8F%91%E5%B8%83%E8%80%85%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.3.4.</span> <span class="toc-text">è¿è¡Œå‘å¸ƒè€…å®¢æˆ·ç«¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E8%AE%A2%E6%88%B7%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.3.5.</span> <span class="toc-text">è¿è¡Œè®¢æˆ·å®¢æˆ·ç«¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E7%B4%A2%E5%85%B6%E4%BB%96%E8%AE%A2%E9%98%85%E9%80%89%E9%A1%B9"><span class="toc-number">1.3.6.</span> <span class="toc-text">æ¢ç´¢å…¶ä»–è®¢é˜…é€‰é¡¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NATS%E6%B5%81%E5%AA%92%E4%BD%93%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E5%85%A8"><span class="toc-number">1.4.</span> <span class="toc-text">NATSæµåª’ä½“æœåŠ¡å™¨å®‰å…¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7"><span class="toc-number">1.4.1.</span> <span class="toc-text">éªŒè¯ç”¨æˆ·</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8TLS"><span class="toc-number">1.4.2.</span> <span class="toc-text">ä½¿ç”¨TLS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NATS-Streaming-Protocol"><span class="toc-number">1.5.</span> <span class="toc-text">NATS Streaming Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NATS-streaming-protocol-conventions"><span class="toc-number">1.5.1.</span> <span class="toc-text">NATS streaming protocol conventions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NATS-streaming-protocol-messages"><span class="toc-number">1.5.2.</span> <span class="toc-text">NATS streaming protocol messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConnectRequest"><span class="toc-number">1.5.3.</span> <span class="toc-text">ConnectRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConnectResponse"><span class="toc-number">1.5.4.</span> <span class="toc-text">ConnectResponse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SubscriptionRequest"><span class="toc-number">1.5.5.</span> <span class="toc-text">SubscriptionRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SubscriptionResponse"><span class="toc-number">1.5.6.</span> <span class="toc-text">SubscriptionResponse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UnsubscribeRequest"><span class="toc-number">1.5.7.</span> <span class="toc-text">UnsubscribeRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PubMsg"><span class="toc-number">1.5.8.</span> <span class="toc-text">PubMsg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PubAck"><span class="toc-number">1.5.9.</span> <span class="toc-text">PubAck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MsgProto"><span class="toc-number">1.5.10.</span> <span class="toc-text">MsgProto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ack"><span class="toc-number">1.5.11.</span> <span class="toc-text">Ack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CloseRequest"><span class="toc-number">1.5.12.</span> <span class="toc-text">CloseRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CloseResponse"><span class="toc-number">1.5.13.</span> <span class="toc-text">CloseResponse</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d14168d/" title="è™šæ‹Ÿæœºé—®é¢˜åˆé›†"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="è™šæ‹Ÿæœºé—®é¢˜åˆé›†"/></a><div class="content"><a class="title" href="/posts/d14168d/" title="è™šæ‹Ÿæœºé—®é¢˜åˆé›†">è™šæ‹Ÿæœºé—®é¢˜åˆé›†</a><time datetime="2022-07-16T13:30:36.000Z" title="å‘è¡¨äº 2022-07-16 21:30:36">2022-07-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f540045f/" title="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/941ed1ec2925719a0c92e76f4f786b6a.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘"/></a><div class="content"><a class="title" href="/posts/f540045f/" title="ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘">ç”¨goè¯­è¨€ç¼–å†™ç§»åŠ¨ç«¯sdkå’Œappå¼€å‘</a><time datetime="2022-07-04T12:14:21.000Z" title="å‘è¡¨äº 2022-07-04 20:14:21">2022-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5faac006/" title="åœ¨çº¿ç¼–ç¨‹IDE"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/hexo/090cfe4e9e60b0ad0de05db822f3ae97.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="åœ¨çº¿ç¼–ç¨‹IDE"/></a><div class="content"><a class="title" href="/posts/5faac006/" title="åœ¨çº¿ç¼–ç¨‹IDE">åœ¨çº¿ç¼–ç¨‹IDE</a><time datetime="2022-06-12T13:30:36.000Z" title="å‘è¡¨äº 2022-06-12 21:30:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7594185d/" title="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/golang/3bfb3279740bc9a5b5ef436fa887ef07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope"/></a><div class="content"><a class="title" href="/posts/7594185d/" title="å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope">å³æ—¶æ€§èƒ½åˆ†æå·¥å…·Pyroscope</a><time datetime="2022-06-12T08:07:36.000Z" title="å‘è¡¨äº 2022-06-12 16:07:36">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/82a7aa7c/" title="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•"><img src="https://cdn.jsdelivr.net/gh/wangyyovo/CDN@master/cover/common/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•"/></a><div class="content"><a class="title" href="/posts/82a7aa7c/" title="golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•">golangæ€§èƒ½è°ƒè¯•ä¼˜åŒ–æ–¹æ³•</a><time datetime="2022-06-12T03:00:36.000Z" title="å‘è¡¨äº 2022-06-12 11:00:36">2022-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Blank</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.2</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"placeholder":"è¯´äº›ä»€ä¹ˆå§"}

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'BSfgwCPLOvPHVPaSoBCGSENf-MdYXbMMI',
      appKey: '2Q8qq5060qxycL6FPL26LnMG',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>